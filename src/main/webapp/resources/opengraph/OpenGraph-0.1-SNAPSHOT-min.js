(function(i){var e="0.3.4",j="hasOwnProperty",b=/[\.\/]/,a="*",g=function(){},f=function(m,l){return m-l},d,h,k={n:{}},c=function(m,C){var v=k,s=h,w=Array.prototype.slice.call(arguments,2),y=c.listeners(m),x=0,u=false,p,o=[],t={},q=[],n=d,A=[];d=m;h=0;for(var r=0,B=y.length;r<B;r++){if("zIndex" in y[r]){o.push(y[r].zIndex);if(y[r].zIndex<0){t[y[r].zIndex]=y[r]}}}o.sort(f);while(o[x]<0){p=t[o[x++]];q.push(p.apply(C,w));if(h){h=s;return q}}for(r=0;r<B;r++){p=y[r];if("zIndex" in p){if(p.zIndex==o[x]){q.push(p.apply(C,w));if(h){break}do{x++;p=t[o[x]];p&&q.push(p.apply(C,w));if(h){break}}while(p)}else{t[p.zIndex]=p}}else{q.push(p.apply(C,w));if(h){break}}}h=s;d=n;return q.length?q:null};c.listeners=function(l){var t=l.split(b),r=k,x,s,m,p,w,o,q,u,v=[r],n=[];for(p=0,w=t.length;p<w;p++){u=[];for(o=0,q=v.length;o<q;o++){r=v[o].n;s=[r[t[p]],r[a]];m=2;while(m--){x=s[m];if(x){u.push(x);n=n.concat(x.f||[])}}}v=u}return n};c.on=function(l,o){var q=l.split(b),p=k;for(var m=0,n=q.length;m<n;m++){p=p.n;!p[q[m]]&&(p[q[m]]={n:{}});p=p[q[m]]}p.f=p.f||[];for(m=0,n=p.f.length;m<n;m++){if(p.f[m]==o){return g}}p.f.push(o);return function(r){if(+r==+r){o.zIndex=+r}}};c.stop=function(){h=1};c.nt=function(l){if(l){return new RegExp("(?:\\.|\\/|^)"+l+"(?:\\.|\\/|$)").test(d)}return d};c.off=c.unbind=function(m,r){var t=m.split(b),s,v,n,p,w,o,q,u=[k];for(p=0,w=t.length;p<w;p++){for(o=0;o<u.length;o+=n.length-2){n=[o,1];s=u[o].n;if(t[p]!=a){if(s[t[p]]){n.push(s[t[p]])}}else{for(v in s){if(s[j](v)){n.push(s[v])}}}u.splice.apply(u,n)}}for(p=0,w=u.length;p<w;p++){s=u[p];while(s.n){if(r){if(s.f){for(o=0,q=s.f.length;o<q;o++){if(s.f[o]==r){s.f.splice(o,1);break}}!s.f.length&&delete s.f}for(v in s.n){if(s.n[j](v)&&s.n[v].f){var l=s.n[v].f;for(o=0,q=l.length;o<q;o++){if(l[o]==r){l.splice(o,1);break}}!l.length&&delete s.n[v].f}}}else{delete s.f;for(v in s.n){if(s.n[j](v)&&s.n[v].f){delete s.n[v].f}}}s=s.n}}};c.once=function(l,m){var n=function(){var o=m.apply(this,arguments);c.unbind(l,n);return o};return c.on(l,n)};c.version=e;c.toString=function(){return"You are running Eve "+e};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define!="undefined"?(define("eve",[],function(){return c})):(i.eve=c))})(this);(function(){function aR(g){if(aR.is(g,"function")){return ao?g():eve.on("raphael.DOMload",g)}else{if(aR.is(g,bd)){return aR._engine.create[bG](aR,g.splice(0,3+aR.is(g[0],aL))).add(g)}else{var b=Array.prototype.slice.call(arguments,0);if(aR.is(b[b.length-1],"function")){var d=b.pop();return ao?d.call(aR._engine.create[bG](aR,b)):eve.on("raphael.DOMload",function(){d.call(aR._engine.create[bG](aR,b))})}else{return aR._engine.create[bG](aR,arguments)}}}}aR.version="2.1.0";aR.eve=eve;var ao,a=/[, ]+/,bw={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},br=/\{(\d+)\}/g,bJ="prototype",ak="hasOwnProperty",aA={doc:document,win:window},s={was:Object.prototype[ak].call(aA.win,"Raphael"),is:aA.win.Raphael},bF=function(){this.ca=this.customAttributes={}},a4,bo="appendChild",bG="apply",bE="concat",Z="createTouch" in aA.doc,aX="",aQ=" ",bH=String,F="split",Q="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[F](aQ),bx={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bK=bH.prototype.toLowerCase,au=Math,m=au.max,bm=au.min,aw=au.abs,bp=au.pow,aV=au.PI,aL="number",aj="string",bd="array",a5="toString",a9="fill",a1=Object.prototype.toString,bz={},j="push",f=aR._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,A=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,av={"NaN":1,"Infinity":1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ah=au.round,z="setAttribute",an=parseFloat,U=parseInt,bt=bH.prototype.toUpperCase,r=aR._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,"shape-rendering":"crispEdges"},ar=aR._availableAnimAttrs={blur:aL,"clip-rect":"csv",cx:aL,cy:aL,fill:"colour","fill-opacity":aL,"font-size":aL,height:aL,opacity:aL,path:"path",r:aL,rx:aL,ry:aL,stroke:"colour","stroke-opacity":aL,"stroke-width":aL,transform:"transform",width:aL,x:aL,y:aL},ac=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bi=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,n={hs:1,rg:1},bg=/,?([achlmqrstvxz]),?/gi,a0=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ai=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,aP=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,aW=aR._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,aU={},bq=function(g,d){return g.key-d.key},u=function(g,d){return an(g)-an(d)},I=function(){},bB=function(b){return b},az=aR._rectPath=function(b,E,d,g,i){if(i){return[["M",b+i,E],["l",d-i*2,0],["a",i,i,0,0,1,i,i],["l",0,g-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-d,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-g],["a",i,i,0,0,1,i,-i],["z"]]}return[["M",b,E],["l",d,0],["l",0,g],["l",-d,0],["z"]]},K=function(b,i,g,d){if(d==null){d=g}return[["M",b,i],["m",0,-d],["a",g,d,0,1,1,0,2*d],["a",g,d,0,1,1,0,-2*d],["z"]]},N=aR._getPath={group:function(b){throw new TypeError("Not support for group element!")},path:function(b){return b.attr("path")},circle:function(d){var b=d.attrs;return K(b.cx,b.cy,b.r)},ellipse:function(d){var b=d.attrs;return K(b.cx,b.cy,b.rx,b.ry)},rect:function(d){var b=d.attrs;return az(b.x,b.y,b.width,b.height,b.r)},image:function(d){var b=d.attrs;return az(b.x,b.y,b.width,b.height)},text:function(b){var d=b._getBBox();return az(d.x,d.y,d.width,d.height)},foreignObject:function(d){var b=d.attrs;return az(b.x,b.y,b.width,b.height)}},L=aR.mapPath=function(bN,S){if(!S){return bN}var bL,R,g,b,bM,E,d;bN=W(bN);for(g=0,bM=bN.length;g<bM;g++){d=bN[g];for(b=1,E=d.length;b<E;b+=2){bL=S.x(d[b],d[b+1]);R=S.y(d[b],d[b+1]);d[b]=bL;d[b+1]=R}}return bN};aR._g=aA;aR.type=(aA.win.SVGAngle||aA.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(aR.type=="VML"){var aE=aA.doc.createElement("div"),aH;aE.innerHTML='<v:shape adj="1"/>';aH=aE.firstChild;aH.style.behavior="url(#default#VML)";if(!(aH&&typeof aH.adj=="object")){return(aR.type=aX)}aE=null}aR.svg=!(aR.vml=aR.type=="VML");aR._Paper=bF;aR.fn=a4=bF.prototype=aR.prototype;aR._id=0;aR._oid=0;aR.is=function(d,b){b=bK.call(b);if(b=="finite"){return !av[ak](+d)}if(b=="array"){return d instanceof Array}return(b=="null"&&d===null)||(b==typeof d&&d!==null)||(b=="object"&&d===Object(d))||(b=="array"&&Array.isArray&&Array.isArray(d))||a1.call(d).slice(8,-1).toLowerCase()==b};function X(g){if(Object(g)!==g){return g}var d=new g.constructor;for(var b in g){if(g[ak](b)){d[b]=X(g[b])}}return d}aR.angle=function(E,S,g,R,d,i){if(d==null){var b=E-g,bL=S-R;if(!b&&!bL){return 0}return(180+au.atan2(-bL,-b)*180/aV+360)%360}else{return aR.angle(E,S,d,i)-aR.angle(g,R,d,i)}};aR.rad=function(b){return b%360*aV/180};aR.deg=function(b){return b*180/aV%360};aR.snapTo=function(d,E,b){b=aR.is(b,"finite")?b:10;if(aR.is(d,bd)){var g=d.length;while(g--){if(aw(d[g]-E)<=b){return d[g]}}}else{d=+d;var R=E%d;if(R<b){return E-R}if(R>d-b){return E-R+d}}return E};var h=aR.createUUID=(function(b,d){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,d).toUpperCase()}})(/[xy]/g,function(g){var d=au.random()*16|0,b=g=="x"?d:(d&3|8);return b.toString(16)});aR.setWindow=function(b){eve("raphael.setWindow",aR,aA.win,b);aA.win=b;aA.doc=aA.win.document;if(aR._engine.initWin){aR._engine.initWin(aA.win)}};var bf=function(g){if(aR.vml){var b=/^\s+|\s+$/g;var R;try{var S=new ActiveXObject("htmlfile");S.write("<body>");S.close();R=S.body}catch(bL){R=createPopup().document.body}var d=R.createTextRange();bf=aG(function(i){try{R.style.color=bH(i).replace(b,aX);var bM=d.queryCommandValue("ForeColor");bM=((bM&255)<<16)|(bM&65280)|((bM&16711680)>>>16);return"#"+("000000"+bM.toString(16)).slice(-6)}catch(bN){return"none"}})}else{var E=aA.doc.createElement("i");E.title="Rapha\xebl Colour Picker";E.style.display="none";aA.doc.body.appendChild(E);bf=aG(function(i){E.style.color=i;return aA.doc.defaultView.getComputedStyle(E,aX).getPropertyValue("color")})}return bf(g)},aI=function(){return"hsb("+[this.h,this.s,this.b]+")"},M=function(){return"hsl("+[this.h,this.s,this.l]+")"},x=function(){return this.hex},aY=function(R,E,d){if(E==null&&aR.is(R,"object")&&"r" in R&&"g" in R&&"b" in R){d=R.b;E=R.g;R=R.r}if(E==null&&aR.is(R,aj)){var i=aR.getRGB(R);R=i.r;E=i.g;d=i.b}if(R>1||E>1||d>1){R/=255;E/=255;d/=255}return[R,E,d]},a2=function(R,E,d,S){R*=255;E*=255;d*=255;var i={r:R,g:E,b:d,hex:aR.rgb(R,E,d),toString:x};aR.is(S,"finite")&&(i.opacity=S);return i};aR.color=function(b){var d;if(aR.is(b,"object")&&"h" in b&&"s" in b&&"b" in b){d=aR.hsb2rgb(b);b.r=d.r;b.g=d.g;b.b=d.b;b.hex=d.hex}else{if(aR.is(b,"object")&&"h" in b&&"s" in b&&"l" in b){d=aR.hsl2rgb(b);b.r=d.r;b.g=d.g;b.b=d.b;b.hex=d.hex}else{if(aR.is(b,"string")){b=aR.getRGB(b)}if(aR.is(b,"object")&&"r" in b&&"g" in b&&"b" in b){d=aR.rgb2hsl(b);b.h=d.h;b.s=d.s;b.l=d.l;d=aR.rgb2hsb(b);b.v=d.b}else{b={hex:"none"};b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1}}}b.toString=x;return b};aR.hsb2rgb=function(S,bN,bL,i){if(this.is(S,"object")&&"h" in S&&"s" in S&&"b" in S){bL=S.b;bN=S.s;S=S.h;i=S.o}S*=360;var E,bM,d,g,b;S=(S%360)/60;b=bL*bN;g=b*(1-aw(S%2-1));E=bM=d=bL-b;S=~~S;E+=[b,g,0,0,g,b][S];bM+=[g,b,b,g,0,0][S];d+=[0,0,g,b,b,g][S];return a2(E,bM,d,i)};aR.hsl2rgb=function(bL,bN,E,i){if(this.is(bL,"object")&&"h" in bL&&"s" in bL&&"l" in bL){E=bL.l;bN=bL.s;bL=bL.h}if(bL>1||bN>1||E>1){bL/=360;bN/=100;E/=100}bL*=360;var S,bM,d,g,b;bL=(bL%360)/60;b=2*bN*(E<0.5?E:1-E);g=b*(1-aw(bL%2-1));S=bM=d=E-b/2;bL=~~bL;S+=[b,g,0,0,g,b][bL];bM+=[g,b,b,g,0,0][bL];d+=[0,0,g,b,b,g][bL];return a2(S,bM,d,i)};aR.rgb2hsb=function(bM,bL,d){d=aY(bM,bL,d);bM=d[0];bL=d[1];d=d[2];var R,E,i,bN;i=m(bM,bL,d);bN=i-bm(bM,bL,d);R=(bN==0?null:i==bM?(bL-d)/bN:i==bL?(d-bM)/bN+2:(bM-bL)/bN+4);R=((R+360)%6)*60/360;E=bN==0?0:bN/i;return{h:R,s:E,b:i,toString:aI}};aR.rgb2hsl=function(d,bL,bO){bO=aY(d,bL,bO);d=bO[0];bL=bO[1];bO=bO[2];var bP,R,bN,bM,E,i;bM=m(d,bL,bO);E=bm(d,bL,bO);i=bM-E;bP=(i==0?null:bM==d?(bL-bO)/i:bM==bL?(bO-d)/i+2:(d-bL)/i+4);bP=((bP+360)%6)*60/360;bN=(bM+E)/2;R=(i==0?0:bN<0.5?i/(2*bN):i/(2-2*bN));return{h:bP,s:R,l:bN,toString:M}};aR._path2string=function(){return this.join(",").replace(bg,"$1")};function bk(E,g){for(var b=0,d=E.length;b<d;b++){if(E[b]===g){return E.push(E.splice(b,1)[0])}}}function aG(i,d,b){function g(){var E=Array.prototype.slice.call(arguments,0),S=E.join("\u2400"),R=g.cache=g.cache||{},bL=g.count=g.count||[];if(R[ak](S)){bk(bL,S);return b?b(R[S]):R[S]}bL.length>=1000&&delete R[bL.shift()];bL.push(S);R[S]=i[bG](d,E);return b?b(R[S]):R[S]}return g}var bv=aR._preload=function(g,d){var b=aA.doc.createElement("img");b.style.cssText="position:absolute;left:-9999em;top:-9999em";b.onload=function(){d.call(this);this.onload=null;aA.doc.body.removeChild(this)};b.onerror=function(){aA.doc.body.removeChild(this)};aA.doc.body.appendChild(b);b.src=g};function aq(){return this.hex}aR.getRGB=aG(function(b){if(!b||!!((b=bH(b)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aq}}if(b=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:aq}}!(n[ak](b.toLowerCase().substring(0,2))||b.charAt()=="#")&&(b=bf(b));var E,d,g,S,i,bM,bL,R=b.match(A);if(R){if(R[2]){S=U(R[2].substring(5),16);g=U(R[2].substring(3,5),16);d=U(R[2].substring(1,3),16)}if(R[3]){S=U((bM=R[3].charAt(3))+bM,16);g=U((bM=R[3].charAt(2))+bM,16);d=U((bM=R[3].charAt(1))+bM,16)}if(R[4]){bL=R[4][F](bi);d=an(bL[0]);bL[0].slice(-1)=="%"&&(d*=2.55);g=an(bL[1]);bL[1].slice(-1)=="%"&&(g*=2.55);S=an(bL[2]);bL[2].slice(-1)=="%"&&(S*=2.55);R[1].toLowerCase().slice(0,4)=="rgba"&&(i=an(bL[3]));bL[3]&&bL[3].slice(-1)=="%"&&(i/=100)}if(R[5]){bL=R[5][F](bi);d=an(bL[0]);bL[0].slice(-1)=="%"&&(d*=2.55);g=an(bL[1]);bL[1].slice(-1)=="%"&&(g*=2.55);S=an(bL[2]);bL[2].slice(-1)=="%"&&(S*=2.55);(bL[0].slice(-3)=="deg"||bL[0].slice(-1)=="\xb0")&&(d/=360);R[1].toLowerCase().slice(0,4)=="hsba"&&(i=an(bL[3]));bL[3]&&bL[3].slice(-1)=="%"&&(i/=100);return aR.hsb2rgb(d,g,S,i)}if(R[6]){bL=R[6][F](bi);d=an(bL[0]);bL[0].slice(-1)=="%"&&(d*=2.55);g=an(bL[1]);bL[1].slice(-1)=="%"&&(g*=2.55);S=an(bL[2]);bL[2].slice(-1)=="%"&&(S*=2.55);(bL[0].slice(-3)=="deg"||bL[0].slice(-1)=="\xb0")&&(d/=360);R[1].toLowerCase().slice(0,4)=="hsla"&&(i=an(bL[3]));bL[3]&&bL[3].slice(-1)=="%"&&(i/=100);return aR.hsl2rgb(d,g,S,i)}R={r:d,g:g,b:S,toString:aq};R.hex="#"+(16777216|S|(g<<8)|(d<<16)).toString(16).slice(1);aR.is(i,"finite")&&(R.opacity=i);return R}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aq}},aR);aR.hsb=aG(function(i,g,d){return aR.hsb2rgb(i,g,d).hex});aR.hsl=aG(function(g,d,b){return aR.hsl2rgb(g,d,b).hex});aR.rgb=aG(function(E,i,d){return"#"+(16777216|d|(i<<8)|(E<<16)).toString(16).slice(1)});aR.getColor=function(d){var g=this.getColor.start=this.getColor.start||{h:0,s:1,b:d||0.75},b=this.hsb2rgb(g.h,g.s,g.b);g.h+=0.075;if(g.h>1){g.h=0;g.s-=0.2;g.s<=0&&(this.getColor.start={h:0,s:1,b:g.b})}return b.hex};aR.getColor.reset=function(){delete this.start};function bb(E,bL){var S=[];for(var g=0,b=E.length;b-2*!bL>g;g+=2){var R=[{x:+E[g-2],y:+E[g-1]},{x:+E[g],y:+E[g+1]},{x:+E[g+2],y:+E[g+3]},{x:+E[g+4],y:+E[g+5]}];if(bL){if(!g){R[0]={x:+E[b-2],y:+E[b-1]}}else{if(b-4==g){R[3]={x:+E[0],y:+E[1]}}else{if(b-2==g){R[2]={x:+E[0],y:+E[1]};R[3]={x:+E[2],y:+E[3]}}}}}else{if(b-4==g){R[3]=R[2]}else{if(!g){R[0]={x:+E[g],y:+E[g+1]}}}}S.push(["C",(-R[0].x+6*R[1].x+R[2].x)/6,(-R[0].y+6*R[1].y+R[2].y)/6,(R[1].x+6*R[2].x-R[3].x)/6,(R[1].y+6*R[2].y-R[3].y)/6,R[2].x,R[2].y])}return S}aR.parsePathString=function(b){if(!b){return null}var g=Y(b);if(g.arr){return aZ(g.arr)}var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},d=[];if(aR.is(b,bd)&&aR.is(b[0],bd)){d=aZ(b)}if(!d.length){bH(b).replace(a0,function(R,E,bM){var bL=[],S=E.toLowerCase();bM.replace(aP,function(bO,bN){bN&&bL.push(+bN)});if(S=="m"&&bL.length>2){d.push([E][bE](bL.splice(0,2)));S="l";E=E=="m"?"l":"L"}if(S=="r"){d.push([E][bE](bL))}else{while(bL.length>=i[S]){d.push([E][bE](bL.splice(0,i[S])));if(!i[S]){break}}}})}d.toString=aR._path2string;g.arr=aZ(d);return d};aR.parseTransformString=aG(function(d){if(!d){return null}var g={r:3,s:4,t:2,m:6},b=[];if(aR.is(d,bd)&&aR.is(d[0],bd)){b=aZ(d)}if(!b.length){bH(d).replace(ai,function(E,i,bL){var S=[],R=bK.call(i);bL.replace(aP,function(bN,bM){bM&&S.push(+bM)});b.push([i][bE](S))})}b.toString=aR._path2string;return b});var Y=function(d){var b=Y.ps=Y.ps||{};if(b[d]){b[d].sleep=100}else{b[d]={sleep:100}}setTimeout(function(){for(var g in b){if(b[ak](g)&&g!=d){b[g].sleep--;!b[g].sleep&&delete b[g]}}});return b[d]};aR.findDotsAtSegment=function(d,b,b2,b0,S,E,bN,bL,bV){var bS=1-bV,bX=bp(bS,3),bY=bp(bS,2),bP=bV*bV,bM=bP*bV,bR=bX*d+bY*3*bV*b2+bS*3*bV*bV*S+bM*bN,bO=bX*b+bY*3*bV*b0+bS*3*bV*bV*E+bM*bL,bW=d+2*bV*(b2-d)+bP*(S-2*b2+d),bU=b+2*bV*(b0-b)+bP*(E-2*b0+b),b1=b2+2*bV*(S-b2)+bP*(bN-2*S+b2),bZ=b0+2*bV*(E-b0)+bP*(bL-2*E+b0),bT=bS*d+bV*b2,bQ=bS*b+bV*b0,i=bS*S+bV*bN,g=bS*E+bV*bL,R=(90-au.atan2(bW-b1,bU-bZ)*180/aV);(bW>b1||bU<bZ)&&(R+=180);return{x:bR,y:bO,m:{x:bW,y:bU},n:{x:b1,y:bZ},start:{x:bT,y:bQ},end:{x:i,y:g},alpha:R}};aR.bezierBBox=function(d,b,i,g,bM,S,R,E){if(!aR.is(d,"array")){d=[d,b,i,g,bM,S,R,E]}var bL=ba.apply(null,d);return{x:bL.min.x,y:bL.min.y,x2:bL.max.x,y2:bL.max.y,width:bL.max.x-bL.min.x,height:bL.max.y-bL.min.y}};aR.isPointInsideBBox=function(d,b,g){return b>=d.x&&b<=d.x2&&g>=d.y&&g<=d.y2};aR.isBBoxIntersect=function(g,d){var b=aR.isPointInsideBBox;return b(d,g.x,g.y)||b(d,g.x2,g.y)||b(d,g.x,g.y2)||b(d,g.x2,g.y2)||b(g,d.x,d.y)||b(g,d.x2,d.y)||b(g,d.x,d.y2)||b(g,d.x2,d.y2)||(g.x<d.x2&&g.x>d.x||d.x<g.x2&&d.x>g.x)&&(g.y<d.y2&&g.y>d.y||d.y<g.y2&&d.y>g.y)};function bj(b,S,R,E,i){var g=-3*S+9*R-9*E+3*i,d=b*g+6*S-12*R+6*E;return b*d-3*S+3*R}function q(bW,R,bV,g,bU,d,bR,b,bO){if(bO==null){bO=1}bO=bO>1?1:bO<0?0:bO;var bP=bO/2,bQ=12,bL=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],bT=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],E=0;for(var bS=0;bS<bQ;bS++){var bM=bP*bL[bS]+bP,bN=bj(bM,bW,bV,bU,bR),bX=bj(bM,R,g,d,b),S=bN*bN+bX*bX;E+=bT[bS]*au.sqrt(S)}return bP*E}function C(g,bP,d,bO,b,bM,bR,bL,bN){if(bN<0||q(g,bP,d,bO,b,bM,bR,bL)<bN){return}var bQ=1,i=bQ/2,R=bQ-i,E,S=0.01;E=q(g,bP,d,bO,b,bM,bR,bL,R);while(aw(E-bN)>S){i/=2;R+=(E<bN?1:-1)*i;E=q(g,bP,d,bO,b,bM,bR,bL,R)}return R}function O(i,bQ,g,bO,b,bN,bS,bM){if(m(i,g)<bm(b,bS)||bm(i,g)>m(b,bS)||m(bQ,bO)<bm(bN,bM)||bm(bQ,bO)>m(bN,bM)){return}var bL=(i*bO-bQ*g)*(b-bS)-(i-g)*(b*bM-bN*bS),S=(i*bO-bQ*g)*(bN-bM)-(bQ-bO)*(b*bM-bN*bS),E=(i-g)*(bN-bM)-(bQ-bO)*(b-bS);if(!E){return}var bR=bL/E,bP=S/E,R=+bR.toFixed(2),d=+bP.toFixed(2);if(R<+bm(i,g).toFixed(2)||R>+m(i,g).toFixed(2)||R<+bm(b,bS).toFixed(2)||R>+m(b,bS).toFixed(2)||d<+bm(bQ,bO).toFixed(2)||d>+m(bQ,bO).toFixed(2)||d<+bm(bN,bM).toFixed(2)||d>+m(bN,bM).toFixed(2)){return}return{x:bR,y:bP}}function ay(d,b){return af(d,b)}function t(d,b){return af(d,b,1)}function af(b2,b1,b0){var E=aR.bezierBBox(b2),d=aR.bezierBBox(b1);if(!aR.isBBoxIntersect(E,d)){return b0?0:[]}var bV=q.apply(0,b2),bU=q.apply(0,b1),bM=~~(bV/5),bL=~~(bU/5),bS=[],bR=[],g={},b3=b0?0:[];for(var bX=0;bX<bM+1;bX++){var bT=aR.findDotsAtSegment.apply(aR,b2.concat(bX/bM));bS.push({x:bT.x,y:bT.y,t:bX/bM})}for(bX=0;bX<bL+1;bX++){bT=aR.findDotsAtSegment.apply(aR,b1.concat(bX/bL));bR.push({x:bT.x,y:bT.y,t:bX/bL})}for(bX=0;bX<bM;bX++){for(var bW=0;bW<bL;bW++){var bZ=bS[bX],b=bS[bX+1],bY=bR[bW],S=bR[bW+1],bQ=aw(b.x-bZ.x)<0.001?"y":"x",bP=aw(S.x-bY.x)<0.001?"y":"x",R=O(bZ.x,bZ.y,b.x,b.y,bY.x,bY.y,S.x,S.y);if(R){if(g[R.x.toFixed(4)]==R.y.toFixed(4)){continue}g[R.x.toFixed(4)]=R.y.toFixed(4);var bO=bZ.t+aw((R[bQ]-bZ[bQ])/(b[bQ]-bZ[bQ]))*(b.t-bZ.t),bN=bY.t+aw((R[bP]-bY[bP])/(S[bP]-bY[bP]))*(S.t-bY.t);if(bO>=0&&bO<=1&&bN>=0&&bN<=1){if(b0){b3++}else{b3.push({x:R.x,y:R.y,t1:bO,t2:bN})}}}}}return b3}aR.pathIntersection=function(d,b){return D(d,b)};aR.pathIntersectionNumber=function(d,b){return D(d,b,1)};function D(g,b,bW){g=aR._path2curve(g);b=aR._path2curve(b);var bU,S,bT,E,bR,bL,d,bO,b0,bZ,b1=bW?0:[];for(var bS=0,bM=g.length;bS<bM;bS++){var bY=g[bS];if(bY[0]=="M"){bU=bR=bY[1];S=bL=bY[2]}else{if(bY[0]=="C"){b0=[bU,S].concat(bY.slice(1));bU=b0[6];S=b0[7]}else{b0=[bU,S,bU,S,bR,bL,bR,bL];bU=bR;S=bL}for(var bQ=0,bV=b.length;bQ<bV;bQ++){var bX=b[bQ];if(bX[0]=="M"){bT=d=bX[1];E=bO=bX[2]}else{if(bX[0]=="C"){bZ=[bT,E].concat(bX.slice(1));bT=bZ[6];E=bZ[7]}else{bZ=[bT,E,bT,E,d,bO,d,bO];bT=d;E=bO}var bN=af(b0,bZ,bW);if(bW){b1+=bN}else{for(var bP=0,R=bN.length;bP<R;bP++){bN[bP].segment1=bS;bN[bP].segment2=bQ;bN[bP].bez1=b0;bN[bP].bez2=bZ}b1=b1.concat(bN)}}}}}return b1}aR.isPointInsidePath=function(d,b,i){var g=aR.pathBBox(d);return aR.isPointInsideBBox(g,b,i)&&D(d,[["M",b,i],["H",g.x2+10]],1)%2==1};aR._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var am=aR.pathBBox=function(bT){var bN=Y(bT);if(bN.bbox){return bN.bbox}if(!bT){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}bT=W(bT);var bQ=0,bP=0,R=[],d=[],g;for(var bL=0,bS=bT.length;bL<bS;bL++){g=bT[bL];if(g[0]=="M"){bQ=g[1];bP=g[2];R.push(bQ);d.push(bP)}else{var bM=ba(bQ,bP,g[1],g[2],g[3],g[4],g[5],g[6]);R=R[bE](bM.min.x,bM.max.x);d=d[bE](bM.min.y,bM.max.y);bQ=g[5];bP=g[6]}}var b=bm[bG](0,R),bR=bm[bG](0,d),S=m[bG](0,R),E=m[bG](0,d),bO={x:b,y:bR,x2:S,y2:E,width:S-b,height:E-bR};bN.bbox=X(bO);return bO},aZ=function(d){var b=X(d);b.toString=aR._path2string;return b},aC=aR._pathToRelative=function(E){var bM=Y(E);if(bM.rel){return aZ(bM.rel)}if(!aR.is(E,bd)||!aR.is(E&&E[0],bd)){E=aR.parsePathString(E)}var bP=[],bR=0,bQ=0,bU=0,bT=0,g=0;if(E[0][0]=="M"){bR=E[0][1];bQ=E[0][2];bU=bR;bT=bQ;g++;bP.push(["M",bR,bQ])}for(var bL=g,bV=E.length;bL<bV;bL++){var b=bP[bL]=[],bS=E[bL];if(bS[0]!=bK.call(bS[0])){b[0]=bK.call(bS[0]);switch(b[0]){case"a":b[1]=bS[1];b[2]=bS[2];b[3]=bS[3];b[4]=bS[4];b[5]=bS[5];b[6]=+(bS[6]-bR).toFixed(3);b[7]=+(bS[7]-bQ).toFixed(3);break;case"v":b[1]=+(bS[1]-bQ).toFixed(3);break;case"m":bU=bS[1];bT=bS[2];default:for(var S=1,bN=bS.length;S<bN;S++){b[S]=+(bS[S]-((S%2)?bR:bQ)).toFixed(3)}}}else{b=bP[bL]=[];if(bS[0]=="m"){bU=bS[1]+bR;bT=bS[2]+bQ}for(var R=0,d=bS.length;R<d;R++){bP[bL][R]=bS[R]}}var bO=bP[bL].length;switch(bP[bL][0]){case"z":bR=bU;bQ=bT;break;case"h":bR+=+bP[bL][bO-1];break;case"v":bQ+=+bP[bL][bO-1];break;default:bR+=+bP[bL][bO-2];bQ+=+bP[bL][bO-1]}}bP.toString=aR._path2string;bM.rel=aZ(bP);return bP},w=aR._pathToAbsolute=function(bQ){var g=Y(bQ);if(g.abs){return aZ(g.abs)}if(!aR.is(bQ,bd)||!aR.is(bQ&&bQ[0],bd)){bQ=aR.parsePathString(bQ)}if(!bQ||!bQ.length){return[["M",0,0]]}var bW=[],bL=0,S=0,bO=0,bN=0,E=0;if(bQ[0][0]=="M"){bL=+bQ[0][1];S=+bQ[0][2];bO=bL;bN=S;E++;bW[0]=["M",bL,S]}var bV=bQ.length==3&&bQ[0][0]=="M"&&bQ[1][0].toUpperCase()=="R"&&bQ[2][0].toUpperCase()=="Z";for(var bP,b,bT=E,bM=bQ.length;bT<bM;bT++){bW.push(bP=[]);b=bQ[bT];if(b[0]!=bt.call(b[0])){bP[0]=bt.call(b[0]);switch(bP[0]){case"A":bP[1]=b[1];bP[2]=b[2];bP[3]=b[3];bP[4]=b[4];bP[5]=b[5];bP[6]=+(b[6]+bL);bP[7]=+(b[7]+S);break;case"V":bP[1]=+b[1]+S;break;case"H":bP[1]=+b[1]+bL;break;case"R":var R=[bL,S][bE](b.slice(1));for(var bS=2,bU=R.length;bS<bU;bS++){R[bS]=+R[bS]+bL;R[++bS]=+R[bS]+S}bW.pop();bW=bW[bE](bb(R,bV));break;case"M":bO=+b[1]+bL;bN=+b[2]+S;default:for(bS=1,bU=b.length;bS<bU;bS++){bP[bS]=+b[bS]+((bS%2)?bL:S)}}}else{if(b[0]=="R"){R=[bL,S][bE](b.slice(1));bW.pop();bW=bW[bE](bb(R,bV));bP=["R"][bE](b.slice(-2))}else{for(var bR=0,d=b.length;bR<d;bR++){bP[bR]=b[bR]}}}switch(bP[0]){case"Z":bL=bO;S=bN;break;case"H":bL=bP[1];break;case"V":S=bP[1];break;case"M":bO=bP[bP.length-2];bN=bP[bP.length-1];default:bL=bP[bP.length-2];S=bP[bP.length-1]}}bW.toString=aR._path2string;g.abs=aZ(bW);return bW},bI=function(d,i,b,g){return[d,i,b,g,b,g]},bn=function(d,i,S,E,b,g){var R=1/3,bL=2/3;return[R*d+bL*S,R*i+bL*E,R*b+bL*S,R*g+bL*E,b,g]},ae=function(bS,cn,b1,bZ,bT,bN,E,bR,cm,bU){var bY=aV*120/180,b=aV/180*(+bT||0),b5=[],b2,cj=aG(function(co,cr,i){var cq=co*au.cos(i)-cr*au.sin(i),cp=co*au.sin(i)+cr*au.cos(i);return{x:cq,y:cp}});if(!bU){b2=cj(bS,cn,-b);bS=b2.x;cn=b2.y;b2=cj(bR,cm,-b);bR=b2.x;cm=b2.y;var d=au.cos(aV/180*bT),bP=au.sin(aV/180*bT),b7=(bS-bR)/2,b6=(cn-cm)/2;var ch=(b7*b7)/(b1*b1)+(b6*b6)/(bZ*bZ);if(ch>1){ch=au.sqrt(ch);b1=ch*b1;bZ=ch*bZ}var g=b1*b1,ca=bZ*bZ,cc=(bN==E?-1:1)*au.sqrt(aw((g*ca-g*b6*b6-ca*b7*b7)/(g*b6*b6+ca*b7*b7))),bW=cc*b1*b6/bZ+(bS+bR)/2,bV=cc*-bZ*b7/b1+(cn+cm)/2,bM=au.asin(((cn-bV)/bZ).toFixed(9)),bL=au.asin(((cm-bV)/bZ).toFixed(9));bM=bS<bW?aV-bM:bM;bL=bR<bW?aV-bL:bL;bM<0&&(bM=aV*2+bM);bL<0&&(bL=aV*2+bL);if(E&&bM>bL){bM=bM-aV*2}if(!E&&bL>bM){bL=bL-aV*2}}else{bM=bU[0];bL=bU[1];bW=bU[2];bV=bU[3]}var bQ=bL-bM;if(aw(bQ)>bY){var bX=bL,b0=bR,bO=cm;bL=bM+bY*(E&&bL>bM?1:-1);bR=bW+b1*au.cos(bL);cm=bV+bZ*au.sin(bL);b5=ae(bR,cm,b1,bZ,bT,0,E,b0,bO,[bL,bX,bW,bV])}bQ=bL-bM;var S=au.cos(bM),cl=au.sin(bM),R=au.cos(bL),ck=au.sin(bL),b8=au.tan(bQ/4),cb=4/3*b1*b8,b9=4/3*bZ*b8,ci=[bS,cn],cg=[bS+cb*cl,cn-b9*S],cf=[bR+cb*ck,cm-b9*R],cd=[bR,cm];cg[0]=2*ci[0]-cg[0];cg[1]=2*ci[1]-cg[1];if(bU){return[cg,cf,cd][bE](b5)}else{b5=[cg,cf,cd][bE](b5).join()[F](",");var b3=[];for(var ce=0,b4=b5.length;ce<b4;ce++){b3[ce]=ce%2?cj(b5[ce-1],b5[ce],b).y:cj(b5[ce],b5[ce+1],b).x}return b3}},ag=function(d,b,i,g,bM,bL,S,R,bN){var E=1-bN;return{x:bp(E,3)*d+bp(E,2)*3*bN*i+E*3*bN*bN*bM+bp(bN,3)*S,y:bp(E,3)*b+bp(E,2)*3*bN*g+E*3*bN*bN*bL+bp(bN,3)*R}},ba=aG(function(i,d,R,E,bU,bT,bQ,bN){var bS=(bU-2*R+i)-(bQ-2*bU+R),bP=2*(R-i)-2*(bU-R),bM=i-R,bL=(-bP+au.sqrt(bP*bP-4*bS*bM))/2/bS,S=(-bP-au.sqrt(bP*bP-4*bS*bM))/2/bS,bO=[d,bN],bR=[i,bQ],g;aw(bL)>"1e12"&&(bL=0.5);aw(S)>"1e12"&&(S=0.5);if(bL>0&&bL<1){g=ag(i,d,R,E,bU,bT,bQ,bN,bL);bR.push(g.x);bO.push(g.y)}if(S>0&&S<1){g=ag(i,d,R,E,bU,bT,bQ,bN,S);bR.push(g.x);bO.push(g.y)}bS=(bT-2*E+d)-(bN-2*bT+E);bP=2*(E-d)-2*(bT-E);bM=d-E;bL=(-bP+au.sqrt(bP*bP-4*bS*bM))/2/bS;S=(-bP-au.sqrt(bP*bP-4*bS*bM))/2/bS;aw(bL)>"1e12"&&(bL=0.5);aw(S)>"1e12"&&(S=0.5);if(bL>0&&bL<1){g=ag(i,d,R,E,bU,bT,bQ,bN,bL);bR.push(g.x);bO.push(g.y)}if(S>0&&S<1){g=ag(i,d,R,E,bU,bT,bQ,bN,S);bR.push(g.x);bO.push(g.y)}return{min:{x:bm[bG](0,bR),y:bm[bG](0,bO)},max:{x:m[bG](0,bR),y:m[bG](0,bO)}}}),W=aR._path2curve=aG(function(bU,bP){var bN=!bP&&Y(bU);if(!bP&&bN.curve){return aZ(bN.curve)}var E=w(bU),bQ=bP&&w(bP),bR={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},d={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},S=function(bV,bW){var i,bX;if(!bV){return["C",bW.x,bW.y,bW.x,bW.y,bW.x,bW.y]}!(bV[0] in {T:1,Q:1})&&(bW.qx=bW.qy=null);switch(bV[0]){case"M":bW.X=bV[1];bW.Y=bV[2];break;case"A":bV=["C"][bE](ae[bG](0,[bW.x,bW.y][bE](bV.slice(1))));break;case"S":i=bW.x+(bW.x-(bW.bx||bW.x));bX=bW.y+(bW.y-(bW.by||bW.y));bV=["C",i,bX][bE](bV.slice(1));break;case"T":bW.qx=bW.x+(bW.x-(bW.qx||bW.x));bW.qy=bW.y+(bW.y-(bW.qy||bW.y));bV=["C"][bE](bn(bW.x,bW.y,bW.qx,bW.qy,bV[1],bV[2]));break;case"Q":bW.qx=bV[1];bW.qy=bV[2];bV=["C"][bE](bn(bW.x,bW.y,bV[1],bV[2],bV[3],bV[4]));break;case"L":bV=["C"][bE](bI(bW.x,bW.y,bV[1],bV[2]));break;case"H":bV=["C"][bE](bI(bW.x,bW.y,bV[1],bW.y));break;case"V":bV=["C"][bE](bI(bW.x,bW.y,bW.x,bV[1]));break;case"Z":bV=["C"][bE](bI(bW.x,bW.y,bW.X,bW.Y));break}return bV},b=function(bV,bW){if(bV[bW].length>7){bV[bW].shift();var bX=bV[bW];while(bX.length){bV.splice(bW++,0,["C"][bE](bX.splice(0,6)))}bV.splice(bW,1);bS=m(E.length,bQ&&bQ.length||0)}},g=function(bZ,bY,bW,bV,bX){if(bZ&&bY&&bZ[bX][0]=="M"&&bY[bX][0]!="M"){bY.splice(bX,0,["M",bV.x,bV.y]);bW.bx=0;bW.by=0;bW.x=bZ[bX][1];bW.y=bZ[bX][2];bS=m(E.length,bQ&&bQ.length||0)}};for(var bM=0,bS=m(E.length,bQ&&bQ.length||0);bM<bS;bM++){E[bM]=S(E[bM],bR);b(E,bM);bQ&&(bQ[bM]=S(bQ[bM],d));bQ&&b(bQ,bM);g(E,bQ,bR,d,bM);g(bQ,E,d,bR,bM);var bL=E[bM],bT=bQ&&bQ[bM],R=bL.length,bO=bQ&&bT.length;bR.x=bL[R-2];bR.y=bL[R-1];bR.bx=an(bL[R-4])||bR.x;bR.by=an(bL[R-3])||bR.y;d.bx=bQ&&(an(bT[bO-4])||d.x);d.by=bQ&&(an(bT[bO-3])||d.y);d.x=bQ&&bT[bO-2];d.y=bQ&&bT[bO-1]}if(!bQ){bN.curve=aZ(E)}return bQ?[E,bQ]:E},null,aZ),v=aR._parseDots=aG(function(bO){var bN=[];for(var S=0,bP=bO.length;S<bP;S++){var b={},bM=bO[S].match(/^([^:]*):?([\d\.]*)/);b.color=aR.getRGB(bM[1]);if(b.color.error){return null}b.color=b.color.hex;bM[2]&&(b.offset=bM[2]+"%");bN.push(b)}for(S=1,bP=bN.length-1;S<bP;S++){if(!bN[S].offset){var g=an(bN[S-1].offset||0),E=0;for(var R=S+1;R<bP;R++){if(bN[R].offset){E=bN[R].offset;break}}if(!E){E=100;R=bP}E=an(E);var bL=(E-g)/(R-S+1);for(;S<R;S++){g+=bL;bN[S].offset=g+"%"}}}return bN}),aK=aR._tear=function(b,d){b==d.top&&(d.top=b.prev);b==d.bottom&&(d.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)},ap=aR._tofront=function(b,d){if(d.top===b){return}aK(b,d);b.next=null;b.prev=d.top;d.top.next=b;d.top=b},p=aR._toback=function(b,d){if(d.bottom===b){return}aK(b,d);b.next=d.bottom;b.prev=null;d.bottom.prev=b;d.bottom=b},G=aR._insertafter=function(d,b,g){aK(d,g);b==g.top&&(g.top=d);b.next&&(b.next.prev=d);d.next=b.next;d.prev=b;b.next=d},aT=aR._insertbefore=function(d,b,g){aK(d,g);b==g.bottom&&(g.bottom=d);b.prev&&(b.prev.next=d);d.prev=b.prev;b.prev=d;d.next=b},bl=aR.toMatrix=function(g,b){var i=am(g),d={_:{transform:aX},getBBox:function(){return i}};aO(d,b);return d.matrix},T=aR.transformPath=function(d,b){return L(d,bl(d,b))},aO=aR._extractTransform=function(d,bZ){if(bZ==null){return d._.transform}bZ=bH(bZ).replace(/\.{3}|\u2026/g,d._.transform||aX);var bR=aR.parseTransformString(bZ),bP=0,bN=0,bM=0,bT=1,bS=1,b0=d._,bU=new aF;b0.transform=bR||[];if(bR){for(var bV=0,bO=bR.length;bV<bO;bV++){var bQ=bR[bV],b=bQ.length,R=bH(bQ[0]).toLowerCase(),bY=bQ[0]!=R,bL=bY?bU.invert():0,bX,E,bW,g,S;if(R=="t"&&b==3){if(bY){bX=bL.x(0,0);E=bL.y(0,0);bW=bL.x(bQ[1],bQ[2]);g=bL.y(bQ[1],bQ[2]);bU.translate(bW-bX,g-E)}else{bU.translate(bQ[1],bQ[2])}}else{if(R=="r"){if(b==2){S=S||d.getBBox(1);bU.rotate(bQ[1],S.x+S.width/2,S.y+S.height/2);bP+=bQ[1]}else{if(b==4){if(bY){bW=bL.x(bQ[2],bQ[3]);g=bL.y(bQ[2],bQ[3]);bU.rotate(bQ[1],bW,g)}else{bU.rotate(bQ[1],bQ[2],bQ[3])}bP+=bQ[1]}}}else{if(R=="s"){if(b==2||b==3){S=S||d.getBBox(1);bU.scale(bQ[1],bQ[b-1],S.x+S.width/2,S.y+S.height/2);bT*=bQ[1];bS*=bQ[b-1]}else{if(b==5){if(bY){bW=bL.x(bQ[3],bQ[4]);g=bL.y(bQ[3],bQ[4]);bU.scale(bQ[1],bQ[2],bW,g)}else{bU.scale(bQ[1],bQ[2],bQ[3],bQ[4])}bT*=bQ[1];bS*=bQ[2]}}}else{if(R=="m"&&b==7){bU.add(bQ[1],bQ[2],bQ[3],bQ[4],bQ[5],bQ[6])}}}}b0.dirtyT=1;d.matrix=bU}}d.matrix=bU;b0.sx=bT;b0.sy=bS;b0.deg=bP;b0.dx=bN=bU.e;b0.dy=bM=bU.f;if(bT==1&&bS==1&&!bP&&b0.bbox){b0.bbox.x+=+bN;b0.bbox.y+=+bM}else{b0.dirtyT=1}},l=function(d){var b=d[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":if(d.length==4){return[b,0,d[2],d[3]]}else{return[b,0]}case"s":if(d.length==5){return[b,1,1,d[3],d[4]]}else{if(d.length==3){return[b,1,1]}else{return[b,1]}}}},aB=aR._equaliseTransform=function(R,E){E=bH(E).replace(/\.{3}|\u2026/g,R);R=aR.parseTransformString(R)||[];E=aR.parseTransformString(E)||[];var b=m(R.length,E.length),bN=[],bO=[],g=0,d,S,bM,bL;for(;g<b;g++){bM=R[g]||l(E[g]);bL=E[g]||l(bM);if((bM[0]!=bL[0])||(bM[0].toLowerCase()=="r"&&(bM[2]!=bL[2]||bM[3]!=bL[3]))||(bM[0].toLowerCase()=="s"&&(bM[3]!=bL[3]||bM[4]!=bL[4]))){return}bN[g]=[];bO[g]=[];for(d=0,S=m(bM.length,bL.length);d<S;d++){d in bM&&(bN[g][d]=bM[d]);d in bL&&(bO[g][d]=bL[d])}}return{from:bN,to:bO}};aR._getContainer=function(b,E,g,i){var d;d=i==null&&!aR.is(b,"object")?aA.doc.getElementById(b):b;if(d==null){return}if(d.tagName){if(E==null){return{container:d,width:d.style.pixelWidth||d.offsetWidth,height:d.style.pixelHeight||d.offsetHeight}}else{return{container:d,width:E,height:g}}}return{container:1,x:b,y:E,width:g,height:i}};aR.pathToRelative=aC;aR._engine={};aR.path2curve=W;aR.matrix=function(i,g,bL,S,R,E){return new aF(i,g,bL,S,R,E)};function aF(i,g,bL,S,R,E){if(i!=null){this.a=+i;this.b=+g;this.c=+bL;this.d=+S;this.e=+R;this.f=+E}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(g){g.add=function(bT,bQ,bO,bM,S,R){var E=[[],[],[]],i=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],bS=[[bT,bO,S],[bQ,bM,R],[0,0,1]],bR,bP,bN,bL;if(bT&&bT instanceof aF){bS=[[bT.a,bT.c,bT.e],[bT.b,bT.d,bT.f],[0,0,1]]}for(bR=0;bR<3;bR++){for(bP=0;bP<3;bP++){bL=0;for(bN=0;bN<3;bN++){bL+=i[bR][bN]*bS[bN][bP]}E[bR][bP]=bL}}this.a=E[0][0];this.b=E[1][0];this.c=E[0][1];this.d=E[1][1];this.e=E[0][2];this.f=E[1][2]};g.invert=function(){var E=this,i=E.a*E.d-E.b*E.c;return new aF(E.d/i,-E.b/i,-E.c/i,E.a/i,(E.c*E.f-E.d*E.e)/i,(E.b*E.e-E.a*E.f)/i)};g.clone=function(){return new aF(this.a,this.b,this.c,this.d,this.e,this.f)};g.translate=function(i,E){this.add(1,0,0,1,i,E)};g.scale=function(E,S,i,R){S==null&&(S=E);(i||R)&&this.add(1,0,0,1,i,R);this.add(E,0,0,S,0,0);(i||R)&&this.add(1,0,0,1,-i,-R)};g.rotate=function(E,i,bL){E=aR.rad(E);i=i||0;bL=bL||0;var S=+au.cos(E).toFixed(9),R=+au.sin(E).toFixed(9);this.add(S,R,-R,S,i,bL);this.add(1,0,0,1,-i,-bL)};g.x=function(i,E){return i*this.a+E*this.c+this.e};g.y=function(i,E){return i*this.b+E*this.d+this.f};g.get=function(E){return +this[bH.fromCharCode(97+E)].toFixed(4)};g.toString=function(){return aR.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};g.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};g.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function d(i){return i[0]*i[0]+i[1]*i[1]}function b(i){var E=au.sqrt(d(i));i[0]&&(i[0]/=E);i[1]&&(i[1]/=E)}g.split=function(){var E={};E.dx=this.e;E.dy=this.f;var S=[[this.a,this.c],[this.b,this.d]];E.scalex=au.sqrt(d(S[0]));b(S[0]);E.shear=S[0][0]*S[1][0]+S[0][1]*S[1][1];S[1]=[S[1][0]-S[0][0]*E.shear,S[1][1]-S[0][1]*E.shear];E.scaley=au.sqrt(d(S[1]));b(S[1]);E.shear/=E.scaley;var i=-S[0][1],R=S[1][1];if(R<0){E.rotate=aR.deg(au.acos(R));if(i<0){E.rotate=360-E.rotate}}else{E.rotate=aR.deg(au.asin(i))}E.isSimple=!+E.shear.toFixed(9)&&(E.scalex.toFixed(9)==E.scaley.toFixed(9)||!E.rotate);E.isSuperSimple=!+E.shear.toFixed(9)&&E.scalex.toFixed(9)==E.scaley.toFixed(9)&&!E.rotate;E.noRotation=!+E.shear.toFixed(9)&&!E.rotate;return E};g.toTransformString=function(i){var E=i||this[F]();if(E.isSimple){E.scalex=+E.scalex.toFixed(4);E.scaley=+E.scaley.toFixed(4);E.rotate=+E.rotate.toFixed(4);return(E.dx||E.dy?"t"+[E.dx,E.dy]:aX)+(E.scalex!=1||E.scaley!=1?"s"+[E.scalex,E.scaley,0,0]:aX)+(E.rotate?"r"+[E.rotate,0,0]:aX)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(aF.prototype);var V=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(V&&V[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&V&&V[1]<8)){a4.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}}else{a4.safari=I}var P=function(){this.returnValue=false},bD=function(){return this.originalEvent.preventDefault()},a8=function(){this.cancelBubble=true},aJ=function(){return this.originalEvent.stopPropagation()},aD=(function(){if(aA.doc.addEventListener){return function(R,i,g,d){var b=Z&&bx[i]?bx[i]:i,E=function(bP){var bO=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bQ=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft,S=bP.clientX+bQ,bR=bP.clientY+bO;if(Z&&bx[ak](i)){for(var bM=0,bN=bP.targetTouches&&bP.targetTouches.length;bM<bN;bM++){if(bP.targetTouches[bM].target==R){var bL=bP;bP=bP.targetTouches[bM];bP.originalEvent=bL;bP.preventDefault=bD;bP.stopPropagation=aJ;break}}}return g.call(d,bP,S,bR)};R.addEventListener(b,E,false);return function(){R.removeEventListener(b,E,false);return true}}}else{if(aA.doc.attachEvent){return function(R,i,g,d){var E=function(bM){bM=bM||aA.win.event;var bL=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bN=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft,S=bM.clientX+bN,bO=bM.clientY+bL;bM.preventDefault=bM.preventDefault||P;bM.stopPropagation=bM.stopPropagation||a8;return g.call(d,bM,S,bO)};R.attachEvent("on"+i,E);var b=function(){R.detachEvent("on"+i,E);return true};return b}}}})(),be=[],by=function(bM){var bP=bM.clientX,bO=bM.clientY,bR=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bS=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft,g,E=be.length;while(E--){g=be[E];if(Z){var S=bM.touches.length,R;while(S--){R=bM.touches[S];if(R.identifier==g.el._drag.id){bP=R.clientX;bO=R.clientY;(bM.originalEvent?bM.originalEvent:bM).preventDefault();break}}}else{bM.preventDefault()}var d=g.el.node,b,bL=d.nextSibling,bQ=d.parentNode,bN=d.style.display;aA.win.opera&&bQ.removeChild(d);d.style.display="none";b=g.el.paper.getElementByPoint(bP,bO);d.style.display=bN;aA.win.opera&&(bL?bQ.insertBefore(d,bL):bQ.appendChild(d));b&&eve("raphael.drag.over."+g.el.id,g.el,b);bP+=bS;bO+=bR;eve("raphael.drag.move."+g.el.id,g.move_scope||g.el,bP-g.el._drag.x,bO-g.el._drag.y,bP,bO,bM)}},e=function(g){aR.unmousemove(by).unmouseup(e);var d=be.length,b;while(d--){b=be[d];b.el._drag={};eve("raphael.drag.end."+b.el.id,b.end_scope||b.start_scope||b.move_scope||b.el,g)}be=[]},bh=aR.el={};for(var ax=Q.length;ax--;){(function(b){aR[b]=bh[b]=function(g,d){if(aR.is(g,"function")){this.events=this.events||[];this.events.push({name:b,f:g,unbind:aD(this.shape||this.node||aA.doc,b,g,d||this)})}return this};aR["un"+b]=bh["un"+b]=function(i){var g=this.events||[],d=g.length;while(d--){if(g[d].name==b&&g[d].f==i){g[d].unbind();g.splice(d,1);!g.length&&delete this.events;return this}}return this}})(Q[ax])}bh.data=function(d,E){var g=aU[this.id]=aU[this.id]||{};if(arguments.length==1){if(aR.is(d,"object")){for(var b in d){if(d[ak](b)){this.data(b,d[b])}}return this}eve("raphael.data.get."+this.id,this,g[d],d);return g[d]}g[d]=E;eve("raphael.data.set."+this.id,this,E,d);return this};bh.removeData=function(b){if(b==null){aU[this.id]={}}else{aU[this.id]&&delete aU[this.id][b]}return this};bh.hover=function(i,b,g,d){return this.mouseover(i,g).mouseout(b,d||g)};bh.unhover=function(d,b){return this.unmouseover(d).unmouseout(b)};var bu=[];bh.drag=function(d,R,E,b,g,i){function S(bM){(bM.originalEvent||bM).preventDefault();var bL=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bN=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft;this._drag.x=bM.clientX+bN;this._drag.y=bM.clientY+bL;this._drag.id=bM.identifier;!be.length&&aR.mousemove(by).mouseup(e);be.push({el:this,move_scope:b,start_scope:g,end_scope:i});R&&eve.on("raphael.drag.start."+this.id,R);d&&eve.on("raphael.drag.move."+this.id,d);E&&eve.on("raphael.drag.end."+this.id,E);eve("raphael.drag.start."+this.id,g||b||this,bM.clientX+bN,bM.clientY+bL,bM)}this._drag={};bu.push({el:this,start:S});this.mousedown(S);return this};bh.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)};bh.undrag=function(){var b=bu.length;while(b--){if(bu[b].el==this){this.unmousedown(bu[b].start);bu.splice(b,1);eve.unbind("raphael.drag.*."+this.id)}}!bu.length&&aR.unmousemove(by).unmouseup(e)};a4.group=function(b,g){var d=aR._engine.group(this,b||0,g||0);this.__set__&&this.__set__.push(d);return d};a4.circle=function(b,i,g){var d=aR._engine.circle(this,b||0,i||0,g||0);this.__set__&&this.__set__.push(d);return d};a4.rect=function(b,R,d,i,E){var g=aR._engine.rect(this,b||0,R||0,d||0,i||0,E||0);this.__set__&&this.__set__.push(g);return g};a4.ellipse=function(b,E,i,g){var d=aR._engine.ellipse(this,b||0,E||0,i||0,g||0);this.__set__&&this.__set__.push(d);return d};a4.path=function(b){b&&!aR.is(b,aj)&&!aR.is(b[0],bd)&&(b+=aX);var d=aR._engine.path(aR.format[bG](aR,arguments),this);this.__set__&&this.__set__.push(d);return d};a4.image=function(E,b,R,d,i){var g=aR._engine.image(this,E||"about:blank",b||0,R||0,d||0,i||0);this.__set__&&this.__set__.push(g);return g};a4.text=function(b,i,g){var d=aR._engine.text(this,b||0,i||0,bH(g));this.__set__&&this.__set__.push(d);return d};a4.foreignObject=function(E,b,R,d,i){var g=aR._engine.foreignObject(this,b||0,R||0,d||0,i||0,E);this.__set__&&this.__set__.push(g);return g};a4.set=function(d){!aR.is(d,"array")&&(d=Array.prototype.splice.call(arguments,0,arguments.length));var b=new al(d);this.__set__&&this.__set__.push(b);return b};a4.setStart=function(b){this.__set__=b||this.set()};a4.setFinish=function(d){var b=this.__set__;delete this.__set__;return b};a4.setSize=function(d,b){return aR._engine.setSize.call(this,d,b)};a4.setViewBox=function(b,E,d,i,g){return aR._engine.setViewBox.call(this,b,E,d,i,g)};a4.top=a4.bottom=null;a4.raphael=aR;var bs=function(g){var E=g.getBoundingClientRect(),bM=g.ownerDocument,R=bM.body,b=bM.documentElement,i=b.clientTop||R.clientTop||0,S=b.clientLeft||R.clientLeft||0,bL=E.top+(aA.win.pageYOffset||b.scrollTop||R.scrollTop)-i,d=E.left+(aA.win.pageXOffset||b.scrollLeft||R.scrollLeft)-S;return{y:bL,x:d}};a4.getElementByPoint=function(d,bL){var S=this,g=S.canvas,R=aA.doc.elementFromPoint(d,bL);if(aA.win.opera&&R.tagName=="svg"){var E=bs(g),i=g.createSVGRect();i.x=d-E.x;i.y=bL-E.y;i.width=i.height=1;var b=g.getIntersectionList(i,null);if(b.length){R=b[b.length-1]}}if(!R){return null}while(R.parentNode&&R!=g.parentNode&&!R.raphael){R=R.parentNode}R==S.canvas.parentNode&&(R=g);R=R&&R.raphael?S.getById(R.raphaelid):null;return R};a4.getById=function(d){var b=this.bottom;while(b){if(b.id==d){return b}b=b.next}return null};a4.forEach=function(g,b){var d=this.bottom;while(d){if(g.call(b,d)===false){return this}d=d.next}return this};a4.getElementsByPoint=function(b,g){var d=this.set();this.forEach(function(i){if(i.isPointInside(b,g)){d.push(i)}});return d};function y(){return this.x+aQ+this.y}function at(){return this.x+aQ+this.y+aQ+this.width+" \xd7 "+this.height}bh.isPointInside=function(b,g){var d=this.realPath=this.realPath||N[this.type](this);return aR.isPointInsidePath(d,b,g)};bh.getBBox=function(d){if(this.removed){return{}}var b=this._;if(d){if(b.dirty||!b.bboxwt){this.realPath=N[this.type](this);b.bboxwt=am(this.realPath);b.bboxwt.toString=at;b.dirty=0}return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath){b.bboxwt=0;this.realPath=N[this.type](this)}b.bbox=am(L(this.realPath,this.matrix));b.bbox.toString=at;b.dirty=b.dirtyT=0}return b.bbox};bh.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};bh.glow=function(bL){if(this.type=="text"){return null}bL=bL||{};var g={width:(bL.width||10)+(+this.attr("stroke-width")||1),fill:bL.fill||false,opacity:bL.opacity||0.5,offsetx:bL.offsetx||0,offsety:bL.offsety||0,color:bL.color||"#000"},S=g.width/2,E=this.paper,b=E.set(),R=this.realPath||N[this.type](this);R=this.matrix?L(R,this.matrix):R;for(var d=1;d<S+1;d++){b.push(E.path(R).attr({stroke:g.color,fill:g.fill?g.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(g.width/S*d).toFixed(3),opacity:+(g.opacity/S).toFixed(3)}))}return b.insertBefore(this).translate(g.offsetx,g.offsety)};var a7={},k=function(d,b,E,i,bM,bL,S,R,g){if(g==null){return q(d,b,E,i,bM,bL,S,R)}else{return aR.findDotsAtSegment(d,b,E,i,bM,bL,S,R,C(d,b,E,i,bM,bL,S,R,g))}},a6=function(b,d){return function(bT,R,S){bT=W(bT);var bP,bO,g,bL,E="",bS={},bQ,bN=0;for(var bM=0,bR=bT.length;bM<bR;bM++){g=bT[bM];if(g[0]=="M"){bP=+g[1];bO=+g[2]}else{bL=k(bP,bO,g[1],g[2],g[3],g[4],g[5],g[6]);if(bN+bL>R){if(d&&!bS.start){bQ=k(bP,bO,g[1],g[2],g[3],g[4],g[5],g[6],R-bN);E+=["C"+bQ.start.x,bQ.start.y,bQ.m.x,bQ.m.y,bQ.x,bQ.y];if(S){return E}bS.start=E;E=["M"+bQ.x,bQ.y+"C"+bQ.n.x,bQ.n.y,bQ.end.x,bQ.end.y,g[5],g[6]].join();bN+=bL;bP=+g[5];bO=+g[6];continue}if(!b&&!d){bQ=k(bP,bO,g[1],g[2],g[3],g[4],g[5],g[6],R-bN);return{x:bQ.x,y:bQ.y,alpha:bQ.alpha}}}bN+=bL;bP=+g[5];bO=+g[6]}E+=g.shift()+g}bS.end=E;bQ=b?bN:d?bS:aR.findDotsAtSegment(bP,bO,g[0],g[1],g[2],g[3],g[4],g[5],1);bQ.alpha&&(bQ={x:bQ.x,y:bQ.y,alpha:bQ.alpha});return bQ}};var aS=a6(1),J=a6(),ad=a6(0,1);aR.getTotalLength=aS;aR.getPointAtLength=J;aR.getSubpath=function(d,i,g){if(this.getTotalLength(d)-g<0.000001){return ad(d,i).end}var b=ad(d,g,1);return i?ad(b,i).end:b};bh.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return aS(this.attrs.path)};bh.getPointAtLength=function(b){if(this.type!="path"){return}return J(this.attrs.path,b)};bh.getSubpath=function(d,b){if(this.type!="path"){return}return aR.getSubpath(this.attrs.path,d,b)};var o=aR.easing_formulas={linear:function(b){return b},"<":function(b){return bp(b,1.7)},">":function(b){return bp(b,0.48)},"<>":function(bL){var i=0.48-bL/1.04,g=au.sqrt(0.1734+i*i),b=g-i,S=bp(aw(b),1/3)*(b<0?-1:1),R=-g-i,E=bp(aw(R),1/3)*(R<0?-1:1),d=S+E+0.5;return(1-d)*3*d*d+d*d*d},backIn:function(d){var b=1.70158;return d*d*((b+1)*d-b)},backOut:function(d){d=d-1;var b=1.70158;return d*d*((b+1)*d+b)+1},elastic:function(b){if(b==!!b){return b}return bp(2,-10*b)*au.sin((b-0.075)*(2*aV)/0.3)+1},bounce:function(i){var d=7.5625,g=2.75,b;if(i<(1/g)){b=d*i*i}else{if(i<(2/g)){i-=(1.5/g);b=d*i*i+0.75}else{if(i<(2.5/g)){i-=(2.25/g);b=d*i*i+0.9375}else{i-=(2.625/g);b=d*i*i+0.984375}}}return b}};o.easeIn=o["ease-in"]=o["<"];o.easeOut=o["ease-out"]=o[">"];o.easeInOut=o["ease-in-out"]=o["<>"];o["back-in"]=o.backIn;o["back-out"]=o.backOut;var ab=[],aN=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},bC=function(){var bL=+new Date,bT=0;for(;bT<ab.length;bT++){var bZ=ab[bT];if(bZ.el.removed||bZ.paused){continue}var E=bL-bZ.start,bR=bZ.ms,bQ=bZ.easing,bU=bZ.from,bO=bZ.diff,d=bZ.to,bN=bZ.t,S=bZ.el,bP={},b,bX={},b1;if(bZ.initstatus){E=(bZ.initstatus*bZ.anim.top-bZ.prev)/(bZ.percent-bZ.prev)*bR;bZ.status=bZ.initstatus;delete bZ.initstatus;bZ.stop&&ab.splice(bT--,1)}else{bZ.status=(bZ.prev+(bZ.percent-bZ.prev)*(E/bR))/bZ.anim.top}if(E<0){continue}if(E<bR){var g=bQ(E/bR);for(var bS in bU){if(bU[ak](bS)){switch(ar[bS]){case aL:b=+bU[bS]+g*bR*bO[bS];break;case"colour":b="rgb("+[H(ah(bU[bS].r+g*bR*bO[bS].r)),H(ah(bU[bS].g+g*bR*bO[bS].g)),H(ah(bU[bS].b+g*bR*bO[bS].b))].join(",")+")";break;case"path":b=[];for(var bW=0,bM=bU[bS].length;bW<bM;bW++){b[bW]=[bU[bS][bW][0]];for(var bV=1,bY=bU[bS][bW].length;bV<bY;bV++){b[bW][bV]=+bU[bS][bW][bV]+g*bR*bO[bS][bW][bV]}b[bW]=b[bW].join(aQ)}b=b.join(aQ);break;case"transform":if(bO[bS].real){b=[];for(bW=0,bM=bU[bS].length;bW<bM;bW++){b[bW]=[bU[bS][bW][0]];for(bV=1,bY=bU[bS][bW].length;bV<bY;bV++){b[bW][bV]=bU[bS][bW][bV]+g*bR*bO[bS][bW][bV]}}}else{var b0=function(b2){return +bU[bS][b2]+g*bR*bO[bS][b2]};b=[["m",b0(0),b0(1),b0(2),b0(3),b0(4),b0(5)]]}break;case"csv":if(bS=="clip-rect"){b=[];bW=4;while(bW--){b[bW]=+bU[bS][bW]+g*bR*bO[bS][bW]}}break;default:var R=[][bE](bU[bS]);b=[];bW=S.paper.customAttributes[bS].length;while(bW--){b[bW]=+R[bW]+g*bR*bO[bS][bW]}break}bP[bS]=b}}S.attr(bP);(function(b3,i,b2){setTimeout(function(){eve("raphael.anim.frame."+b3,i,b2)})})(S.id,S,bZ.anim)}else{(function(b3,b2,i){setTimeout(function(){eve("raphael.anim.frame."+b2.id,b2,i);eve("raphael.anim.finish."+b2.id,b2,i);aR.is(b3,"function")&&b3.call(b2)})})(bZ.callback,S,bZ.anim);S.attr(d);ab.splice(bT--,1);if(bZ.repeat>1&&!bZ.next){for(b1 in d){if(d[ak](b1)){bX[b1]=bZ.totalOrigin[b1]}}bZ.el.attr(bX);aM(bZ.anim,bZ.el,bZ.anim.percents[0],null,bZ.totalOrigin,bZ.repeat-1)}if(bZ.next&&!bZ.stop){aM(bZ.anim,bZ.el,bZ.next,null,bZ.totalOrigin,bZ.repeat)}}}aR.svg&&S&&S.paper&&S.paper.safari();ab.length&&aN(bC)},H=function(b){return b>255?255:b<0?0:b};bh.animateWith=function(d,E,g,b,bL,bQ){var S=this;if(S.removed){bQ&&bQ.call(S);return S}var bO=g instanceof bA?g:aR.animation(g,b,bL,bQ),bN,bM;aM(bO,S,bO.percents[0],null,S.attr());for(var R=0,bP=ab.length;R<bP;R++){if(ab[R].anim==E&&ab[R].el==d){ab[bP-1].start=ab[R].start;break}}return S};function a3(bR,i,d,bQ,bP,bL){var bM=3*i,bO=3*(bQ-i)-bM,b=1-bM-bO,S=3*d,bN=3*(bP-d)-S,bS=1-S-bN;function R(bT){return((b*bT+bO)*bT+bM)*bT}function g(bT,bV){var bU=E(bT,bV);return((bS*bU+bN)*bU+S)*bU}function E(bT,b0){var bZ,bY,bW,bU,bX,bV;for(bW=bT,bV=0;bV<8;bV++){bU=R(bW)-bT;if(aw(bU)<b0){return bW}bX=(3*b*bW+2*bO)*bW+bM;if(aw(bX)<0.000001){break}bW=bW-bU/bX}bZ=0;bY=1;bW=bT;if(bW<bZ){return bZ}if(bW>bY){return bY}while(bZ<bY){bU=R(bW);if(aw(bU-bT)<b0){return bW}if(bT>bU){bZ=bW}else{bY=bW}bW=(bY-bZ)/2+bZ}return bW}return g(bR,1/(200*bL))}bh.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this};function bA(E,g){var d=[],i={};this.ms=g;this.times=1;if(E){for(var b in E){if(E[ak](b)){i[an(b)]=E[b];d.push(an(b))}}d.sort(u)}this.anim=i;this.top=d[d.length-1];this.percents=d}bA.prototype.delay=function(d){var b=new bA(this.anim,this.ms);b.times=this.times;b.del=+d||0;return b};bA.prototype.repeat=function(d){var b=new bA(this.anim,this.ms);b.del=this.del;b.times=au.floor(m(d,0))||1;return b};function aM(b3,g,b,b1,bL,bP){b=an(b);var ca,S,bO,cb=[],bV,bU,R,bX=b3.ms,b2={},E={},bR={};if(b1){for(b6=0,bQ=ab.length;b6<bQ;b6++){var b8=ab[b6];if(b8.el.id==g.id&&b8.anim==b3){if(b8.percent!=b){ab.splice(b6,1);bO=1}else{S=b8}g.attr(b8.totalOrigin);break}}}else{b1=+E}for(var b6=0,bQ=b3.percents.length;b6<bQ;b6++){if(b3.percents[b6]==b||b3.percents[b6]>b1*b3.top){b=b3.percents[b6];bU=b3.percents[b6-1]||0;bX=bX/b3.top*(b-bU);bV=b3.percents[b6+1];ca=b3.anim[b];break}else{if(b1){g.attr(b3.anim[b3.percents[b6]])}}}if(!ca){return}if(!S){for(var bZ in ca){if(ca[ak](bZ)){if(ar[ak](bZ)||g.paper.customAttributes[ak](bZ)){b2[bZ]=g.attr(bZ);(b2[bZ]==null)&&(b2[bZ]=r[bZ]);E[bZ]=ca[bZ];switch(ar[bZ]){case aL:bR[bZ]=(E[bZ]-b2[bZ])/bX;break;case"colour":b2[bZ]=aR.getRGB(b2[bZ]);var b0=aR.getRGB(E[bZ]);bR[bZ]={r:(b0.r-b2[bZ].r)/bX,g:(b0.g-b2[bZ].g)/bX,b:(b0.b-b2[bZ].b)/bX};break;case"path":var bM=W(b2[bZ],E[bZ]),bT=bM[1];b2[bZ]=bM[0];bR[bZ]=[];for(b6=0,bQ=b2[bZ].length;b6<bQ;b6++){bR[bZ][b6]=[0];for(var b5=1,b7=b2[bZ][b6].length;b5<b7;b5++){bR[bZ][b6][b5]=(bT[b6][b5]-b2[bZ][b6][b5])/bX}}break;case"transform":var cd=g._,cc=aB(cd[bZ],E[bZ]);if(cc){b2[bZ]=cc.from;E[bZ]=cc.to;bR[bZ]=[];bR[bZ].real=true;for(b6=0,bQ=b2[bZ].length;b6<bQ;b6++){bR[bZ][b6]=[b2[bZ][b6][0]];for(b5=1,b7=b2[bZ][b6].length;b5<b7;b5++){bR[bZ][b6][b5]=(E[bZ][b6][b5]-b2[bZ][b6][b5])/bX}}}else{var bY=(g.matrix||new aF),b9={_:{transform:cd.transform},getBBox:function(){return g.getBBox(1)}};b2[bZ]=[bY.a,bY.b,bY.c,bY.d,bY.e,bY.f];aO(b9,E[bZ]);E[bZ]=b9._.transform;bR[bZ]=[(b9.matrix.a-bY.a)/bX,(b9.matrix.b-bY.b)/bX,(b9.matrix.c-bY.c)/bX,(b9.matrix.d-bY.d)/bX,(b9.matrix.e-bY.e)/bX,(b9.matrix.f-bY.f)/bX]}break;case"csv":var d=bH(ca[bZ])[F](a),bN=bH(b2[bZ])[F](a);if(bZ=="clip-rect"){b2[bZ]=bN;bR[bZ]=[];b6=bN.length;while(b6--){bR[bZ][b6]=(d[b6]-b2[bZ][b6])/bX}}E[bZ]=d;break;default:d=[][bE](ca[bZ]);bN=[][bE](b2[bZ]);bR[bZ]=[];b6=g.paper.customAttributes[bZ].length;while(b6--){bR[bZ][b6]=((d[b6]||0)-(bN[b6]||0))/bX}break}}}}var bW=ca.easing,b4=aR.easing_formulas[bW];if(!b4){b4=bH(bW).match(c);if(b4&&b4.length==5){var bS=b4;b4=function(i){return a3(i,+bS[1],+bS[2],+bS[3],+bS[4],bX)}}else{b4=bB}}R=ca.start||b3.start||+new Date;b8={anim:b3,percent:b,timestamp:R,start:R+(b3.del||0),status:0,initstatus:b1||0,stop:false,ms:bX,easing:b4,from:b2,diff:bR,to:E,el:g,callback:ca.callback,prev:bU,next:bV,repeat:bP||b3.times,origin:g.attr(),totalOrigin:bL};ab.push(b8);if(b1&&!S&&!bO){b8.stop=true;b8.start=new Date-bX*b1;if(ab.length==1){return bC()}}if(bO){b8.start=new Date-b8.ms*b1}ab.length==1&&aN(bC)}else{S.initstatus=b1;S.start=new Date-S.ms*b1}eve("raphael.anim.start."+g.id,g,b3)}aR.animation=function(E,d,S,R){if(E instanceof bA){return E}if(aR.is(S,"function")||!S){R=R||S||null;S=null}E=Object(E);d=+d||0;var i={},g,b;for(b in E){if(E[ak](b)&&an(b)!=b&&an(b)+"%"!=b){g=true;i[b]=E[b]}}if(!g){return new bA(E,d)}else{S&&(i.easing=S);R&&(i.callback=R);return new bA({100:i},d)}};bh.animate=function(i,b,R,E){var d=this;if(d.removed){E&&E.call(d);return d}var g=i instanceof bA?i:aR.animation(i,b,R,E);aM(g,d,g.percents[0],null,d.attr());return d};bh.setTime=function(d,b){if(d&&b!=null){this.status(d,bm(b,d.ms)/d.ms)}return this};bh.status=function(R,E){var d=[],g=0,b,S;if(E!=null){aM(R,this,-1,bm(E,1));return this}else{b=ab.length;for(;g<b;g++){S=ab[g];if(S.el.id==this.id&&(!R||S.anim==R)){if(R){return S.status}d.push({anim:S.anim,status:S.status})}}if(R){return 0}return d}};bh.pause=function(d){for(var b=0;b<ab.length;b++){if(ab[b].el.id==this.id&&(!d||ab[b].anim==d)){if(eve("raphael.anim.pause."+this.id,this,ab[b].anim)!==false){ab[b].paused=true}}}return this};bh.resume=function(d){for(var b=0;b<ab.length;b++){if(ab[b].el.id==this.id&&(!d||ab[b].anim==d)){var g=ab[b];if(eve("raphael.anim.resume."+this.id,this,g.anim)!==false){delete g.paused;this.status(g.anim,g.status)}}}return this};bh.stop=function(d){for(var b=0;b<ab.length;b++){if(ab[b].el.id==this.id&&(!d||ab[b].anim==d)){if(eve("raphael.anim.stop."+this.id,this,ab[b].anim)!==false){ab.splice(b--,1)}}}return this};function aa(d){for(var b=0;b<ab.length;b++){if(ab[b].el.paper==d){ab.splice(b--,1)}}}eve.on("raphael.remove",aa);eve.on("raphael.clear",aa);bh.toString=function(){return"Rapha\xebl\u2019s object"};var al=function(b){this.items=[];this.length=0;this.type="set";if(b){for(var d=0,g=b.length;d<g;d++){if(b[d]&&(b[d].constructor==bh.constructor||b[d].constructor==al)){this[this.items.length]=this.items[this.items.length]=b[d];this.length++}}}},bc=al.prototype;bc.push=function(){var E,b;for(var d=0,g=arguments.length;d<g;d++){E=arguments[d];if(E&&(E.constructor==bh.constructor||E.constructor==al)){b=this.items.length;this[b]=this.items[b]=E;this.length++}}return this};bc.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};bc.forEach=function(E,b){for(var d=0,g=this.items.length;d<g;d++){if(E.call(b,this.items[d],d)===false){return this}}return this};for(var B in bh){if(bh[ak](B)){bc[B]=(function(b){return function(){var d=arguments;return this.forEach(function(g){g[b][bG](g,d)})}})(B)}}bc.attr=function(d,S){if(d&&aR.is(d,bd)&&aR.is(d[0],"object")){for(var b=0,R=d.length;b<R;b++){this.items[b].attr(d[b])}}else{for(var g=0,E=this.items.length;g<E;g++){this.items[g].attr(d,S)}}return this};bc.clear=function(){while(this.length){this.pop()}};bc.splice=function(E,bL,bM){E=E<0?m(this.length+E,0):E;bL=m(0,bm(this.length-E,bL));var g=[],b=[],d=[],R;for(R=2;R<arguments.length;R++){d.push(arguments[R])}for(R=0;R<bL;R++){b.push(this[E+R])}for(;R<this.length-E;R++){g.push(this[E+R])}var S=d.length;for(R=0;R<S+g.length;R++){this.items[E+R]=this[E+R]=R<S?d[R]:g[R-S]}R=this.items.length=this.length-=bL-S;while(this[R]){delete this[R++]}return new al(b)};bc.exclude=function(g){for(var b=0,d=this.length;b<d;b++){if(this[b]==g){this.splice(b,1);return true}}};bc.animate=function(g,b,bL,bN){(aR.is(bL,"function")||!bL)&&(bN=bL||null);var S=this.items.length,E=S,bO,bM=this,R;if(!S){return this}bN&&(R=function(){!--S&&bN.call(bM)});bL=aR.is(bL,aj)?bL:R;var d=aR.animation(g,b,bL,R);bO=this.items[--E].animate(d);while(E--){this.items[E]&&!this.items[E].removed&&this.items[E].animateWith(bO,d,d)}return this};bc.insertAfter=function(d){var b=this.items.length;while(b--){this.items[b].insertAfter(d)}return this};bc.getBBox=function(){var b=[],S=[],d=[],E=[];for(var g=this.items.length;g--;){if(!this.items[g].removed){var R=this.items[g].getBBox();b.push(R.x);S.push(R.y);d.push(R.x+R.width);E.push(R.y+R.height)}}b=bm[bG](0,b);S=bm[bG](0,S);d=m[bG](0,d);E=m[bG](0,E);return{x:b,y:S,x2:d,y2:E,width:d-b,height:E-S}};bc.clone=function(g){g=new al;for(var b=0,d=this.items.length;b<d;b++){g.push(this.items[b].clone())}return g};bc.toString=function(){return"Rapha\xebl\u2018s set"};aR.registerFont=function(d){if(!d.face){return d}this.fonts=this.fonts||{};var i={w:d.w,face:{},glyphs:{}},g=d.face["font-family"];for(var S in d.face){if(d.face[ak](S)){i.face[S]=d.face[S]}}if(this.fonts[g]){this.fonts[g].push(i)}else{this.fonts[g]=[i]}if(!d.svg){i.face["units-per-em"]=U(d.face["units-per-em"],10);for(var E in d.glyphs){if(d.glyphs[ak](E)){var R=d.glyphs[E];i.glyphs[E]={w:R.w,k:{},d:R.d&&"M"+R.d.replace(/[mlcxtrv]/g,function(bL){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bL]||"M"})+"z"};if(R.k){for(var b in R.k){if(R[ak](b)){i.glyphs[E].k[b]=R.k[b]}}}}}}return d};a4.getFont=function(bM,bN,d,E){E=E||"normal";d=d||"normal";bN=+bN||{normal:400,bold:700,lighter:300,bolder:800}[bN]||400;if(!aR.fonts){return}var R=aR.fonts[bM];if(!R){var g=new RegExp("(^|\\s)"+bM.replace(/[^\w\d\s+!~.:_-]/g,aX)+"(\\s|$)","i");for(var b in aR.fonts){if(aR.fonts[ak](b)){if(g.test(b)){R=aR.fonts[b];break}}}}var S;if(R){for(var bL=0,bO=R.length;bL<bO;bL++){S=R[bL];if(S.face["font-weight"]==bN&&(S.face["font-style"]==d||!S.face["font-style"])&&S.face["font-stretch"]==E){break}}}return S};a4.print=function(bL,S,b,bO,bP,bY,d){bY=bY||"middle";d=m(bm(d||0,1),-1);var bX=bH(b)[F](aX),bU=0,bW=0,bS=aX,bZ;aR.is(bO,b)&&(bO=this.getFont(bO));if(bO){bZ=(bP||16)/bO.face["units-per-em"];var E=bO.face.bbox[F](a),bN=+E[0],g=E[3]-E[1],R=0,bQ=+E[1]+(bY=="baseline"?g+(+bO.face.descent):g/2);for(var bT=0,bM=bX.length;bT<bM;bT++){if(bX[bT]=="\n"){bU=0;bV=0;bW=0;R+=g}else{var bR=bW&&bO.glyphs[bX[bT-1]]||{},bV=bO.glyphs[bX[bT]];bU+=bW?(bR.w||bO.w)+(bR.k&&bR.k[bX[bT]]||0)+(bO.w*d):0;bW=1}if(bV&&bV.d){bS+=aR.transformPath(bV.d,["t",bU*bZ,R*bZ,"s",bZ,bZ,bN,bQ,"t",(bL-bN)/bZ,(S-bQ)/bZ])}}}return this.path(bS).attr({fill:"#000",stroke:"none"})};a4.add=function(E){if(aR.is(E,"array")){var g=this.set(),d=0,R=E.length,b;for(;d<R;d++){b=E[d]||{};bw[ak](b.type)&&g.push(this[b.type]().attr(b))}}return g};aR.format=function(d,g){var b=aR.is(g,bd)?[0][bE](g):arguments;d&&aR.is(d,aj)&&b.length-1&&(d=d.replace(br,function(R,E){return b[++E]==null?aX:b[E]}));return d||aX};aR.fullfill=(function(){var g=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,d=function(R,E,S){var i=S;E.replace(b,function(bN,bM,bL,bP,bO){bM=bM||bP;if(i){if(bM in i){i=i[bM]}typeof i=="function"&&bO&&(i=i())}});i=(i==null||i==S?R:i)+"";return i};return function(E,i){return String(E).replace(g,function(S,R){return d(S,R,i)})}})();aR.ninja=function(){s.was?(aA.win.Raphael=s.is):delete Raphael;return aR};aR.st=bc;(function(i,d,g){if(i.readyState==null&&i.addEventListener){i.addEventListener(d,g=function(){i.removeEventListener(d,g,false);i.readyState="complete"},false);i.readyState="loading"}function b(){(/in/).test(i.readyState)?setTimeout(b,9):aR.eve("raphael.DOMload")}b()})(document,"DOMContentLoaded");s.was?(aA.win.Raphael=aR):(Raphael=aR);eve.on("raphael.DOMload",function(){ao=true})})();window.Raphael.svg&&function(l){var d="hasOwnProperty",B=String,n=parseFloat,q=parseInt,f=Math,C=f.max,s=f.abs,h=f.pow,g=/[, ]+/,z=l.eve,r="",j=" ";var o="http://www.w3.org/1999/xlink",y={block:"M5,0 0,2.5 5,5z",open_block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open_diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z",open_oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},u={};l.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var i=function(F,D){if(D){if(typeof F=="string"){F=i(F)}for(var E in D){if(D[d](E)){if(E.substring(0,6)=="xlink:"){F.setAttributeNS(o,E.substring(6),B(D[E]))}else{F.setAttribute(E,B(D[E]))}}}}else{F=l._g.doc.createElementNS("http://www.w3.org/2000/svg",F);F.style&&(F.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return F},a=function(M,Q){var O="linear",E=M.id+Q,K=0.5,I=0.5,G=M.node,D=M.paper,S=G.style,F=l._g.doc.getElementById(E);if(!F){Q=B(Q).replace(l._radial_gradient,function(V,T,W){O="radial";if(T&&W){K=n(T);I=n(W);var U=((I>0.5)*2-1);h(K-0.5,2)+h(I-0.5,2)>0.25&&(I=f.sqrt(0.25-h(K-0.5,2))*U+0.5)&&I!=0.5&&(I=I.toFixed(5)-0.00001*U)}return r});Q=Q.split(/\s*\-\s*/);if(O=="linear"){var J=Q.shift();J=-n(J);if(isNaN(J)){return null}var H=[0,0,f.cos(l.rad(J)),f.sin(l.rad(J))],P=1/(C(s(H[2]),s(H[3]))||1);H[2]*=P;H[3]*=P;if(H[2]<0){H[0]=-H[2];H[2]=0}if(H[3]<0){H[1]=-H[3];H[3]=0}}var N=l._parseDots(Q);if(!N){return null}E=E.replace(/[\(\)\s,\xb0#]/g,"_");if(M.gradient&&E!=M.gradient.id){D.defs.removeChild(M.gradient);delete M.gradient}if(!M.gradient){F=i(O+"Gradient",{id:E});M.gradient=F;i(F,O=="radial"?{fx:K,fy:I}:{x1:H[0],y1:H[1],x2:H[2],y2:H[3],gradientTransform:M.matrix.invert()});D.defs.appendChild(F);for(var L=0,R=N.length;L<R;L++){F.appendChild(i("stop",{offset:N[L].offset?N[L].offset:L?"100%":"0%","stop-color":N[L].color||"#fff"}))}}}i(G,{fill:"url(#"+E+")",opacity:1,"fill-opacity":1});S.fill=r;S.opacity=1;S.fillOpacity=1;return 1},b=function(E){var D=E.getBBox(1);i(E.pattern,{patternTransform:E.matrix.invert()+" translate("+D.x+","+D.y+")"})},c=function(O,Q,J){if(O.type=="path"){var D=B(Q).toLowerCase().split("-"),N=O.paper,ac=J?"end":"start",S=O.node,P=O.attrs,I=P["stroke-width"],X=D.length,G="classic",V,F,L,T,R,W=I/2,K=7,Y=7,M=5;while(X--){switch(D[X]){case"block":case"open_block":case"classic":case"oval":case"open_oval":case"diamond":case"open_diamond":case"open":case"none":G=D[X];break;case"wide":Y=10;break;case"narrow":Y=5;break;case"long":K=10;break;case"short":K=5;break}}if(G=="open"){K+=2;Y+=2;M+=2;L=1;T=J?K-2:1;R={fill:"none",stroke:P.stroke,"stroke-dasharray":0}}else{if(G=="open_block"||G=="open_diamond"||G=="open_oval"){T=L=K/2;R={fill:"white","fill-opacity":1,stroke:P.stroke,"stroke-dasharray":0}}else{T=L=K/2;R={fill:P.stroke,stroke:"none"}}}if(O._.arrows){if(J){O._.arrows.endPath&&u[O._.arrows.endPath]--;O._.arrows.endMarker&&u[O._.arrows.endMarker]--}else{O._.arrows.startPath&&u[O._.arrows.startPath]--;O._.arrows.startMarker&&u[O._.arrows.startMarker]--}}else{O._.arrows={}}if(G!="none"){var E="raphael-marker-"+G,ab="raphael-marker-"+ac+G+K+Y;if(!l._g.doc.getElementById(E)){N.defs.appendChild(i(i("path"),{"stroke-linecap":"round",d:y[G],id:E}));u[E]=1}else{u[E]++}var H=l._g.doc.getElementById(ab),U;if(!H){H=i(i("marker"),{id:ab,markerHeight:Y,markerWidth:K,orient:"auto",refX:T,refY:Y/2});U=i(i("use"),{"xlink:href":"#"+E,transform:(J?"rotate(180 "+K/2+" "+Y/2+") ":r)+"scale("+K/M+","+Y/M+")","stroke-width":(1/((K/M+Y/M)/2)).toFixed(4)});H.appendChild(U);N.defs.appendChild(H);u[ab]=1}else{u[ab]++;U=H.getElementsByTagName("use")[0]}i(U,R);var aa=L;if(J){V=O._.arrows.startdx*I||0;F=l.getTotalLength(P.path)-aa*I}else{V=aa*I;F=l.getTotalLength(P.path)-(O._.arrows.enddx*I||0)}R={};R["marker-"+ac]="url(#"+ab+")";if(F||V){R.d=Raphael.getSubpath(P.path,V,F)}i(S,R);O._.arrows[ac+"Path"]=E;O._.arrows[ac+"Marker"]=ab;O._.arrows[ac+"dx"]=aa;O._.arrows[ac+"Type"]=G;O._.arrows[ac+"String"]=Q}else{if(J){V=O._.arrows.startdx*I||0;F=l.getTotalLength(P.path)-V}else{V=0;F=l.getTotalLength(P.path)-(O._.arrows.enddx*I||0)}O._.arrows[ac+"Path"]&&i(S,{d:Raphael.getSubpath(P.path,V,F)});delete O._.arrows[ac+"Path"];delete O._.arrows[ac+"Marker"];delete O._.arrows[ac+"dx"];delete O._.arrows[ac+"Type"];delete O._.arrows[ac+"String"]}for(R in u){if(u[d](R)&&!u[R]){var Z=l._g.doc.getElementById(R);Z&&Z.parentNode.removeChild(Z)}}}},v={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},k=function(J,H,I){H=v[B(H).toLowerCase()];if(H){var F=J.attrs["stroke-width"]||"1",D={round:F,square:F,butt:0}[J.attrs["stroke-linecap"]||I["stroke-linecap"]]||0,G=[],E=H.length;while(E--){G[E]=H[E]*F+((E%2)?1:-1)*D}i(J.node,{"stroke-dasharray":G.join(",")})}},w=function(O,W){var S=O.node,P=O.attrs,M=S.style.visibility;S.style.visibility="hidden";for(var R in W){if(W[d](R)){if(!l._availableAttrs[d](R)){continue}var Q=W[R];P[R]=Q;switch(R){case"blur":O.blur(Q);break;case"href":case"title":case"target":var U=S.parentNode;if(U.tagName.toLowerCase()!="a"){var H=i("a");U.insertBefore(H,S);H.appendChild(S);U=H}if(R=="target"){U.setAttributeNS(o,"show",Q=="blank"?"new":Q)}else{U.setAttributeNS(o,R,Q)}break;case"cursor":S.style.cursor=Q;break;case"transform":O.transform(Q);break;case"arrow-start":c(O,Q);break;case"arrow-end":c(O,Q,1);break;case"clip-rect":var E=B(Q).split(g);if(E.length==4){O.clip&&O.clip.parentNode.parentNode.removeChild(O.clip.parentNode);var F=i("clipPath"),T=i("rect");F.id=l.createUUID();i(T,{x:E[0],y:E[1],width:E[2],height:E[3]});F.appendChild(T);O.paper.defs.appendChild(F);i(S,{"clip-path":"url(#"+F.id+")"});O.clip=T}if(!Q){var N=S.getAttribute("clip-path");if(N){var V=l._g.doc.getElementById(N.replace(/(^url\(#|\)$)/g,r));V&&V.parentNode.removeChild(V);i(S,{"clip-path":r});delete O.clip}}break;case"path":if(O.type=="path"){i(S,{d:Q?P.path=l._pathToAbsolute(Q):"M0,0"});O._.dirty=1;if(O._.arrows){"startString" in O._.arrows&&c(O,O._.arrows.startString);"endString" in O._.arrows&&c(O,O._.arrows.endString,1)}}break;case"width":S.setAttribute(R,Q);O._.dirty=1;if(P.fx){R="x";Q=P.x}else{break}case"x":if(P.fx){Q=-P.x-(P.width||0)}case"rx":if(R=="rx"&&O.type=="rect"){break}case"cx":S.setAttribute(R,Q);O.pattern&&b(O);O._.dirty=1;break;case"height":S.setAttribute(R,Q);O._.dirty=1;if(P.fy){R="y";Q=P.y}else{break}case"y":if(P.fy){Q=-P.y-(P.height||0)}case"ry":if(R=="ry"&&O.type=="rect"){break}case"cy":S.setAttribute(R,Q);O.pattern&&b(O);O._.dirty=1;break;case"r":if(O.type=="rect"){i(S,{rx:Q,ry:Q})}else{S.setAttribute(R,Q)}O._.dirty=1;break;case"src":if(O.type=="image"){S.setAttributeNS(o,"href",Q)}break;case"stroke-width":if(O._.sx!=1||O._.sy!=1){Q/=C(s(O._.sx),s(O._.sy))||1}if(O.paper._vbSize){Q*=O.paper._vbSize}S.setAttribute(R,Q);if(P["stroke-dasharray"]){k(O,P["stroke-dasharray"],W)}if(O._.arrows){"startString" in O._.arrows&&c(O,O._.arrows.startString);"endString" in O._.arrows&&c(O,O._.arrows.endString,1)}break;case"stroke-dasharray":k(O,Q,W);break;case"fill":var I=B(Q).match(l._ISURL);if(I){F=i("pattern");var L=i("image");F.id=l.createUUID();i(F,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});i(L,{x:0,y:0,"xlink:href":I[1]});F.appendChild(L);(function(X){l._preload(I[1],function(){var Y=this.offsetWidth,Z=this.offsetHeight;i(X,{width:Y,height:Z});i(L,{width:Y,height:Z});O.paper.safari()})})(F);O.paper.defs.appendChild(F);i(S,{fill:"url(#"+F.id+")"});O.pattern=F;O.pattern&&b(O);break}var G=l.getRGB(Q);if(!G.error){delete W.gradient;delete P.gradient;!l.is(P.opacity,"undefined")&&l.is(W.opacity,"undefined")&&i(S,{opacity:P.opacity});!l.is(P["fill-opacity"],"undefined")&&l.is(W["fill-opacity"],"undefined")&&i(S,{"fill-opacity":P["fill-opacity"]})}else{if((O.type=="circle"||O.type=="ellipse"||B(Q).charAt()!="r")&&a(O,Q)){if("opacity" in P||"fill-opacity" in P){var D=l._g.doc.getElementById(S.getAttribute("fill").replace(/^url\(#|\)$/g,r));if(D){var J=D.getElementsByTagName("stop");i(J[J.length-1],{"stop-opacity":("opacity" in P?P.opacity:1)*("fill-opacity" in P?P["fill-opacity"]:1)})}}P.gradient=Q;P.fill="none";break}}G[d]("opacity")&&i(S,{"fill-opacity":G.opacity>1?G.opacity/100:G.opacity});case"stroke":G=l.getRGB(Q);S.setAttribute(R,G.hex);R=="stroke"&&G[d]("opacity")&&i(S,{"stroke-opacity":G.opacity>1?G.opacity/100:G.opacity});if(R=="stroke"&&O._.arrows){"startString" in O._.arrows&&c(O,O._.arrows.startString);"endString" in O._.arrows&&c(O,O._.arrows.endString,1)}break;case"gradient":(O.type=="circle"||O.type=="ellipse"||B(Q).charAt()!="r")&&a(O,Q);break;case"opacity":if(P.gradient&&!P[d]("stroke-opacity")){i(S,{"stroke-opacity":Q>1?Q/100:Q})}case"fill-opacity":if(P.gradient){D=l._g.doc.getElementById(S.getAttribute("fill").replace(/^url\(#|\)$/g,r));if(D){J=D.getElementsByTagName("stop");i(J[J.length-1],{"stop-opacity":Q})}break}case"shape-rendering":S.setAttribute(R,Q);break;default:R=="font-size"&&(Q=q(Q,10)+"px");var K=R.replace(/(\-.)/g,function(X){return X.substring(1).toUpperCase()});S.style[K]=Q;O._.dirty=1;S.setAttribute(R,Q);break}}}p(O,W);S.style.visibility=M},A=1.2,p=function(D,H){if(D.type!="text"||!(H[d]("text")||H[d]("font")||H[d]("font-size")||H[d]("x")||H[d]("y"))){return}var M=D.attrs,F=D.node,O=F.firstChild?q(l._g.doc.defaultView.getComputedStyle(F.firstChild,r).getPropertyValue("font-size"),10):10;if(H[d]("text")){M.text=H.text;while(F.firstChild){F.removeChild(F.firstChild)}var G=B(H.text).split("\n"),E=[],K;for(var I=0,N=G.length;I<N;I++){K=i("tspan");I&&i(K,{dy:O*A,x:M.x});K.appendChild(l._g.doc.createTextNode(G[I]));F.appendChild(K);E[I]=K}}else{E=F.getElementsByTagName("tspan");for(I=0,N=E.length;I<N;I++){if(I){i(E[I],{dy:O*A,x:M.x})}else{i(E[0],{dy:0})}}}i(F,{x:M.x,y:M.y});D._.dirty=1;var J=D._getBBox(),L=M.y-(J.y+J.height/2);L&&l.is(L,"finite")&&i(E[0],{dy:L})},t=function(E,D){var G=0,F=0;this[0]=this.node=E;E.raphael=true;this.id=l._oid++;E.raphaelid=this.id;this.matrix=l.matrix();this.realPath=null;this.paper=D;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!D.bottom&&(D.bottom=this);this.prev=D.top;D.top&&(D.top.next=this);D.top=this;this.next=null},m=l.el;t.prototype=m;m.constructor=t;l._engine.path=function(D,G){var E=i("path");G.canvas&&G.canvas.appendChild(E);var F=new t(E,G);F.type="path";w(F,{fill:"none",stroke:"#000",path:D});return F};m.rotate=function(E,D,G){if(this.removed){return this}E=B(E).split(g);if(E.length-1){D=n(E[1]);G=n(E[2])}E=n(E[0]);(G==null)&&(D=G);if(D==null||G==null){var F=this.getBBox(1);D=F.x+F.width/2;G=F.y+F.height/2}this.transform(this._.transform.concat([["r",E,D,G]]));return this};m.scale=function(H,F,D,G){if(this.removed){return this}H=B(H).split(g);if(H.length-1){F=n(H[1]);D=n(H[2]);G=n(H[3])}H=n(H[0]);(F==null)&&(F=H);(G==null)&&(D=G);if(D==null||G==null){var E=this.getBBox(1)}D=D==null?E.x+E.width/2:D;G=G==null?E.y+E.height/2:G;this.transform(this._.transform.concat([["s",H,F,D,G]]));return this};m.translate=function(E,D){if(this.removed){return this}E=B(E).split(g);if(E.length-1){D=n(E[1])}E=n(E[0])||0;D=+D||0;this.transform(this._.transform.concat([["t",E,D]]));return this};m.transform=function(E){var F=this._;if(E==null){return F.transform}l._extractTransform(this,E);this.clip&&i(this.clip,{transform:this.matrix.invert()});this.pattern&&b(this);this.node&&i(this.node,{transform:this.matrix});if(F.sx!=1||F.sy!=1){var D=this.attrs[d]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":D})}return this};m.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};m.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};m.remove=function(){if(this.removed||!this.node.parentNode){return}var E=this.paper;E.__set__&&E.__set__.exclude(this);z.unbind("raphael.*.*."+this.id);if(this.gradient){E.defs.removeChild(this.gradient)}l._tear(this,E);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var D in this){this[D]=typeof this[D]=="function"?l._removedFactory(D):null}this.removed=true};m._getBBox=function(){if(this.node.style.display=="none"){this.show();var D=true}var F={};try{F=this.node.getBBox()}catch(E){}finally{F=F||{}}D&&this.hide();return F};m.attr=function(D,M){if(this.removed){return this}if(D==null){var J={};for(var L in this.attrs){if(this.attrs[d](L)){J[L]=this.attrs[L]}}J.gradient&&J.fill=="none"&&(J.fill=J.gradient)&&delete J.gradient;J.transform=this._.transform;return J}if(M==null&&l.is(D,"string")){if(D=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(D=="transform"){return this._.transform}var K=D.split(g),G={};for(var H=0,O=K.length;H<O;H++){D=K[H];if(D in this.attrs){G[D]=this.attrs[D]}else{if(l.is(this.paper.customAttributes[D],"function")){G[D]=this.paper.customAttributes[D].def}else{G[D]=l._availableAttrs[D]}}}return O-1?G:G[K[0]]}if(M==null&&l.is(D,"array")){G={};for(H=0,O=D.length;H<O;H++){G[D[H]]=this.attr(D[H])}return G}if(M!=null){var E={};E[D]=M}else{if(D!=null&&l.is(D,"object")){E=D}}for(var N in E){z("raphael.attr."+N+"."+this.id,this,E[N])}for(N in this.paper.customAttributes){if(this.paper.customAttributes[d](N)&&E[d](N)&&l.is(this.paper.customAttributes[N],"function")){var I=this.paper.customAttributes[N].apply(this,[].concat(E[N]));this.attrs[N]=E[N];for(var F in I){if(I[d](F)){E[F]=I[F]}}}}w(this,E);return this};m.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var D=this.paper;D.top!=this&&l._tofront(this,D);return this};m.toBack=function(){if(this.removed){return this}var E=this.node.parentNode;if(E.tagName.toLowerCase()=="a"){E.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(E.firstChild!=this.node){E.insertBefore(this.node,this.node.parentNode.firstChild)}}l._toback(this,this.paper);var D=this.paper;return this};m.appendChild=function(D){if(this.removed){return this}if(this.type!=="group"){throw new TypeError("appendChild function supports only the group type!")}var E=D.node||D[D.length-1].node;this.node.appendChild(E);return this};m.insertAfter=function(D){if(this.removed){return this}var E=D.node||D[D.length-1].node;if(E.nextSibling){E.parentNode.insertBefore(this.node,E.nextSibling)}else{E.parentNode.appendChild(this.node)}l._insertafter(this,D,this.paper);return this};m.insertBefore=function(D){if(this.removed){return this}var E=D.node||D[0].node;E.parentNode.insertBefore(this.node,E);l._insertbefore(this,D,this.paper);return this};m.blur=function(E){var D=this;if(+E!==0){var F=i("filter"),G=i("feGaussianBlur");D.attrs.blur=E;F.id=l.createUUID();i(G,{stdDeviation:+E||1.5});F.appendChild(G);D.paper.defs.appendChild(F);D._blur=F;i(D.node,{filter:"url(#"+F.id+")"})}else{if(D._blur){D._blur.parentNode.removeChild(D._blur);delete D._blur;delete D.attrs.blur}D.node.removeAttribute("filter")}};l._engine.group=function(E,D,H){var G=i("g");if(D&&H){G.setAttributeNS(null,"transform","translate("+D+", "+H+")")}E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={x:D,y:H,fill:"none",stroke:"#000"};F.type="group";i(G,F.attrs);return F};l._engine.circle=function(E,D,I,H){var G=i("circle");E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={cx:D,cy:I,r:H,fill:"none",stroke:"#000"};F.type="circle";i(G,F.attrs);return F};l._engine.rect=function(F,D,K,E,I,J){var H=i("rect");F.canvas&&F.canvas.appendChild(H);var G=new t(H,F);G.attrs={x:D,y:K,width:E,height:I,r:J||0,rx:J||0,ry:J||0,fill:"none",stroke:"#000"};G.type="rect";i(H,G.attrs);return G};l._engine.ellipse=function(E,D,J,I,H){var G=i("ellipse");E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={cx:D,cy:J,rx:I,ry:H,fill:"none",stroke:"#000"};F.type="ellipse";i(G,F.attrs);return F};l._engine.image=function(F,J,D,K,E,I){var H=i("image");i(H,{x:D,y:K,width:E,height:I,preserveAspectRatio:"none"});H.setAttributeNS(o,"href",J);F.canvas&&F.canvas.appendChild(H);var G=new t(H,F);G.attrs={x:D,y:K,width:E,height:I,src:J};G.type="image";return G};l._engine.text=function(E,D,I,H){var G=i("text");E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={x:D,y:I,"text-anchor":"middle",text:H,font:l._availableAttrs.font,stroke:"none",fill:"#000"};F.type="text";w(F,F.attrs);return F};l._engine.foreignObject=function(H,K,J,L,G,F){if((typeof L)!=="number"){F=L;L=F.offsetWidth;G=F.offsetHeight}var I;if((/msie 9/).test(navigator.userAgent.toLowerCase())||document.documentMode===9){var E=i("div");E.style.cssText=["position:absolute","left:"+(K-L/2)+"px","top:"+(J-G/2)+"px","width:"+L+"px","height:"+G+"px"].join(";")+";";H.canvas&&H.canvas.appendChild(E);I=new t(E,H);I.attrs={x:K,y:J,width:L,height:G};I.type="foreignObject";i(E,I.attrs);if(F){var D=document.createElement("div");D.innerHTML=F;I.node.appendChild(D)}}else{var E=i("foreignObject");H.canvas&&H.canvas.appendChild(E);I=new t(E,H);I.attrs={x:K,y:J,width:L,height:G};I.type="foreignObject";i(E,I.attrs);if(F){var D=document.createElement("div");D.innerHTML=F;I.node.appendChild(D)}}return I};l._engine.setSize=function(E,D){this.width=E||this.width;this.height=D||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};l._engine.create=function(){var G=l._getContainer.apply(0,arguments),E=G&&G.container,K=G.x,J=G.y,F=G.width,L=G.height;if(!E){throw new Error("SVG container not found.")}var D=i("svg"),I="overflow:hidden;",H;K=K||0;J=J||0;F=F||512;L=L||342;i(D,{height:L,version:1.1,width:F,xmlns:"http://www.w3.org/2000/svg"});if(E==1){D.style.cssText=I+"position:absolute;left:"+K+"px;top:"+J+"px";l._g.doc.body.appendChild(D);H=1}else{D.style.cssText=I+"position:relative";if(E.firstChild){E.insertBefore(D,E.firstChild)}else{E.appendChild(D)}}E=new l._Paper;E.width=F;E.height=L;E.canvas=D;E.clear();E._left=E._top=0;H&&(E.renderfix=function(){});E.renderfix();return E};l._engine.setViewBox=function(I,G,K,D,E){z("raphael.setViewBox",this,this._viewBox,[I,G,K,D,E]);var M=C(K/this.width,D/this.height),H=this.top,L=E?"meet":"xMinYMin",F,J;if(I==null){if(this._vbSize){M=1}delete this._vbSize;F="0 0 "+this.width+j+this.height}else{this._vbSize=M;F=I+j+G+j+K+j+D}i(this.canvas,{viewBox:F,preserveAspectRatio:L});while(M&&H){J="stroke-width" in H.attrs?H.attrs["stroke-width"]:1;H.attr({"stroke-width":J});H._.dirty=1;H._.dirtyT=1;H=H.prev}this._viewBox=[I,G,K,D,!!E];return this};l.prototype.renderfix=function(){var I=this.canvas,D=I.style,H;try{H=I.getScreenCTM()||I.createSVGMatrix()}catch(G){H=I.createSVGMatrix()}var F=-H.e%1,E=-H.f%1;if(F||E){if(F){this._left=(this._left+F)%1;D.left=this._left+"px"}if(E){this._top=(this._top+E)%1;D.top=this._top+"px"}}};l.prototype.clear=function(){l.eve("raphael.clear",this);var D=this.canvas;while(D.firstChild){D.removeChild(D.firstChild)}this.bottom=this.top=null;(this.desc=i("desc")).appendChild(l._g.doc.createTextNode("Created with Rapha\xebl "+l.version));D.appendChild(this.desc);D.appendChild(this.defs=i("defs"))};l.prototype.remove=function(){z("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var D in this){this[D]=typeof this[D]=="function"?l._removedFactory(D):null}};var x=l.st;for(var e in m){if(m[d](e)&&!x[d](e)){x[e]=(function(D){return function(){var E=arguments;return this.forEach(function(F){F[D].apply(F,E)})}})(e)}}}(window.Raphael);window.Raphael.vml&&function(l){var e="hasOwnProperty",F=String,n=parseFloat,h=Math,B=h.round,I=h.max,C=h.min,s=h.abs,v="fill",i=/[, ]+/,A=l.eve,w=" progid:DXImageTransform.Microsoft",k=" ",q="",D={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},j=/([clmz]),?([^clmz]*)/gi,t=/ progid:\S+Blur\([^\)]+\)/g,H=/-?[^,\s-]+/g,d="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,z={path:1,rect:1,image:1},r={circle:1,ellipse:1},f=function(S){var P=/[ahqstv]/ig,K=l._pathToAbsolute;F(S).match(P)&&(K=l._path2curve);P=/[clmz]/g;if(K==l._pathToAbsolute&&!F(S).match(P)){var O=F(S).replace(j,function(W,Y,U){var X=[],T=Y.toLowerCase()=="m",V=D[Y];U.replace(H,function(Z){if(T&&X.length==2){V+=X+D[Y=="m"?"l":"L"];X=[]}X.push(B(Z*b))});return V+X});return O}var Q=K(S),J,E;O=[];for(var M=0,R=Q.length;M<R;M++){J=Q[M];E=Q[M][0].toLowerCase();E=="z"&&(E="x");for(var L=1,N=J.length;L<N;L++){E+=B(J[L]*b)+(L!=N-1?",":q)}O.push(E)}return O.join(k)},o=function(L,K,J){var E=l.matrix();E.rotate(-L,0.5,0.5);return{dx:E.x(K,J),dy:E.y(K,J)}},p=function(R,Q,P,M,L,N){var Z=R._,T=R.matrix,E=Z.fillpos,S=R.node,O=S.style,K=1,J="",V,X=b/Q,W=b/P;O.visibility="hidden";if(!Q||!P){return}S.coordsize=s(X)+k+s(W);O.rotation=N*(Q*P<0?-1:1);if(N){var Y=o(N,M,L);M=Y.dx;L=Y.dy}Q<0&&(J+="x");P<0&&(J+=" y")&&(K=-1);O.flip=J;S.coordorigin=(M*-X)+k+(L*-W);if(E||Z.fillsize){var U=S.getElementsByTagName(v);U=U&&U[0];S.removeChild(U);if(E){Y=o(N,T.x(E[0],E[1]),T.y(E[0],E[1]));U.position=Y.dx*K+k+Y.dy*K}if(Z.fillsize){U.size=Z.fillsize[0]*s(Q)+k+Z.fillsize[1]*s(P)}S.appendChild(U)}O.visibility="visible"};l.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var c=function(E,O,J){var Q=F(O).toLowerCase().split("-"),M=J?"end":"start",K=Q.length,N="classic",P="medium",L="medium";while(K--){switch(Q[K]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":N=Q[K];break;case"open_block":N="block";break;case"open_oval":N="oval";break;case"open_diamond":N="diamond";break;case"wide":case"narrow":L=Q[K];break;case"long":case"short":P=Q[K];break}}var R=E.node.getElementsByTagName("stroke")[0];R[M+"arrow"]=N;R[M+"arrowlength"]=P;R[M+"arrowwidth"]=L},x=function(Z,aj){Z.attrs=Z.attrs||{};var ae=Z.node,an=Z.attrs,V=ae.style,R,ah=z[Z.type]&&(aj.x!=an.x||aj.y!=an.y||aj.width!=an.width||aj.height!=an.height||aj.cx!=an.cx||aj.cy!=an.cy||aj.rx!=an.rx||aj.ry!=an.ry||aj.r!=an.r),Y=r[Z.type]&&(an.cx!=aj.cx||an.cy!=aj.cy||an.r!=aj.r||an.rx!=aj.rx||an.ry!=aj.ry),aq=Z;for(var W in aj){if(aj[e](W)){an[W]=aj[W]}}if(ah){an.path=l._getPath[Z.type](Z);Z._.dirty=1}aj.href&&(ae.href=aj.href);aj.title&&(ae.title=aj.title);aj.target&&(ae.target=aj.target);aj.cursor&&(V.cursor=aj.cursor);"blur" in aj&&Z.blur(aj.blur);if(aj.path&&Z.type=="path"||ah){ae.path=f(~F(an.path).toLowerCase().indexOf("r")?l._pathToAbsolute(an.path):an.path);if(Z.type=="image"){Z._.fillpos=[an.x,an.y];Z._.fillsize=[an.width,an.height];p(Z,1,1,0,0,0)}}"transform" in aj&&Z.transform(aj.transform);if(Y){var M=+an.cx,K=+an.cy,Q=+an.rx||+an.r||0,P=+an.ry||+an.r||0;ae.path=l.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",B((M-Q)*b),B((K-P)*b),B((M+Q)*b),B((K+P)*b),B(M*b))}if("clip-rect" in aj){var J=F(aj["clip-rect"]).split(i);if(J.length==4){J[2]=+J[2]+(+J[0]);J[3]=+J[3]+(+J[1]);var X=ae.clipRect||l._g.doc.createElement("div"),ap=X.style;ap.clip=l.format("rect({1}px {2}px {3}px {0}px)",J);if(!ae.clipRect){ap.position="absolute";ap.top=0;ap.left=0;ap.width=Z.paper.width+"px";ap.height=Z.paper.height+"px";ae.parentNode.insertBefore(X,ae);X.appendChild(ae);ae.clipRect=X}}if(!aj["clip-rect"]){ae.clipRect&&(ae.clipRect.style.clip="auto")}}if(Z.textpath){var al=Z.textpath.style;aj.font&&(al.font=aj.font);aj["font-family"]&&(al.fontFamily='"'+aj["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,q)+'"');aj["font-size"]&&(al.fontSize=aj["font-size"]);aj["font-weight"]&&(al.fontWeight=aj["font-weight"]);aj["font-style"]&&(al.fontStyle=aj["font-style"])}if("arrow-start" in aj){c(aq,aj["arrow-start"])}if("arrow-end" in aj){c(aq,aj["arrow-end"],1)}if(aj.opacity!=null||aj["stroke-width"]!=null||aj.fill!=null||aj.src!=null||aj.stroke!=null||aj["stroke-width"]!=null||aj["stroke-opacity"]!=null||aj["fill-opacity"]!=null||aj["stroke-dasharray"]!=null||aj["stroke-miterlimit"]!=null||aj["stroke-linejoin"]!=null||aj["stroke-linecap"]!=null){var af=ae.getElementsByTagName(v),am=false;af=af&&af[0];!af&&(am=af=G(v));if(Z.type=="image"&&aj.src){af.src=aj.src}aj.fill&&(af.on=true);if(af.on==null||aj.fill=="none"||aj.fill===null){af.on=false}if(af.on&&aj.fill){var O=F(aj.fill).match(l._ISURL);if(O){af.parentNode==ae&&ae.removeChild(af);af.rotate=true;af.src=O[1];af.type="tile";var E=Z.getBBox(1);af.position=E.x+k+E.y;Z._.fillpos=[E.x,E.y];l._preload(O[1],function(){Z._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{af.color=l.getRGB(aj.fill).hex;af.src=q;af.type="solid";if(l.getRGB(aj.fill).error&&(aq.type in {circle:1,ellipse:1}||F(aj.fill).charAt()!="r")&&a(aq,aj.fill,af)){an.fill="none";an.gradient=aj.fill;af.rotate=false}}}if("fill-opacity" in aj||"opacity" in aj){var N=((+an["fill-opacity"]+1||2)-1)*((+an.opacity+1||2)-1)*((+l.getRGB(aj.fill).o+1||2)-1);N=C(I(N,0),1);af.opacity=N;if(af.src){af.color="none"}}ae.appendChild(af);var S=(ae.getElementsByTagName("stroke")&&ae.getElementsByTagName("stroke")[0]),ao=false;!S&&(ao=S=G("stroke"));if((aj.stroke&&aj.stroke!="none")||aj["stroke-width"]||aj["stroke-opacity"]!=null||aj["stroke-dasharray"]||aj["stroke-miterlimit"]||aj["stroke-linejoin"]||aj["stroke-linecap"]){S.on=true}(aj.stroke=="none"||aj.stroke===null||S.on==null||aj.stroke==0||aj["stroke-width"]==0)&&(S.on=false);var ad=l.getRGB(aj.stroke);S.on&&aj.stroke&&(S.color=ad.hex);N=((+an["stroke-opacity"]+1||2)-1)*((+an.opacity+1||2)-1)*((+ad.o+1||2)-1);var aa=(n(aj["stroke-width"])||1)*0.75;N=C(I(N,0),1);aj["stroke-width"]==null&&(aa=an["stroke-width"]);aj["stroke-width"]&&(S.weight=aa);aa&&aa<1&&(N*=aa)&&(S.weight=1);S.opacity=N;aj["stroke-linejoin"]&&(S.joinstyle=aj["stroke-linejoin"]||"miter");S.miterlimit=aj["stroke-miterlimit"]||8;aj["stroke-linecap"]&&(S.endcap=aj["stroke-linecap"]=="butt"?"flat":aj["stroke-linecap"]=="square"?"square":"round");if(aj["stroke-dasharray"]){var ac={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};S.dashstyle=ac[e](aj["stroke-dasharray"])?ac[aj["stroke-dasharray"]]:q}ao&&ae.appendChild(S)}if(aq.type=="text"){aq.paper.canvas.style.display=q;var ag=aq.paper.span,ab=100,L=an.font&&an.font.match(/\d+(?:\.\d*)?(?=px)/);V=ag.style;an.font&&(V.font=an.font);an["font-family"]&&(V.fontFamily=an["font-family"]);an["font-weight"]&&(V.fontWeight=an["font-weight"]);an["font-style"]&&(V.fontStyle=an["font-style"]);L=n(an["font-size"]||L&&L[0])||10;V.fontSize=L*ab+"px";aq.textpath.string&&(ag.innerHTML=F(aq.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var U=ag.getBoundingClientRect();aq.W=an.w=(U.right-U.left)/ab;aq.H=an.h=(U.bottom-U.top)/ab;aq.X=an.x;aq.Y=an.y+aq.H/2;("x" in aj||"y" in aj)&&(aq.path.v=l.format("m{0},{1}l{2},{1}",B(an.x*b),B(an.y*b),B(an.x*b)+1));var T=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var ai=0,ak=T.length;ai<ak;ai++){if(T[ai] in aj){aq._.dirty=1;break}}switch(an["text-anchor"]){case"start":aq.textpath.style["v-text-align"]="left";aq.bbx=aq.W/2;break;case"end":aq.textpath.style["v-text-align"]="right";aq.bbx=-aq.W/2;break;default:aq.textpath.style["v-text-align"]="center";aq.bbx=0;break}aq.textpath.style["v-text-kern"]=true}if("shape-rendering" in aj){}},a=function(E,R,U){E.attrs=E.attrs||{};var S=E.attrs,L=Math.pow,M,N,P="linear",Q=".5 .5";E.attrs.gradient=R;R=F(R).replace(l._radial_gradient,function(X,Y,W){P="radial";if(Y&&W){Y=n(Y);W=n(W);L(Y-0.5,2)+L(W-0.5,2)>0.25&&(W=h.sqrt(0.25-L(Y-0.5,2))*((W>0.5)*2-1)+0.5);Q=Y+k+W}return q});R=R.split(/\s*\-\s*/);if(P=="linear"){var J=R.shift();J=-n(J);if(isNaN(J)){return null}}var O=l._parseDots(R);if(!O){return null}E=E.shape||E.node;if(O.length){E.removeChild(U);U.on=true;U.method="none";U.color=O[0].color;U.color2=O[O.length-1].color;var V=[];for(var K=0,T=O.length;K<T;K++){O[K].offset&&V.push(O[K].offset+k+O[K].color)}U.colors=V.length?V.join():"0% "+U.color;if(P=="radial"){U.type="gradientTitle";U.focus="100%";U.focussize="0 0";U.focusposition=Q;U.angle=0}else{U.type="gradient";U.angle=(270-J)%360}E.appendChild(U)}return 1},u=function(J,E){this[0]=this.node=J;J.raphael=true;this.id=l._oid++;J.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=l.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var m=l.el;u.prototype=m;m.constructor=u;m.transform=function(M){if(M==null){return this._.transform}var O=this.paper._viewBoxShift,N=O?"s"+[O.scale,O.scale]+"-1-1t"+[O.dx,O.dy]:q,R;if(O){R=M=F(M).replace(/\.{3}|\u2026/g,this._.transform||q)}l._extractTransform(this,N+M);var S=this.matrix.clone(),U=this.skew,K=this.node,Q,L=~F(this.attrs.fill).indexOf("-"),E=!F(this.attrs.fill).indexOf("url(");S.translate(-0.5,-0.5);if(E||L||this.type=="image"){U.matrix="1 0 0 1";U.offset="0 0";Q=S.split();if((L&&Q.noRotation)||!Q.isSimple){K.style.filter=S.toFilter();var P=this.getBBox(),J=this.getBBox(1),V=P.x-J.x,T=P.y-J.y;K.coordorigin=(V*-b)+k+(T*-b);p(this,1,1,V,T,0)}else{K.style.filter=q;p(this,Q.scalex,Q.scaley,Q.dx,Q.dy,Q.rotate)}}else{K.style.filter=q;U.matrix=F(S);U.offset=S.offset()}R&&(this._.transform=R);return this};m.rotate=function(J,E,L){if(this.removed){return this}if(J==null){return}J=F(J).split(i);if(J.length-1){E=n(J[1]);L=n(J[2])}J=n(J[0]);(L==null)&&(E=L);if(E==null||L==null){var K=this.getBBox(1);E=K.x+K.width/2;L=K.y+K.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",J,E,L]]));return this};m.translate=function(J,E){if(this.removed){return this}J=F(J).split(i);if(J.length-1){E=n(J[1])}J=n(J[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=J;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",J,E]]));return this};m.scale=function(M,K,E,L){if(this.removed){return this}M=F(M).split(i);if(M.length-1){K=n(M[1]);E=n(M[2]);L=n(M[3]);isNaN(E)&&(E=null);isNaN(L)&&(L=null)}M=n(M[0]);(K==null)&&(K=M);(L==null)&&(E=L);if(E==null||L==null){var J=this.getBBox(1)}E=E==null?J.x+J.width/2:E;L=L==null?J.y+J.height/2:L;this.transform(this._.transform.concat([["s",M,K,E,L]]));this._.dirtyT=1;return this};m.hide=function(){!this.removed&&(this.node.style.display="none");return this};m.show=function(){!this.removed&&(this.node.style.display=q);return this};m._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};m.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);l.eve.unbind("raphael.*.*."+this.id);l._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?l._removedFactory(E):null}this.removed=true};m.attr=function(E,R){if(this.removed){return this}if(E==null){var O={};for(var Q in this.attrs){if(this.attrs[e](Q)){O[Q]=this.attrs[Q]}}O.gradient&&O.fill=="none"&&(O.fill=O.gradient)&&delete O.gradient;O.transform=this._.transform;return O}if(R==null&&l.is(E,"string")){if(E==v&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var P=E.split(i),L={};for(var M=0,T=P.length;M<T;M++){E=P[M];if(E in this.attrs){L[E]=this.attrs[E]}else{if(l.is(this.paper.customAttributes[E],"function")){L[E]=this.paper.customAttributes[E].def}else{L[E]=l._availableAttrs[E]}}}return T-1?L:L[P[0]]}if(this.attrs&&R==null&&l.is(E,"array")){L={};for(M=0,T=E.length;M<T;M++){L[E[M]]=this.attr(E[M])}return L}var J;if(R!=null){J={};J[E]=R}R==null&&l.is(E,"object")&&(J=E);for(var S in J){A("raphael.attr."+S+"."+this.id,this,J[S])}if(J){for(S in this.paper.customAttributes){if(this.paper.customAttributes[e](S)&&J[e](S)&&l.is(this.paper.customAttributes[S],"function")){var N=this.paper.customAttributes[S].apply(this,[].concat(J[S]));this.attrs[S]=J[S];for(var K in N){if(N[e](K)){J[K]=N[K]}}}}if(J.text&&this.type=="text"){this.textpath.string=J.text}x(this,J)}return this};m.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&l._tofront(this,this.paper);return this};m.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);l._toback(this,this.paper)}return this};m.appendChild=function(E){if(this.removed){return this}if(this.type!=="group"){throw new TypeError("appendChild function supports only the group type!")}var J=E.node||E[E.length-1].node;this.node.appendChild(J);return this};m.insertAfter=function(E){if(this.removed){return this}if(E.constructor==l.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}l._insertafter(this,E,this.paper);return this};m.insertBefore=function(E){if(this.removed){return this}if(E.constructor==l.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);l._insertbefore(this,E,this.paper);return this};m.blur=function(E){var J=this.node.runtimeStyle,K=J.filter;K=K.replace(t,q);if(+E!==0){this.attrs.blur=E;J.filter=K+k+w+".Blur(pixelradius="+(+E||1.5)+")";J.margin=l.format("-{0}px 0 0 -{0}px",B(+E||1.5))}else{J.filter=K;J.margin=0;delete this.attrs.blur}};l._engine.group=function(K,J,N){var L=G("group");L.coordsize=b+k+b;if(J&&N){L.coordorigin=J+" "+N}var M=new u(L,K),E={x:J,y:N,fill:"none",stroke:"#000"};x(M,E);K.canvas.appendChild(L);M.type="group";return M};l._engine.path=function(L,J){var M=G("shape");M.style.cssText=d;M.coordsize=b+k+b;M.coordorigin=J.coordorigin;var N=new u(M,J),E={fill:"none",stroke:"#000"};L&&(E.path=L);N.type="path";N.path=[];N.Path=q;x(N,E);J.canvas.appendChild(M);var K=G("skew");K.on=true;M.appendChild(K);N.skew=K;N.transform(q);return N};l._engine.rect=function(J,O,M,P,K,E){var Q=l._rectPath(O,M,P,K,E),L=J.path(Q),N=L.attrs;L.X=N.x=O;L.Y=N.y=M;L.W=N.width=P;L.H=N.height=K;N.r=E;N.path=Q;L.type="rect";return L};l._engine.ellipse=function(J,E,O,N,M){var L=J.path(),K=L.attrs;L.X=E-N;L.Y=O-M;L.W=N*2;L.H=M*2;L.type="ellipse";x(L,{cx:E,cy:O,rx:N,ry:M});return L};l._engine.circle=function(J,E,N,M){var L=J.path(),K=L.attrs;L.X=E-M;L.Y=N-M;L.W=L.H=M*2;L.type="circle";x(L,{cx:E,cy:N,r:M});return L};l._engine.image=function(J,E,P,N,Q,L){var S=l._rectPath(P,N,Q,L),M=J.path(S).attr({stroke:"none"}),O=M.attrs,K=M.node,R=K.getElementsByTagName(v)[0];O.src=E;M.X=O.x=P;M.Y=O.y=N;M.W=O.width=Q;M.H=O.height=L;O.path=S;M.type="image";R.parentNode==K&&K.removeChild(R);R.rotate=true;R.src=E;R.type="tile";M._.fillpos=[P,N];M._.fillsize=[Q,L];K.appendChild(R);p(M,1,1,0,0,0);return M};l._engine.text=function(E,O,N,P){var L=G("shape"),R=G("path"),K=G("textpath");O=O||0;N=N||0;P=P||"";R.v=l.format("m{0},{1}l{2},{1}",B(O*b),B(N*b),B(O*b)+1);R.textpathok=true;K.string=F(P);K.on=true;L.style.cssText=d;L.coordsize=b+k+b;L.coordorigin="0 0";var J=new u(L,E),M={fill:"#000",stroke:"none",font:l._availableAttrs.font,text:P};J.shape=L;J.path=R;J.textpath=K;J.type="text";J.attrs.text=F(P);J.attrs.x=O;J.attrs.y=N;J.attrs.w=1;J.attrs.h=1;x(J,M);L.appendChild(K);L.appendChild(R);E.canvas.appendChild(L);var Q=G("skew");Q.on=true;L.appendChild(Q);J.skew=Q;J.transform(q);return J};l._engine.foreignObject=function(E,P,O,Q,L,K){if((typeof Q)!=="number"){K=Q;Q=K.offsetWidth;L=K.offsetHeight}var M=G("group");M.style.cssText=["position:absolute","left:"+(P-Q/2)+"px","top:"+(O-L/2)+"px","width:"+Q+"px","height:"+L+"px"].join(";")+";";M.coordsize=b+k+b;M.coordorigin="0 0";var J=document.createElement("div");J.innerHTML=K;M.appendChild(J);var N=new u(M,E);N.type="foreignObject";N.X=N.attrs.x=P;N.Y=N.attrs.y=O;N.W=N.attrs.width=Q;N.H=N.attrs.height=L;E.canvas.appendChild(M);return N};l._engine.setSize=function(K,E){var J=this.canvas.style;this.width=K;this.height=E;K==+K&&(K+="px");E==+E&&(E+="px");J.width=K;J.height=E;J.clip="rect(0 "+K+" "+E+" 0)";if(this._viewBox){l._engine.setViewBox.apply(this,this._viewBox)}return this};l._engine.setViewBox=function(N,M,O,K,L){l.eve("raphael.setViewBox",this,this._viewBox,[N,M,O,K,L]);var E=this.width,Q=this.height,R=1/I(O/E,K/Q),P,J;if(L){P=Q/K;J=E/O;if(O*P<E){N-=(E-O*P)/2/P}if(K*J<Q){M-=(Q-K*J)/2/J}}this._viewBox=[N,M,O,K,!!L];this._viewBoxShift={dx:-N,dy:-M,scale:R};this.forEach(function(S){S.transform("...")});return this};var G;l._engine.initWin=function(K){var J=K.document;J.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!J.namespaces.rvml&&J.namespaces.add("rvml","urn:schemas-microsoft-com:vml");G=function(L){return J.createElement("<rvml:"+L+' class="rvml">')}}catch(E){G=function(L){return J.createElement("<"+L+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};l._engine.initWin(l._g.win);l._engine.create=function(){var K=l._getContainer.apply(0,arguments),E=K.container,Q=K.height,R,J=K.width,P=K.x,O=K.y;if(!E){throw new Error("VML container not found.")}var M=new l._Paper,N=M.canvas=l._g.doc.createElement("div"),L=N.style;P=P||0;O=O||0;J=J||512;Q=Q||342;M.width=J;M.height=Q;J==+J&&(J+="px");Q==+Q&&(Q+="px");M.coordsize=b*1000+k+b*1000;M.coordorigin="0 0";M.span=l._g.doc.createElement("span");M.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";N.appendChild(M.span);L.cssText=l.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",J,Q);if(E==1){l._g.doc.body.appendChild(N);L.left=P+"px";L.top=O+"px";L.position="absolute"}else{if(E.firstChild){E.insertBefore(N,E.firstChild)}else{E.appendChild(N)}}M.renderfix=function(){};return M};l.prototype.clear=function(){l.eve("raphael.clear",this);this.canvas.innerHTML=q;this.span=l._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};l.prototype.remove=function(){l.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?l._removedFactory(E):null}return true};var y=l.st;for(var g in m){if(m[e](g)&&!y[e](g)){y[g]=(function(E){return function(){var J=arguments;return this.forEach(function(K){K[E].apply(K,J)})}})(g)}}}(window.Raphael);var OG=window.OG||{};OG.common={};OG.geometry={};OG.graph={};OG.handler={};OG.layout={};OG.renderer={};OG.shape={};OG.shape.bpmn={};OG.common.Constants={CANVAS_BACKGROUND:"#f9f9f9",GEOM_TYPE:{NULL:0,POINT:1,LINE:2,POLYLINE:3,POLYGON:4,RECTANGLE:5,CIRCLE:6,ELLIPSE:7,CURVE:8,BEZIER_CURVE:9,COLLECTION:10},GEOM_NAME:["","Point","Line","PolyLine","Polygon","Rectangle","Circle","Ellipse","Curve","BezierCurve","Collection"],NUM_PRECISION:0,SCALE:1,SCALE_MIN:0.1,SCALE_MAX:10,NODE_TYPE:{ROOT:"ROOT",SHAPE:"SHAPE",ETC:"ETC"},SHAPE_TYPE:{GEOM:"GEOM",TEXT:"TEXT",HTML:"HTML",IMAGE:"IMAGE",EDGE:"EDGE",GROUP:"GROUP"},EDGE_TYPE:{STRAIGHT:"straight",PLAIN:"plain",BEZIER:"bezier"},EDGE_PADDING:20,LABEL_PADDING:5,LABEL_EDITOR_WIDTH:70,LABEL_EDITOR_HEIGHT:16,FROMTO_LABEL_OFFSET_TOP:15,LABEL_SUFFIX:"_LABEL",LABEL_EDITOR_SUFFIX:"_LABEL_EDITOR",FROM_LABEL_SUFFIX:"_FROMLABEL",TO_LABEL_SUFFIX:"_TOLABEL",DEFAULT_STYLE:{SHAPE:{cursor:"default"},GEOM:{stroke:"black",fill:"white","fill-opacity":0,"label-position":"center"},TEXT:{stroke:"none","text-anchor":"middle"},HTML:{"label-position":"bottom","text-anchor":"middle","vertical-align":"top"},IMAGE:{"label-position":"bottom","text-anchor":"middle","vertical-align":"top"},EDGE:{stroke:"black",fill:"none","fill-opacity":0,"stroke-width":1,"stroke-opacity":1,"edge-type":"plain","edge-direction":"c c","arrow-start":"none","arrow-end":"classic-wide-long","stroke-dasharray":"","label-position":"center"},EDGE_SHADOW:{stroke:"#00FF00",fill:"none","fill-opacity":0,"stroke-width":1,"stroke-opacity":1,"arrow-start":"none","arrow-end":"none","stroke-dasharray":"- "},EDGE_HIDDEN:{stroke:"white",fill:"none","fill-opacity":0,"stroke-width":5,"stroke-opacity":0},GROUP:{stroke:"none",fill:"white","fill-opacity":0,"label-position":"bottom","text-anchor":"middle","vertical-align":"top"},GUIDE_BBOX:{stroke:"#00FF00",fill:"none","stroke-dasharray":"- ","shape-rendering":"crispEdges"},GUIDE_UL:{stroke:"black",fill:"#00FF00",cursor:"nwse-resize","shape-rendering":"crispEdges"},GUIDE_UR:{stroke:"black",fill:"#00FF00",cursor:"nesw-resize","shape-rendering":"crispEdges"},GUIDE_LL:{stroke:"black",fill:"#00FF00",cursor:"nesw-resize","shape-rendering":"crispEdges"},GUIDE_LR:{stroke:"black",fill:"#00FF00",cursor:"nwse-resize","shape-rendering":"crispEdges"},GUIDE_LC:{stroke:"black",fill:"#00FF00",cursor:"ew-resize","shape-rendering":"crispEdges"},GUIDE_UC:{stroke:"black",fill:"#00FF00",cursor:"ns-resize","shape-rendering":"crispEdges"},GUIDE_RC:{stroke:"black",fill:"#00FF00",cursor:"ew-resize","shape-rendering":"crispEdges"},GUIDE_LWC:{stroke:"black",fill:"#00FF00",cursor:"ns-resize","shape-rendering":"crispEdges"},GUIDE_FROM:{stroke:"black",fill:"#00FF00",cursor:"move","shape-rendering":"crispEdges"},GUIDE_TO:{stroke:"black",fill:"#00FF00",cursor:"move","shape-rendering":"crispEdges"},GUIDE_CTL_H:{stroke:"black",fill:"#00FF00",cursor:"ew-resize","shape-rendering":"crispEdges"},GUIDE_CTL_V:{stroke:"black",fill:"#00FF00",cursor:"ns-resize","shape-rendering":"crispEdges"},GUIDE_SHADOW:{stroke:"black",fill:"none","stroke-dasharray":"- ","shape-rendering":"crispEdges"},RUBBER_BAND:{stroke:"#0000FF",opacity:0.2,fill:"#0077FF"},TERMINAL:{stroke:"#808080","stroke-width":1,fill:"r(0.5, 0.5)#FFFFFF-#808080","fill-opacity":0.5,cursor:"pointer"},TERMINAL_OVER:{stroke:"#0077FF","stroke-width":4,fill:"r(0.5, 0.5)#FFFFFF-#0077FF","fill-opacity":1,cursor:"pointer"},TERMINAL_BBOX:{stroke:"none",fill:"white","fill-opacity":0},DROP_OVER_BBOX:{stroke:"#0077FF",fill:"none",opacity:0.6,"shape-rendering":"crispEdges"},LABEL:{"font-size":12,"font-color":"black"},LABEL_EDITOR:{position:"absolute",overflow:"visible",resize:"none","text-align":"center",display:"block",padding:0},COLLAPSE:{stroke:"black",fill:"white","fill-opacity":0,cursor:"pointer","shape-rendering":"crispEdges"},COLLAPSE_BBOX:{stroke:"none",fill:"white","fill-opacity":0}},RUBBER_BAND_ID:"OG_R_BAND",GUIDE_SUFFIX:{GUIDE:"_GUIDE",BBOX:"_GUIDE_BBOX",UL:"_GUIDE_UL",UR:"_GUIDE_UR",LL:"_GUIDE_LL",LR:"_GUIDE_LR",LC:"_GUIDE_LC",UC:"_GUIDE_UC",RC:"_GUIDE_RC",LWC:"_GUIDE_LWC",FROM:"_GUIDE_FROM",TO:"_GUIDE_TO",CTL:"_GUIDE_CTL_",CTL_H:"_GUIDE_CTL_H_",CTL_V:"_GUIDE_CTL_V_"},GUIDE_RECT_SIZE:8,GUIDE_MIN_SIZE:18,COLLAPSE_SUFFIX:"_COLLAPSE",COLLAPSE_BBOX_SUFFIX:"_COLLAPSE_BBOX",COLLAPSE_SIZE:10,MOVE_SNAP_SIZE:5,DROP_OVER_BBOX_SUFFIX:"_DROP_OVER",TERMINAL_SUFFIX:{GROUP:"_TERMINAL",BOX:"_TERMINAL_BOX"},TERMINAL_TYPE:{C:"C",E:"E",W:"W",S:"S",N:"N",IN:"IN",OUT:"OUT",INOUT:"INOUT"},TERMINAL_SIZE:3,COPY_PASTE_PADDING:20,FIT_CANVAS_PADDING:20,AUTO_EXTENSIONAL:true,AUTO_EXTENSION_SIZE:100,SELECTABLE:true,DRAG_SELECTABLE:true,MOVABLE:true,MOVABLE_GEOM:true,MOVABLE_TEXT:true,MOVABLE_HTML:true,MOVABLE_IMAGE:true,MOVABLE_EDGE:true,MOVABLE_GROUP:true,RESIZABLE:true,RESIZABLE_GEOM:true,RESIZABLE_TEXT:true,RESIZABLE_HTML:true,RESIZABLE_IMAGE:true,RESIZABLE_EDGE:true,RESIZABLE_GROUP:true,CONNECTABLE:true,SELF_CONNECTABLE:true,CONNECT_CLONEABLE:true,CONNECT_REQUIRED:true,LABEL_EDITABLE:true,LABEL_EDITABLE_GEOM:true,LABEL_EDITABLE_TEXT:true,LABEL_EDITABLE_HTML:true,LABEL_EDITABLE_IMAGE:true,LABEL_EDITABLE_EDGE:true,LABEL_EDITABLE_GROUP:true,GROUP_DROPABLE:true,GROUP_COLLAPSIBLE:true,DRAG_GRIDABLE:true,ENABLE_HOTKEY:true,ENABLE_HOTKEY_DELETE:true,ENABLE_HOTKEY_CTRL_A:true,ENABLE_HOTKEY_CTRL_C:true,ENABLE_HOTKEY_CTRL_V:true,ENABLE_HOTKEY_CTRL_D:true,ENABLE_HOTKEY_CTRL_G:true,ENABLE_HOTKEY_CTRL_U:true,ENABLE_HOTKEY_ARROW:true,ENABLE_HOTKEY_SHIFT_ARROW:true,ENABLE_CONTEXTMENU:true};OG.Constants=OG.common.Constants;if(typeof KeyEvent==="undefined"){var KeyEvent={DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_SEMICOLON:59,DOM_VK_EQUALS:61,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_COMMAND:91,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_COMMA:188,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}};OG.common.Util={isEmpty:function(b,a){return b===null||b===undefined||((OG.Util.isArray(b)&&!b.length))||(!a?b==="":false)},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},isObject:function(a){return !!a&&Object.prototype.toString.call(a)==="[object Object]"},isPrimitive:function(a){return OG.Util.isString(a)||OG.Util.isNumber(a)||OG.Util.isBoolean(a)},isFunction:function(a){return Object.prototype.toString.apply(a)==="[object Function]"},isNumber:function(a){return typeof a==="number"&&isFinite(a)},isString:function(a){return typeof a==="string"},isBoolean:function(a){return typeof a==="boolean"},isElement:function(a){return !!a&&a.tagName?true:false},isDefined:function(a){return typeof a!=="undefined"},isWebKit:function(){return(/webkit/).test(navigator.userAgent.toLowerCase())},isGecko:function(){return !OG.Util.isWebKit()&&(/gecko/).test(navigator.userAgent.toLowerCase())},isOpera:function(){return(/opera/).test(navigator.userAgent.toLowerCase())},isChrome:function(){return(/\bchrome\b/).test(navigator.userAgent.toLowerCase())},isSafari:function(){return !OG.Util.isChrome()&&(/safari/).test(navigator.userAgent.toLowerCase())},isFirefox:function(){return(/firefox/).test(navigator.userAgent.toLowerCase())},isIE:function(){return !OG.Util.isOpera()&&(/msie/).test(navigator.userAgent.toLowerCase())},isIE6:function(){return OG.Util.isIE()&&(/msie 6/).test(navigator.userAgent.toLowerCase())},isIE7:function(){return OG.Util.isIE()&&((/msie 7/).test(navigator.userAgent.toLowerCase())||document.documentMode===7)},isIE8:function(){return OG.Util.isIE()&&((/msie 8/).test(navigator.userAgent.toLowerCase())||document.documentMode===8)},isIE9:function(){return OG.Util.isIE()&&((/msie 9/).test(navigator.userAgent.toLowerCase())||document.documentMode===9)},isWindows:function(){return(/windows|win32/).test(navigator.userAgent.toLowerCase())},isMac:function(){return(/macintosh|mac os x/).test(navigator.userAgent.toLowerCase())},isLinux:function(){return(/linux/).test(navigator.userAgent.toLowerCase())},trim:function(a){return a===null||a===undefined?a:a.replace(/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,"")},clone:function(g){if(g===null||g===undefined){return g}if(g.nodeType&&g.cloneNode){return g.cloneNode(true)}var e,c,b,h,d,f=Object.prototype.toString.call(g),a=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"];if(f==="[object Date]"){return new Date(g.getTime())}if(f==="[object Array]"){e=g.length;h=[];while(e--){h[e]=this.clone(g[e])}}else{if(f==="[object Object]"&&g.constructor===Object){h={};for(d in g){h[d]=this.clone(g[d])}if(a){for(c=a.length;c--;){b=a[c];h[b]=g[b]}}}}return h||g},round:function(a){return this.roundPrecision(a,OG.Constants.NUM_PRECISION)},roundPrecision:function(c,a){var b=Math.pow(10,a);return Math.round(c*b)/b},roundGrid:function(a,b){b=b||OG.Constants.MOVE_SNAP_SIZE;return OG.Util.round(a/b)*b},apply:function(d,a,c){var b;if(c){this.apply(d,c)}if(d&&a&&typeof a==="object"){for(b in a){d[b]=a[b]}}return d},extend:(function(){var b=function(d){var c;for(c in d){this[c]=d[c]}},a=Object.prototype.constructor;return function(h,e,g){if(OG.Util.isObject(e)){g=e;e=h;h=g.constructor!==a?g.constructor:function(){e.apply(this,arguments)}}var d=function(){},f,c=e.prototype;d.prototype=c;f=h.prototype=new d();f.constructor=h;h.superclass=c;if(c.constructor===a){c.constructor=e}h.override=function(i){OG.Util.override(h,i)};f.superclass=f.supr=(function(){return c}());f.override=b;OG.Util.override(h,g);h.extend=function(i){return OG.Util.extend(h,i)};return h}}()),override:function(a,c){if(c){var b=a.prototype;OG.Util.apply(b,c);if((/msie/).test(navigator.userAgent.toLowerCase())&&c.hasOwnProperty("toString")){b.toString=c.toString}}},xmlToJson:function(c){var b={},a=function(f){var e={};for(var g in f){if(f.hasOwnProperty(g)){e[g]=f[g]}}return e},d=function(g,m,r){if(g.nodeType===3){if(!g.nodeValue.match(/[\S]+/)){return}if(m["$"] instanceof Array){m["$"].push(g.nodeValue)}else{if(m["$"] instanceof Object){m["$"]=[m["$"],g.nodeValue]}else{m["$"]=g.nodeValue}}}else{if(g.nodeType===1){var f={};var s=g.nodeName;for(var n=0;g.attributes&&n<g.attributes.length;n++){var q=g.attributes[n];var e=q.nodeName;var t=q.nodeValue;if(e==="xmlns"){r["$"]=t}else{if(e.indexOf("xmlns:")===0){r[e.substr(e.indexOf(":")+1)]=t}else{f["@"+e]=t}}}for(var o in r){if(r.hasOwnProperty(o)){f["@xmlns"]=f["@xmlns"]||{};f["@xmlns"][o]=r[o]}}if(m[s] instanceof Array){m[s].push(f)}else{if(m[s] instanceof Object){m[s]=[m[s],f]}else{m[s]=f}}for(var l=0;l<g.childNodes.length;l++){d(g.childNodes[l],f,a(r))}}else{if(g.nodeType===9){for(var h=0;h<g.childNodes.length;h++){d(g.childNodes[h],m,a(r))}}}}};d(c,b,{});return b},jsonToXml:function(d){if(typeof d!=="object"){return null}var b=function(f){var e={};for(var g in f){if(f.hasOwnProperty(g)){e[g]=f[g]}}return e};var c=function(n,e,o){var m="";if(e instanceof Array){for(var k=0;k<e.length;k++){m+=c(n,e[k],b(o))}return m}else{if(typeof e==="object"){var f="<"+n;var h="";var q="";if(e["@xmlns"]){var g=e["@xmlns"];for(var l in g){if(g.hasOwnProperty(l)){if(l==="$"){if(o[l]!==g[l]){h+=' xmlns="'+g[l]+'"';o[l]=g[l]}}else{if(!o[l]||(o[l]!==g[l])){h+=" xmlns:"+l+'="'+g[l]+'"';o[l]=g[l]}}}}}for(var p in e){if(e.hasOwnProperty(p)&&p!=="@xmlns"){var j=e[p];if(p==="$"){q+=j}else{if(p.indexOf("@")===0){h+=" "+p.substring(1)+'="'+j+'"'}else{m+=c(p,j,b(o))}}}}m=q+m;return(m!=="")?f+h+">"+m+"</"+n+">":f+h+"/>"}}};for(var a in d){if(d.hasOwnProperty(a)&&a.indexOf("@")==-1){return'<?xml version="1.0" encoding="UTF-8"?>'+c(a,d[a],{})}}return null},parseXML:function(b){var a,c;if(window.ActiveXObject){a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b)}else{c=new DOMParser();a=c.parseFromString(b,"text/xml")}return a}};OG.Util=OG.common.Util;OG.common.CurveUtil={CatmullRomSpline:function(c){var b=[],e,f={},d={},a=function(g){return function(j,i){var h=c.length,k,l;if(h<2){return NaN}j=j-1;if(!i&&b[g]){i=true}if(!i){f[g]=2*c[0][g]-c[1][g];d[g]=2*c[h-1][g]-c[h-2][g];e=[f].concat(c,[d]);b[g]=[];for(k=0;k<h-1;k++){b[g][k]=[2*e[k+1][g],-e[k][g]+e[k+2][g],2*e[k][g]-5*e[k+1][g]+4*e[k+2][g]-e[k+3][g],-e[k][g]+3*e[k+1][g]-3*e[k+2][g]+e[k+3][g]]}}h+=2;if(isNaN(j)){return NaN}if(j<0){return e[1][g]}else{if(j>=h-3){return e[h-2][g]}}k=Math.floor(j);if(k===j){return e[k][g]}j-=k;l=b[g][k];return 0.5*(((l[3]*j+l[2])*j+l[1])*j+l[0])}};return{getX:a(0),getY:a(1),maxT:c.length+1}},Bezier:function(c){var a,b=function(d){return function(f,e){var i=Math.floor(f)*3,h=f,g=1-h;if(!e&&a){e=true}if(!e){a=Math.floor(c.length/3)}if(f<0){return c[0][d]}if(f>=a){return c[c.length-1][d]}if(isNaN(f)){return NaN}return g*g*(g*c[i][d]+3*h*c[i+1][d])+(3*g*c[i+2][d]+h*c[i+3][d])*h*h}};return{getX:b(0),getY:b(1),maxT:Math.floor(c.length/3)+0.01}},BSpline:function(d,a){var e,g=[],f=function(m,h){var i,l=[];for(i=0;i<m+h+1;i++){if(i<h){l[i]=0}else{if(i<=m){l[i]=i-h+1}else{l[i]=m-h+2}}}return l},c=function(v,x,h,l,w){var o,m,r,q,u,p=[];if(x[w]<=v&&v<x[w+1]){p[w]=1}else{p[w]=0}for(o=2;o<=l;o++){for(m=w-o+1;m<=w;m++){if(m<=w-o+1||m<0){r=0}else{r=p[m]}if(m>=w){q=0}else{q=p[m+1]}u=x[m+o-1]-x[m];if(u===0){p[m]=0}else{p[m]=(v-x[m])/u*r}u=x[m+o]-x[m+1];if(u!==0){p[m]+=(x[m+o]-v)/u*q}}}return p},b=function(h){return function(p,l){var i=d.length,u,o,q,r=i-1,m=a;if(r<=0){return NaN}if(r+2<=m){m=r+1}if(p<=0){return d[0][h]}if(p>=r-m+2){return d[r][h]}e=f(r,m);q=Math.floor(p)+m-1;g=c(p,e,r,m,q);u=0;for(o=q-m+1;o<=q;o++){if(o<i&&o>=0){u+=d[o][h]*g[o]}}return u}};return{getX:b(0),getY:b(1),maxT:d.length-2}}};OG.CurveUtil=OG.common.CurveUtil;OG.common.NotSupportedException=function(a){this.name="OG.NotSupportedException";this.message=a||"Not Supported!"};OG.NotSupportedException=OG.common.NotSupportedException;OG.common.NotImplementedException=function(a){this.name="OG.NotImplementedException";this.message=a||"Not Implemented!"};OG.NotImplementedException=OG.common.NotImplementedException;OG.common.ParamError=function(a){this.name="OG.ParamError";this.message=a||"Invalid Parameter Error!"};OG.ParamError=OG.common.ParamError;OG.common.HashMap=function(a){this.map=a||{}};OG.common.HashMap.prototype={put:function(a,b){this.map[a]=b},get:function(a){return this.map[a]},containsKey:function(a){return this.map.hasOwnProperty(a)},containsValue:function(a){var b;for(b in this.map){if(this.map[b]===a){return true}}return false},isEmpty:function(){return this.size()===0},clear:function(){var a;for(a in this.map){delete this.map[a]}},remove:function(a){if(this.map[a]){delete this.map[a]}},keys:function(){var a=[],b;for(b in this.map){a.push(b)}return a},values:function(){var a=[],b;for(b in this.map){a.push(this.map[b])}return a},size:function(){var a=0,b;for(b in this.map){a++}return a},toString:function(){var a=[],b;for(b in this.map){a.push("'"+b+"':'"+this.map[b]+"'")}return"{"+a.join()+"}"}};OG.common.HashMap.prototype.constructor=OG.common.HashMap;OG.HashMap=OG.common.HashMap;OG.common.JSON=new (function(){var useHasOwn=!!{}.hasOwnProperty,USE_NATIVE_JSON=false,isNative=(function(){var useNative=null;return function(){if(useNative===null){useNative=USE_NATIVE_JSON&&window.JSON&&JSON.toString()==="[object JSON]"}return useNative}}()),m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+s+'"'},encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(v===null?"null":OG.common.JSON.encode(v));b=true}}a.push("]");return a.join("")},doEncode=function(o){if(!OG.Util.isDefined(o)||o===null){return"null"}else{if(OG.Util.isArray(o)){return encodeArray(o)}else{if(OG.Util.isDate(o)){return OG.common.JSON.encodeDate(o)}else{if(OG.Util.isString(o)){return encodeString(o)}else{if(typeof o==="number"){return isFinite(o)?String(o):"null"}else{if(OG.Util.isBoolean(o)){return String(o)}else{var a=["{"],b,i,v;for(i in o){if(!o.getElementsByTagName){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(doEncode(i),":",v===null?"null":doEncode(v));b=true}}}}a.push("}");return a.join("")}}}}}}};this.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'};this.encode=(function(){var ec;return function(o){if(!ec){ec=isNative()?JSON.stringify:doEncode}return ec(o)}}());this.decode=(function(){var dc;return function(json){if(!dc){dc=isNative()?JSON.parse:doDecode}return dc(json)}}())})();OG.JSON=OG.common.JSON;OG.geometry.Style=function(c){var b={},a={};OG.Util.apply(a,c,b);OG.geometry.Style.superclass.call(this,a)};OG.geometry.Style.prototype=new OG.common.HashMap();OG.geometry.Style.superclass=OG.common.HashMap;OG.geometry.Style.prototype.constructor=OG.geometry.Style;OG.Style=OG.geometry.Style;OG.geometry.Coordinate=function(a,b){this.x=undefined;this.y=undefined;if(arguments.length===1&&a.constructor===Array){this.x=a[0];this.y=a[1]}else{if(arguments.length===2&&typeof a==="number"&&typeof b==="number"){this.x=a;this.y=b}else{if(arguments.length!==0){throw new OG.ParamError()}}}};OG.geometry.Coordinate.prototype={distance:function(c){if(c.constructor===Array){c=new OG.geometry.Coordinate(c[0],c[1])}var b=this.x-c.x,a=this.y-c.y;return OG.Util.round(Math.sqrt(Math.pow(b,2)+Math.pow(a,2)))},move:function(a,b){this.x+=a;this.y+=b;return this},rotate:function(d,b){if(b.constructor===Array){b=new OG.geometry.Coordinate(b[0],b[1])}d*=Math.PI/180;var a=this.distance(b),c=d+Math.atan2(this.y-b.y,this.x-b.x);this.x=OG.Util.round(b.x+(a*Math.cos(c)));this.y=OG.Util.round(b.y+(a*Math.sin(c)));return this},isEquals:function(a){if(a.constructor===Array){a=new OG.geometry.Coordinate(a[0],a[1])}if(a&&a instanceof OG.geometry.Coordinate){if(this.x===a.x&&this.y===a.y){return true}}return false},toString:function(){var a=[];a.push(this.x);a.push(this.y);return"["+a.join()+"]"}};OG.geometry.Coordinate.prototype.constructor=OG.geometry.Coordinate;OG.Coordinate=OG.geometry.Coordinate;OG.geometry.Envelope=function(b,c,a){this._upperLeft=null;this._width=c;this._height=a;this._upperRight=null;this._lowerLeft=null;this._lowerRight=null;this._leftCenter=null;this._leftCenter=null;this._upperCenter=null;this._rightCenter=null;this._lowerCenter=null;this._centroid=null;if(b){if(b.constructor===Array){this._upperLeft=new OG.geometry.Coordinate(b)}else{this._upperLeft=new OG.geometry.Coordinate(b.x,b.y)}}};OG.geometry.Envelope.prototype={getUpperLeft:function(){return this._upperLeft},setUpperLeft:function(a){if(a.constructor===Array){a=new OG.geometry.Coordinate(a[0],a[1])}this._upperLeft=a;this._reset()},getUpperRight:function(){if(!this._upperRight){this._upperRight=new OG.geometry.Coordinate(this._upperLeft.x+this._width,this._upperLeft.y)}return this._upperRight},getLowerRight:function(){if(!this._lowerRight){this._lowerRight=new OG.geometry.Coordinate(this._upperLeft.x+this._width,this._upperLeft.y+this._height)}return this._lowerRight},getLowerLeft:function(){if(!this._lowerLeft){this._lowerLeft=new OG.geometry.Coordinate(this._upperLeft.x,this._upperLeft.y+this._height)}return this._lowerLeft},getLeftCenter:function(){if(!this._leftCenter){this._leftCenter=new OG.geometry.Coordinate(this._upperLeft.x,OG.Util.round(this._upperLeft.y+this._height/2))}return this._leftCenter},getUpperCenter:function(){if(!this._upperCenter){this._upperCenter=new OG.geometry.Coordinate(OG.Util.round(this._upperLeft.x+this._width/2),this._upperLeft.y)}return this._upperCenter},getRightCenter:function(){if(!this._rightCenter){this._rightCenter=new OG.geometry.Coordinate(this._upperLeft.x+this._width,OG.Util.round(this._upperLeft.y+this._height/2))}return this._rightCenter},getLowerCenter:function(){if(!this._lowerCenter){this._lowerCenter=new OG.geometry.Coordinate(OG.Util.round(this._upperLeft.x+this._width/2),this._upperLeft.y+this._height)}return this._lowerCenter},getCentroid:function(){if(!this._centroid){this._centroid=new OG.geometry.Coordinate(OG.Util.round(this._upperLeft.x+this._width/2),OG.Util.round(this._upperLeft.y+this._height/2))}return this._centroid},setCentroid:function(a){if(a.constructor===Array){a=new OG.geometry.Coordinate(a[0],a[1])}this.move(a.x-this.getCentroid().x,a.y-this.getCentroid().y)},getWidth:function(){return this._width},setWidth:function(a){this._width=a;this._reset()},getHeight:function(){return this._height},setHeight:function(a){this._height=a;this._reset()},getVertices:function(){var a=[];a.push(this.getUpperLeft());a.push(this.getUpperCenter());a.push(this.getUpperRight());a.push(this.getRightCenter());a.push(this.getLowerRight());a.push(this.getLowerCenter());a.push(this.getLowerLeft());a.push(this.getLeftCenter());a.push(this.getUpperLeft());return a},isContains:function(a){if(a.constructor===Array){return a[0]>=this._upperLeft.x&&a[0]<=this.getLowerRight().x&&a[1]>=this._upperLeft.y&&a[1]<=this.getLowerRight().y}else{return a.x>=this._upperLeft.x&&a.x<=this.getLowerRight().x&&a.y>=this._upperLeft.y&&a.y<=this.getLowerRight().y}},isContainsAll:function(b){var a;for(a=0;a<b.length;a++){if(!this.isContains(b[a])){return false}}return true},move:function(a,b){this._upperLeft.move(a,b);this._reset();return this},resize:function(c,a,d,b){c=c||0;a=a||0;d=d||0;b=b||0;if(this._width+(d+b)<0||this._height+(c+a)<0){throw new OG.ParamError()}this._upperLeft.move(-1*d,-1*c);this._width+=(d+b);this._height+=(c+a);this._reset();return this},isEquals:function(a){if(a&&a instanceof OG.geometry.Envelope){if(this.getUpperLeft().isEquals(a.getUpperLeft())&&this.getWidth()===a.getWidth()&&this.getHeight()===a.getHeight()){return true}}return false},toString:function(){var a=[];a.push("upperLeft:"+this.getUpperLeft());a.push("width:"+this.getWidth());a.push("height:"+this.getHeight());a.push("upperRight:"+this.getUpperRight());a.push("lowerLeft:"+this.getLowerLeft());a.push("lowerRight:"+this.getLowerRight());a.push("leftCenter:"+this.getLeftCenter());a.push("upperCenter:"+this.getUpperCenter());a.push("rightCenter:"+this.getRightCenter());a.push("lowerCenter:"+this.getLowerCenter());a.push("centroid:"+this.getCentroid());return"{"+a.join()+"}"},_reset:function(){this._upperRight=null;this._lowerLeft=null;this._lowerRight=null;this._leftCenter=null;this._upperCenter=null;this._rightCenter=null;this._lowerCenter=null;this._centroid=null}};OG.geometry.Envelope.prototype.constructor=OG.geometry.Envelope;OG.Envelope=OG.geometry.Envelope;OG.geometry.Geometry=function(){this.TYPE=OG.Constants.GEOM_TYPE.NULL;this.IS_CLOSED=false;this.style=null;this.boundary=null};OG.geometry.Geometry.prototype={isEquals:function(a){return a&&a.toString()===this.toString()},isContains:function(a){throw new OG.NotImplementedException()},isWithin:function(a){throw new OG.NotImplementedException()},getBoundary:function(){if(this.boundary===null){var f,e,c,a,b,d,j,h=this.getVertices(),g;for(g=0;g<h.length;g++){if(g===0){f=c=h[g].x;e=a=h[g].y}f=h[g].x<f?h[g].x:f;e=h[g].y<e?h[g].y:e;c=h[g].x>c?h[g].x:c;a=h[g].y>a?h[g].y:a}b=new OG.geometry.Coordinate(f,e);d=c-f;j=a-e;this.boundary=new OG.geometry.Envelope(b,d,j)}return this.boundary},getCentroid:function(){return this.getBoundary().getCentroid()},getVertices:function(){throw new OG.NotImplementedException()},minDistance:function(c){var d=Number.MAX_VALUE,e=0,a=this.getVertices(),b;c=this.convertCoordinate(c);if(a.length===1){return c.distance(a[0])}for(b=0;b<a.length-1;b++){e=this.distanceToLine(c,[a[b],a[b+1]]);if(e<d){d=e}}return d},distance:function(a){return this.getCentroid().distance(a.getCentroid())},getLength:function(){var c=0,a=this.getVertices(),b;for(b=0;b<a.length-1;b++){c+=a[b].distance(a[b+1])}return c},move:function(a,b){throw new OG.NotImplementedException()},moveCentroid:function(b){var a=this.getCentroid();b=new OG.geometry.Coordinate(b);this.move(b.x-a.x,b.y-a.y)},resize:function(c,a,d,b){throw new OG.NotImplementedException()},resizeBox:function(d,a){var e=this.getBoundary(),c=OG.Util.round((d-e.getWidth())/2),b=OG.Util.round((a-e.getHeight())/2);this.resize(b,b,c,c);return this},rotate:function(b,a){throw new OG.NotImplementedException()},fitToBoundary:function(e){var f=this.getBoundary(),c=f.getUpperCenter().y-e.getUpperCenter().y,a=e.getLowerCenter().y-f.getLowerCenter().y,d=f.getLeftCenter().x-e.getLeftCenter().x,b=e.getRightCenter().x-f.getRightCenter().x;this.resize(c,a,d,b);return this},convertCoordinate:function(a){if(a){if(a.constructor===Array){return new OG.geometry.Coordinate(a)}else{if(a instanceof OG.geometry.Coordinate){return new OG.geometry.Coordinate(a.x,a.y)}else{throw new OG.ParamError()}}}else{return undefined}},distanceToLine:function(e,b){var a=this.convertCoordinate(b[0]),f=this.convertCoordinate(b[1]),d,c;e=this.convertCoordinate(e);if(a.isEquals(f)){return e.distance(a)}d=((e.x-a.x)*(f.x-a.x)+(e.y-a.y)*(f.y-a.y))/((f.x-a.x)*(f.x-a.x)+(f.y-a.y)*(f.y-a.y));if(d<=0){return e.distance(a)}if(d>=1){return e.distance(f)}c=((a.y-e.y)*(f.x-a.x)-(a.x-e.x)*(f.y-a.y))/((f.x-a.x)*(f.x-a.x)+(f.y-a.y)*(f.y-a.y));return OG.Util.round(Math.abs(c)*Math.sqrt(((f.x-a.x)*(f.x-a.x)+(f.y-a.y)*(f.y-a.y))))},distanceLineToLine:function(i,g){var f=this.convertCoordinate(i[0]),e=this.convertCoordinate(i[1]),d=this.convertCoordinate(g[0]),b=this.convertCoordinate(g[1]),c,k,j,h,l,a;if(f.isEquals(e)){return this.distanceToLine(f,[d,b])}if(d.isEquals(b)){return this.distanceToLine(b,[f,e])}c=(f.y-d.y)*(b.x-d.x)-(f.x-d.x)*(b.y-d.y);k=(e.x-f.x)*(b.y-d.y)-(e.y-f.y)*(b.x-d.x);j=(f.y-d.y)*(e.x-f.x)-(f.x-d.x)*(e.y-f.y);h=(e.x-f.x)*(b.y-d.y)-(e.y-f.y)*(b.x-d.x);if((k===0)||(h===0)){return Math.min(this.distanceToLine(f,[d,b]),Math.min(this.distanceToLine(e,[d,b]),Math.min(this.distanceToLine(d,[f,e]),this.distanceToLine(b,[f,e]))))}l=j/h;a=c/k;if((a<0)||(a>1)||(l<0)||(l>1)){return Math.min(this.distanceToLine(f,[d,b]),Math.min(this.distanceToLine(e,[d,b]),Math.min(this.distanceToLine(d,[f,e]),this.distanceToLine(b,[f,e]))))}return 0},intersectToLine:function(c){var d=this.getVertices(),b=[],a,f,e=function(h,i){var g;for(g=0;g<h.length;g++){if(h[g].isEquals(i)){return true}}return false};for(f=0;f<d.length-1;f++){a=this.intersectLineToLine(c,[d[f],d[f+1]]);if(a&&!e(b,a)){b.push(a)}}return b},intersectLineToLine:function(j,h){var f=this.convertCoordinate(j[0]),e=this.convertCoordinate(j[1]),d=this.convertCoordinate(h[0]),c=this.convertCoordinate(h[1]),n,g,b,l,k,i,a,m;if(f.isEquals(e)){return this.distanceToLine(f,[d,c])===0?f:undefined}if(d.isEquals(c)){return this.distanceToLine(d,[f,e])===0?d:undefined}b=(f.y-d.y)*(c.x-d.x)-(f.x-d.x)*(c.y-d.y);l=(e.x-f.x)*(c.y-d.y)-(e.y-f.y)*(c.x-d.x);k=(f.y-d.y)*(e.x-f.x)-(f.x-d.x)*(e.y-f.y);i=(e.x-f.x)*(c.y-d.y)-(e.y-f.y)*(c.x-d.x);if(l!==0&&i!==0){a=b/l;m=k/i;if(0<=a&&a<=1&&0<=m&&m<=1){g="Intersection";n=new OG.Coordinate(OG.Util.round(f.x+a*(e.x-f.x)),OG.Util.round(f.y+a*(e.y-f.y)))}else{g="No Intersection"}}else{if(b===0||k===0){g="Coincident"}else{g="Parallel"}}return n},intersectCircleToLine:function(c,j,o,p){var q=[],n=(p.x-o.x)*(p.x-o.x)+(p.y-o.y)*(p.y-o.y),m=2*((p.x-o.x)*(o.x-c.x)+(p.y-o.y)*(o.y-c.y)),i=c.x*c.x+c.y*c.y+o.x*o.x+o.y*o.y-2*(c.x*o.x+c.y*o.y)-j*j,d=m*m-4*n*i,l,h=function(e,b,a){return new OG.Coordinate(OG.Util.round(e.x+(b.x-e.x)*a),OG.Util.round(e.y+(b.y-e.y)*a))},k,g,f;if(d<0){l="Outside"}else{if(d===0){l="Tangent"}else{k=Math.sqrt(d);g=(-m+k)/(2*n);f=(-m-k)/(2*n);if((g<0||g>1)&&(f<0||f>1)){if((g<0&&f<0)||(g>1&&f>1)){l="Outside"}else{l="Inside"}}else{l="Intersection";if(0<=g&&g<=1){q.push(h(o,p,g))}if(0<=f&&f<=1){q.push(h(o,p,f))}}}}return q},reset:function(){this.boundary=null}};OG.geometry.Geometry.prototype.constructor=OG.geometry.Geometry;OG.geometry.GeometryCollection=function(a){this.TYPE=OG.Constants.GEOM_TYPE.COLLECTION;this.style=new OG.geometry.Style();this.geometries=a};OG.geometry.GeometryCollection.prototype=new OG.geometry.Geometry();OG.geometry.GeometryCollection.superclass=OG.geometry.Geometry;OG.geometry.GeometryCollection.prototype.constructor=OG.geometry.GeometryCollection;OG.GeometryCollection=OG.geometry.GeometryCollection;OG.geometry.GeometryCollection.prototype.getVertices=function(){var b=[],d,c,a;for(c=0;c<this.geometries.length;c++){d=this.geometries[c].getVertices();for(a=0;a<d.length;a++){b.push(d[a])}}return b};OG.geometry.GeometryCollection.prototype.move=function(a,c){var b;this.getBoundary().move(a,c);for(b=0;b<this.geometries.length;b++){this.geometries[b].move(a,c);this.geometries[b].reset()}return this};OG.geometry.GeometryCollection.prototype.resize=function(o,h,d,p){var c=this.getBoundary(),k=d+p,g=o+h,b=c.getWidth()+k,q=c.getHeight()+g,n=c.getWidth()===0?1:b/c.getWidth(),m=c.getHeight()===0?1:q/c.getHeight(),a=c.getUpperLeft(),l,f,e;if(b<0||q<0){throw new OG.ParamError()}for(f=0;f<this.geometries.length;f++){l=this.geometries[f].vertices;for(e=0;e<l.length;e++){l[e].x=OG.Util.round((a.x-d)+(l[e].x-a.x)*n);l[e].y=OG.Util.round((a.y-o)+(l[e].y-a.y)*m)}this.geometries[f].reset()}c.resize(o,h,d,p);return this};OG.geometry.GeometryCollection.prototype.resizeBox=function(d,a){var e=this.getBoundary(),c=OG.Util.round((d-e.getWidth())/2),b=OG.Util.round((a-e.getHeight())/2);this.resize(b,b,c,c);return this};OG.geometry.GeometryCollection.prototype.rotate=function(c,a){var b;a=a||this.getCentroid();for(b=0;b<this.geometries.length;b++){this.geometries[b].rotate(c,a);this.geometries[b].reset()}this.reset();return this};OG.geometry.GeometryCollection.prototype.fitToBoundary=function(e){var f=this.getBoundary(),c=f.getUpperCenter().y-e.getUpperCenter().y,a=e.getLowerCenter().y-f.getLowerCenter().y,d=f.getLeftCenter().x-e.getLeftCenter().x,b=e.getRightCenter().x-f.getRightCenter().x;this.resize(c,a,d,b);return this};OG.geometry.GeometryCollection.prototype.toString=function(){var b=[],a;for(a=0;a<this.geometries.length;a++){b.push(this.geometries[a].toString())}return"{type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"',geometries:["+b.join()+"]}"};OG.geometry.PolyLine=function(a){var b;this.TYPE=OG.Constants.GEOM_TYPE.POLYLINE;this.style=new OG.geometry.Style();this.vertices=[];if(a&&a.length>0){for(b=0;b<a.length;b++){this.vertices.push(this.convertCoordinate(a[b]))}}};OG.geometry.PolyLine.prototype=new OG.geometry.Geometry();OG.geometry.PolyLine.superclass=OG.geometry.Geometry;OG.geometry.PolyLine.prototype.constructor=OG.geometry.PolyLine;OG.PolyLine=OG.geometry.PolyLine;OG.geometry.PolyLine.prototype.getVertices=function(){return this.vertices};OG.geometry.PolyLine.prototype.move=function(a,c){var b;this.getBoundary().move(a,c);for(b=0;b<this.vertices.length;b++){this.vertices[b].move(a,c)}return this};OG.geometry.PolyLine.prototype.resize=function(l,g,d,m){var c=this.getBoundary(),h=d+m,f=l+g,b=c.getWidth()+h,n=c.getHeight()+f,k=c.getWidth()===0?1:b/c.getWidth(),j=c.getHeight()===0?1:n/c.getHeight(),a=c.getUpperLeft(),e;if(b<0||n<0){throw new OG.ParamError()}for(e=0;e<this.vertices.length;e++){this.vertices[e].x=OG.Util.round((a.x-d)+(this.vertices[e].x-a.x)*k);this.vertices[e].y=OG.Util.round((a.y-l)+(this.vertices[e].y-a.y)*j)}c.resize(l,g,d,m);return this};OG.geometry.PolyLine.prototype.rotate=function(c,a){var b;a=a||this.getCentroid();for(b=0;b<this.vertices.length;b++){this.vertices[b].rotate(c,a)}this.reset();return this};OG.geometry.PolyLine.prototype.toString=function(){var a=[];a.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");a.push("vertices:["+this.vertices+"]");return"{"+a.join()+"}"};OG.geometry.Curve=function(controlPoints){OG.geometry.Curve.superclass.call(this,controlPoints);var t,cmRomSpline=OG.CurveUtil.CatmullRomSpline(eval("["+this.vertices.toString()+"]"));this.vertices=[];for(t=0;t<=cmRomSpline.maxT;t+=0.1){this.vertices.push(new OG.geometry.Coordinate(OG.Util.round(cmRomSpline.getX(t)),OG.Util.round(cmRomSpline.getY(t))))}this.TYPE=OG.Constants.GEOM_TYPE.CURVE;this.style=new OG.geometry.Style()};OG.geometry.Curve.prototype=new OG.geometry.PolyLine();OG.geometry.Curve.superclass=OG.geometry.PolyLine;OG.geometry.Curve.prototype.constructor=OG.geometry.Curve;OG.Curve=OG.geometry.Curve;OG.geometry.Curve.prototype.getControlPoints=function(){var a=[],b;for(b=10;b<=this.vertices.length-10;b+=10){a.push(this.vertices[b])}return a};OG.geometry.Curve.prototype.getVertices=function(){var a=[],b;for(b=10;b<=this.vertices.length-10;b++){a.push(this.vertices[b])}return a};OG.geometry.Curve.prototype.toString=function(){var a=[];a.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");a.push("vertices:["+this.getVertices()+"]");a.push("controlPoints:["+this.getControlPoints()+"]");return"{"+a.join()+"}"};OG.geometry.Ellipse=function(a,c,b,e){var g=e||0,h=this.convertCoordinate(a),j=[],d,f;if(h){for(f=-45;f<=405;f+=45){d=Math.PI/180*f;j.push((new OG.geometry.Coordinate(OG.Util.round(h.x+c*Math.cos(d)),OG.Util.round(h.y+b*Math.sin(d)))).rotate(g,h))}}OG.geometry.Ellipse.superclass.call(this,j);this.TYPE=OG.Constants.GEOM_TYPE.ELLIPSE;this.IS_CLOSED=true;this.style=new OG.geometry.Style()};OG.geometry.Ellipse.prototype=new OG.geometry.Curve();OG.geometry.Ellipse.superclass=OG.geometry.Curve;OG.geometry.Ellipse.prototype.constructor=OG.geometry.Ellipse;OG.Ellipse=OG.geometry.Ellipse;OG.geometry.Ellipse.prototype.getVertices=function(){var a=[],b;for(b=20;b<this.vertices.length-20;b++){a.push(this.vertices[b])}return a};OG.geometry.Ellipse.prototype.getControlPoints=function(){var a=[],b;for(b=10;b<=this.vertices.length-10;b+=10){a.push(this.vertices[b])}return a};OG.geometry.Ellipse.prototype.getLength=function(){var b=this.getControlPoints(),a=this.getCentroid(),d=a.distance(b[1]),c=a.distance(b[3]);return Math.PI*(5*(d+c)/4-d*c/(d+c))};OG.geometry.Ellipse.prototype.toString=function(){var c=[],b=this.getControlPoints(),a=this.getCentroid(),f=a.distance(b[1]),d=a.distance(b[3]),e=OG.Util.round(Math.atan2(b[1].y-a.y,b[1].x-a.x)*180/Math.PI);c.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");c.push("center:"+a);c.push("radiusX:"+f);c.push("radiusY:"+d);c.push("angle:"+e);return"{"+c.join()+"}"};OG.geometry.BezierCurve=function(controlPoints){var bezier,t,i;if(!controlPoints&&controlPoints.length!==4){throw new OG.ParamError()}this.controlPoints=[];if(controlPoints&&controlPoints.length>0){for(i=0;i<controlPoints.length;i++){this.controlPoints.push(this.convertCoordinate(controlPoints[i]))}}bezier=OG.CurveUtil.Bezier(eval("["+this.controlPoints.toString()+"]"));this.vertices=[];for(t=0;t<=bezier.maxT;t+=0.02){this.vertices.push(new OG.geometry.Coordinate(OG.Util.round(bezier.getX(t)),OG.Util.round(bezier.getY(t))))}this.TYPE=OG.Constants.GEOM_TYPE.BEZIER_CURVE;this.style=new OG.geometry.Style()};OG.geometry.BezierCurve.prototype=new OG.geometry.PolyLine();OG.geometry.BezierCurve.superclass=OG.geometry.PolyLine;OG.geometry.BezierCurve.prototype.constructor=OG.geometry.BezierCurve;OG.BezierCurve=OG.geometry.BezierCurve;OG.geometry.BezierCurve.prototype.getControlPoints=function(){return this.controlPoints};OG.geometry.BezierCurve.prototype.getVertices=function(){var bezier,t,i;if(!this.vertices){bezier=OG.CurveUtil.Bezier(eval("["+this.controlPoints.toString()+"]"));this.vertices=[];for(t=0;t<=bezier.maxT;t+=0.02){this.vertices.push(new OG.geometry.Coordinate(OG.Util.round(bezier.getX(t)),OG.Util.round(bezier.getY(t))))}}return this.vertices};OG.geometry.BezierCurve.prototype.move=function(a,c){var b;for(b=0;b<this.controlPoints.length;b++){this.controlPoints[b].move(a,c)}this.reset();return this};OG.geometry.BezierCurve.prototype.resize=function(c,a,d,b){throw new OG.NotSupportedException("OG.geometry.BezierCurve.resize() Not Supported!")};OG.geometry.BezierCurve.prototype.rotate=function(c,a){var b;a=a||this.getCentroid();for(b=0;b<this.controlPoints.length;b++){this.controlPoints[b].rotate(c,a)}this.reset();return this};OG.geometry.BezierCurve.prototype.toString=function(){var a=[];a.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");a.push("vertices:["+this.getVertices()+"]");a.push("controlPoints:["+this.getControlPoints()+"]");return"{"+a.join()+"}"};OG.geometry.BezierCurve.prototype.reset=function(){this.boundary=null;this.vertices=null};OG.geometry.Circle=function(b,a){OG.geometry.Circle.superclass.call(this,b,a,a,0);this.TYPE=OG.Constants.GEOM_TYPE.CIRCLE;this.style=new OG.geometry.Style()};OG.geometry.Circle.prototype=new OG.geometry.Ellipse();OG.geometry.Circle.superclass=OG.geometry.Ellipse;OG.geometry.Circle.prototype.constructor=OG.geometry.Circle;OG.Circle=OG.geometry.Circle;OG.geometry.Circle.prototype.getLength=function(){var b=this.getControlPoints(),a=this.getCentroid(),c=a.distance(b[1]);return 2*Math.PI*c};OG.geometry.Circle.prototype.toString=function(){var c=[],b=this.getControlPoints(),a=this.getCentroid(),f=a.distance(b[1]),d=a.distance(b[3]),e=OG.Util.round(Math.atan2(b[1].y-a.y,b[1].x-a.x)*180/Math.PI);if(f===d){c.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");c.push("center:"+a);c.push("radius:"+f)}else{c.push("type:'"+OG.Constants.GEOM_NAME[OG.Constants.GEOM_TYPE.ELLIPSE]+"'");c.push("center:"+a);c.push("radiusX:"+f);c.push("radiusY:"+d);c.push("angle:"+e)}return"{"+c.join()+"}"};OG.geometry.Line=function(d,c){var b=this.convertCoordinate(d),a=this.convertCoordinate(c);OG.geometry.Line.superclass.call(this,[[b.x,b.y],[a.x,a.y]]);this.TYPE=OG.Constants.GEOM_TYPE.LINE;this.style=new OG.geometry.Style()};OG.geometry.Line.prototype=new OG.geometry.PolyLine();OG.geometry.Line.superclass=OG.geometry.PolyLine;OG.geometry.Line.prototype.constructor=OG.geometry.Line;OG.Line=OG.geometry.Line;OG.geometry.Line.prototype.toString=function(){var a=[];a.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");a.push("from:"+this.vertices[0]);a.push("to:"+this.vertices[1]);return"{"+a.join()+"}"};OG.geometry.Point=function(a){this.TYPE=OG.Constants.GEOM_TYPE.POINT;this.style=new OG.geometry.Style();this.coordinate=this.convertCoordinate(a);this.vertices=[this.coordinate]};OG.geometry.Point.prototype=new OG.geometry.Geometry();OG.geometry.Point.superclass=OG.geometry.Geometry;OG.geometry.Point.prototype.constructor=OG.geometry.Point;OG.Point=OG.geometry.Point;OG.geometry.Point.prototype.getVertices=function(){return this.vertices};OG.geometry.Point.prototype.move=function(a,b){this.getBoundary().move(a,b);this.coordinate.move(a,b);this.vertices=[this.coordinate];return this};OG.geometry.Point.prototype.moveCentroid=function(a){this.getBoundary().setUpperLeft(a);this.coordinate=new OG.geometry.Coordinate(a);this.vertices=[this.coordinate]};OG.geometry.Point.prototype.resize=function(c,a,d,b){var e=this.getBoundary();e.resize(c,a,d,b);this.coordinate=e.getCentroid();this.vertices=[this.coordinate];this.boundary=new OG.Envelope(this.coordinate,0,0);return this};OG.geometry.Point.prototype.resizeBox=function(b,a){return this};OG.geometry.Point.prototype.rotate=function(b,a){a=a||this.getCentroid();this.coordinate.rotate(b,a);this.vertices=[this.coordinate];this.reset();return this};OG.geometry.Point.prototype.fitToBoundary=function(a){this.coordinate=a.getCentroid();this.vertices=[this.coordinate];this.boundary=new OG.Envelope(this.coordinate,0,0);return this};OG.geometry.Point.prototype.toString=function(){var a=[];a.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");a.push("coordinate:"+this.coordinate);return"{"+a.join()+"}"};OG.geometry.Polygon=function(a){OG.geometry.Polygon.superclass.call(this,a);if(this.vertices.length>0&&!this.vertices[0].isEquals(this.vertices[this.vertices.length-1])){this.vertices.push(new OG.geometry.Coordinate(this.vertices[0].x,this.vertices[0].y))}this.TYPE=OG.Constants.GEOM_TYPE.POLYGON;this.IS_CLOSED=true;this.style=new OG.geometry.Style()};OG.geometry.Polygon.prototype=new OG.geometry.PolyLine();OG.geometry.Polygon.superclass=OG.geometry.PolyLine;OG.geometry.Polygon.prototype.constructor=OG.geometry.Polygon;OG.Polygon=OG.geometry.Polygon;OG.geometry.Rectangle=function(c,d,a){var b=this.convertCoordinate(c),e=this.convertCoordinate([b.x+d,b.y+a]);if(b.x>e.x||b.y>e.y){throw new OG.ParamError()}OG.geometry.Rectangle.superclass.call(this,[[b.x,b.y],[b.x+(e.x-b.x),b.y],[e.x,e.y],[b.x,b.y+(e.y-b.y)],[b.x,b.y]]);this.TYPE=OG.Constants.GEOM_TYPE.RECTANGLE;this.style=new OG.geometry.Style()};OG.geometry.Rectangle.prototype=new OG.geometry.Polygon();OG.geometry.Rectangle.superclass=OG.geometry.Polygon;OG.geometry.Rectangle.prototype.constructor=OG.geometry.Rectangle;OG.Rectangle=OG.geometry.Rectangle;OG.geometry.Rectangle.prototype.toString=function(){var a=[],b=OG.Util.round(Math.atan2(this.vertices[1].y-this.vertices[0].y,this.vertices[1].x-this.vertices[0].x)*180/Math.PI);a.push("type:'"+OG.Constants.GEOM_NAME[this.TYPE]+"'");a.push("upperLeft:"+this.vertices[0]);a.push("width:"+(this.vertices[0].distance(this.vertices[1])));a.push("height:"+(this.vertices[0].distance(this.vertices[3])));a.push("angle:"+b);return"{"+a.join()+"}"};OG.shape.IShape=function(){this.TYPE=null;this.SHAPE_ID=null;this.geom=null;this.label=null;this.isCollapsed=false};OG.shape.IShape.prototype={createTerminal:function(){if(!this.geom){return[]}var a=this.geom.getBoundary();return[new OG.Terminal(a.getCentroid(),OG.Constants.TERMINAL_TYPE.C,OG.Constants.TERMINAL_TYPE.INOUT),new OG.Terminal(a.getRightCenter(),OG.Constants.TERMINAL_TYPE.E,OG.Constants.TERMINAL_TYPE.INOUT),new OG.Terminal(a.getLeftCenter(),OG.Constants.TERMINAL_TYPE.W,OG.Constants.TERMINAL_TYPE.INOUT),new OG.Terminal(a.getLowerCenter(),OG.Constants.TERMINAL_TYPE.S,OG.Constants.TERMINAL_TYPE.INOUT),new OG.Terminal(a.getUpperCenter(),OG.Constants.TERMINAL_TYPE.N,OG.Constants.TERMINAL_TYPE.INOUT)]},createShape:function(){throw new OG.NotImplementedException("OG.shape.IShape.createShape")},clone:function(){throw new OG.NotImplementedException("OG.shape.IShape.clone")}};OG.shape.IShape.prototype.constructor=OG.shape.IShape;OG.IShape=OG.shape.IShape;OG.shape.Terminal=function(a,c,b){this.position=a;this.direction=c||OG.Constants.TERMINAL_TYPE.E;this.inout=b||OG.Constants.TERMINAL_TYPE.INOUT};OG.shape.Terminal.prototype=new OG.shape.Terminal();OG.shape.Terminal.prototype.constructor=OG.shape.Terminal;OG.Terminal=OG.shape.Terminal;OG.shape.GeomShape=function(){this.TYPE=OG.Constants.SHAPE_TYPE.GEOM};OG.shape.GeomShape.prototype=new OG.shape.IShape();OG.shape.GeomShape.superclass=OG.shape.IShape;OG.shape.GeomShape.prototype.constructor=OG.shape.GeomShape;OG.GeomShape=OG.shape.GeomShape;OG.shape.GeomShape.prototype.clone=function(){var shape=eval("new "+this.SHAPE_ID+"()");shape.label=this.label;return shape};OG.shape.TextShape=function(a){this.TYPE=OG.Constants.SHAPE_TYPE.TEXT;this.SHAPE_ID="OG.shape.TextShape";this.text=a||"Text Here";this.angle=0};OG.shape.TextShape.prototype=new OG.shape.IShape();OG.shape.TextShape.superclass=OG.shape.IShape;OG.shape.TextShape.prototype.constructor=OG.shape.TextShape;OG.TextShape=OG.shape.TextShape;OG.shape.TextShape.prototype.createShape=function(){return this.text};OG.shape.TextShape.prototype.createTerminal=function(){return[]};OG.shape.TextShape.prototype.clone=function(){var shape=eval("new "+this.SHAPE_ID+"()");shape.text=this.text;shape.angle=this.angle;return shape};OG.shape.ImageShape=function(b,a){this.TYPE=OG.Constants.SHAPE_TYPE.IMAGE;this.SHAPE_ID="OG.shape.ImageShape";this.label=a;this.image=b;this.angle=0};OG.shape.ImageShape.prototype=new OG.shape.IShape();OG.shape.ImageShape.superclass=OG.shape.IShape;OG.shape.ImageShape.prototype.constructor=OG.shape.ImageShape;OG.ImageShape=OG.shape.ImageShape;OG.shape.ImageShape.prototype.createShape=function(){return this.image};OG.shape.ImageShape.prototype.clone=function(){var shape=eval("new "+this.SHAPE_ID+"()");shape.image=this.image;shape.label=this.label;shape.angle=this.angle;return shape};OG.shape.EdgeShape=function(e,d,a,b,c){this.TYPE=OG.Constants.SHAPE_TYPE.EDGE;this.SHAPE_ID="OG.shape.EdgeShape";this.from=e;this.to=d;this.label=a;this.fromLabel=b;this.toLabel=c};OG.shape.EdgeShape.prototype=new OG.shape.IShape();OG.shape.EdgeShape.superclass=OG.shape.IShape;OG.shape.EdgeShape.prototype.constructor=OG.shape.EdgeShape;OG.EdgeShape=OG.shape.EdgeShape;OG.shape.EdgeShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.Line(this.from,this.to);return this.geom};OG.shape.EdgeShape.prototype.createTerminal=function(){return[]};OG.shape.EdgeShape.prototype.clone=function(){var shape=eval("new "+this.SHAPE_ID+"()");shape.from=this.from;shape.to=this.to;shape.fromLabel=this.fromLabel;shape.toLabel=this.toLabel;return shape};OG.shape.CircleShape=function(a){this.SHAPE_ID="OG.shape.CircleShape";this.label=a};OG.shape.CircleShape.prototype=new OG.shape.GeomShape();OG.shape.CircleShape.superclass=OG.shape.GeomShape;OG.shape.CircleShape.prototype.constructor=OG.shape.CircleShape;OG.CircleShape=OG.shape.CircleShape;OG.shape.CircleShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Circle([50,50],50);return this.geom};OG.shape.EllipseShape=function(a){this.SHAPE_ID="OG.shape.EllipseShape";this.label=a};OG.shape.EllipseShape.prototype=new OG.shape.GeomShape();OG.shape.EllipseShape.superclass=OG.shape.GeomShape;OG.shape.EllipseShape.prototype.constructor=OG.shape.EllipseShape;OG.EllipseShape=OG.shape.EllipseShape;OG.shape.EllipseShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Ellipse([50,50],50,30);return this.geom};OG.shape.GroupShape=function(a){this.TYPE=OG.Constants.SHAPE_TYPE.GROUP;this.SHAPE_ID="OG.shape.GroupShape";this.label=a};OG.shape.GroupShape.prototype=new OG.shape.IShape();OG.shape.GroupShape.superclass=OG.shape.IShape;OG.shape.GroupShape.prototype.constructor=OG.shape.GroupShape;OG.GroupShape=OG.shape.GroupShape;OG.shape.GroupShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({stroke:"none"});return this.geom};OG.shape.GroupShape.prototype.createTerminal=function(){return[]};OG.shape.GroupShape.prototype.clone=function(){var shape=eval("new "+this.SHAPE_ID+"()");shape.label=this.label;return shape};OG.shape.HorizontalLaneShape=function(a){this.SHAPE_ID="OG.shape.HorizontalLaneShape";this.label=a};OG.shape.HorizontalLaneShape.prototype=new OG.shape.GroupShape();OG.shape.HorizontalLaneShape.superclass=OG.shape.GroupShape;OG.shape.HorizontalLaneShape.prototype.constructor=OG.shape.HorizontalLaneShape;OG.HorizontalLaneShape=OG.shape.HorizontalLaneShape;OG.shape.HorizontalLaneShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({"label-direction":"vertical","vertical-align":"top"});return this.geom};OG.shape.HtmlShape=function(b,a){this.TYPE=OG.Constants.SHAPE_TYPE.HTML;this.SHAPE_ID="OG.shape.HtmlShape";this.label=a;this.html=b||"";this.angle=0};OG.shape.HtmlShape.prototype=new OG.shape.IShape();OG.shape.HtmlShape.superclass=OG.shape.IShape;OG.shape.HtmlShape.prototype.constructor=OG.shape.HtmlShape;OG.HtmlShape=OG.shape.HtmlShape;OG.shape.HtmlShape.prototype.createShape=function(){return this.html};OG.shape.HtmlShape.prototype.clone=function(){var shape=eval("new "+this.SHAPE_ID+"()");shape.html=this.html;shape.label=this.label;shape.angle=this.angle;return shape};OG.shape.RectangleShape=function(a){this.SHAPE_ID="OG.shape.RectangleShape";this.label=a};OG.shape.RectangleShape.prototype=new OG.shape.GeomShape();OG.shape.RectangleShape.superclass=OG.shape.GeomShape;OG.shape.RectangleShape.prototype.constructor=OG.shape.RectangleShape;OG.RectangleShape=OG.shape.RectangleShape;OG.shape.RectangleShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);return this.geom};OG.shape.VerticalLaneShape=function(a){this.SHAPE_ID="OG.shape.VerticalLaneShape";this.label=a};OG.shape.VerticalLaneShape.prototype=new OG.shape.GroupShape();OG.shape.VerticalLaneShape.superclass=OG.shape.GroupShape;OG.shape.VerticalLaneShape.prototype.constructor=OG.shape.VerticalLaneShape;OG.VerticalLaneShape=OG.shape.VerticalLaneShape;OG.shape.VerticalLaneShape.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({"label-direction":"horizontal","vertical-align":"top"});return this.geom};OG.shape.bpmn.A_Subprocess=function(a){this.SHAPE_ID="OG.shape.bpmn.A_Subprocess";this.label=a};OG.shape.bpmn.A_Subprocess.prototype=new OG.shape.GroupShape();OG.shape.bpmn.A_Subprocess.superclass=OG.shape.GroupShape;OG.shape.bpmn.A_Subprocess.prototype.constructor=OG.shape.bpmn.A_Subprocess;OG.A_Subprocess=OG.shape.bpmn.A_Subprocess;OG.shape.bpmn.A_Subprocess.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({stroke:"black",r:6});return this.geom};OG.shape.bpmn.A_Task=function(a){this.SHAPE_ID="OG.shape.bpmn.A_Task";this.label=a};OG.shape.bpmn.A_Task.prototype=new OG.shape.GeomShape();OG.shape.bpmn.A_Task.superclass=OG.shape.GeomShape;OG.shape.bpmn.A_Task.prototype.constructor=OG.shape.bpmn.A_Task;OG.A_Task=OG.shape.bpmn.A_Task;OG.shape.bpmn.A_Task.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({r:6});return this.geom};OG.shape.bpmn.C_Association=function(c,b,a){this.SHAPE_ID="OG.shape.bpmn.C_Association";this.label=a;this.from=c;this.to=b};OG.shape.bpmn.C_Association.prototype=new OG.shape.EdgeShape();OG.shape.bpmn.C_Association.superclass=OG.shape.EdgeShape;OG.shape.bpmn.C_Association.prototype.constructor=OG.shape.bpmn.C_Association;OG.C_Association=OG.shape.bpmn.C_Association;OG.shape.bpmn.C_Association.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.Line(this.from||[0,0],this.to||[70,0]);this.geom.style=new OG.geometry.Style({"edge-type":"straight","arrow-start":"none","arrow-end":"none","stroke-dasharray":"."});return this.geom};OG.shape.bpmn.C_Conditional=function(c,b,a){this.SHAPE_ID="OG.shape.bpmn.C_Conditional";this.label=a;this.from=c;this.to=b};OG.shape.bpmn.C_Conditional.prototype=new OG.shape.EdgeShape();OG.shape.bpmn.C_Conditional.superclass=OG.shape.EdgeShape;OG.shape.bpmn.C_Conditional.prototype.constructor=OG.shape.bpmn.C_Conditional;OG.C_Conditional=OG.shape.bpmn.C_Conditional;OG.shape.bpmn.C_Conditional.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.Line(this.from||[0,0],this.to||[70,0]);this.geom.style=new OG.geometry.Style({"edge-type":"straight","arrow-start":"open_diamond-wide-long","arrow-end":"open_block-wide-long"});return this.geom};OG.shape.bpmn.C_DataAssociation=function(c,b,a){this.SHAPE_ID="OG.shape.bpmn.C_DataAssociation";this.label=a;this.from=c;this.to=b};OG.shape.bpmn.C_DataAssociation.prototype=new OG.shape.EdgeShape();OG.shape.bpmn.C_DataAssociation.superclass=OG.shape.EdgeShape;OG.shape.bpmn.C_DataAssociation.prototype.constructor=OG.shape.bpmn.C_DataAssociation;OG.C_DataAssociation=OG.shape.bpmn.C_DataAssociation;OG.shape.bpmn.C_DataAssociation.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.Line(this.from||[0,0],this.to||[70,0]);this.geom.style=new OG.geometry.Style({"edge-type":"straight","arrow-start":"none","arrow-end":"classic-wide-long","stroke-dasharray":"."});return this.geom};OG.shape.bpmn.C_Message=function(c,b,a){this.SHAPE_ID="OG.shape.bpmn.C_Message";this.label=a;this.from=c;this.to=b};OG.shape.bpmn.C_Message.prototype=new OG.shape.EdgeShape();OG.shape.bpmn.C_Message.superclass=OG.shape.EdgeShape;OG.shape.bpmn.C_Message.prototype.constructor=OG.shape.bpmn.C_Message;OG.C_Message=OG.shape.bpmn.C_Message;OG.shape.bpmn.C_Message.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.Line(this.from||[0,0],this.to||[80,0]);this.geom.style=new OG.geometry.Style({"edge-type":"straight","arrow-start":"open_oval-wide-long","arrow-end":"open_block-wide-long","stroke-dasharray":"."});return this.geom};OG.shape.bpmn.C_Sequence=function(c,b,a){this.SHAPE_ID="OG.shape.bpmn.C_Sequence";this.label=a;this.from=c;this.to=b};OG.shape.bpmn.C_Sequence.prototype=new OG.shape.EdgeShape();OG.shape.bpmn.C_Sequence.superclass=OG.shape.EdgeShape;OG.shape.bpmn.C_Sequence.prototype.constructor=OG.shape.bpmn.C_Sequence;OG.C_Sequence=OG.shape.bpmn.C_Sequence;OG.shape.bpmn.C_Sequence.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.Line(this.from||[0,0],this.to||[80,0]);this.geom.style=new OG.geometry.Style({"edge-type":"plain","arrow-start":"none","arrow-end":"classic-wide-long"});return this.geom};OG.shape.bpmn.D_Data=function(a){this.SHAPE_ID="OG.shape.bpmn.D_Data";this.label=a};OG.shape.bpmn.D_Data.prototype=new OG.shape.GeomShape();OG.shape.bpmn.D_Data.superclass=OG.shape.GeomShape;OG.shape.bpmn.D_Data.prototype.constructor=OG.shape.bpmn.D_Data;OG.D_Data=OG.shape.bpmn.D_Data;OG.shape.bpmn.D_Data.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.PolyLine([[0,0],[0,100],[100,100],[100,20],[80,0],[0,0],[80,0],[80,20],[100,20]]);return this.geom};OG.shape.bpmn.D_Store=function(a){this.SHAPE_ID="OG.shape.bpmn.D_Store";this.label=a};OG.shape.bpmn.D_Store.prototype=new OG.shape.GeomShape();OG.shape.bpmn.D_Store.superclass=OG.shape.GeomShape;OG.shape.bpmn.D_Store.prototype.constructor=OG.shape.bpmn.D_Store;OG.D_Store=OG.shape.bpmn.D_Store;OG.shape.bpmn.D_Store.prototype.createShape=function(){var f,e,d,c,a,b=[];if(this.geom){return this.geom}f=new OG.geometry.Ellipse([50,10],50,10);e=new OG.geometry.Line([0,10],[0,90]);d=new OG.geometry.Line([100,10],[100,90]);c=new OG.geometry.Curve([[100,90],[96,94],[85,97],[50,100],[15,97],[4,94],[0,90]]);a=new OG.geometry.Rectangle([0,10],100,80);a.style=new OG.geometry.Style({stroke:"none"});b.push(f);b.push(e);b.push(d);b.push(c);b.push(a);this.geom=new OG.geometry.GeometryCollection(b);return this.geom};OG.shape.bpmn.E_End=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End";this.label=a};OG.shape.bpmn.E_End.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End.prototype.constructor=OG.shape.bpmn.E_End;OG.E_End=OG.shape.bpmn.E_End;OG.shape.bpmn.E_End.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Circle([50,50],50);this.geom.style=new OG.geometry.Style({"stroke-width":3,"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_End.prototype.createTerminal=function(){if(!this.geom){return[]}var a=this.geom.getBoundary();return[new OG.Terminal(a.getCentroid(),OG.Constants.TERMINAL_TYPE.C,OG.Constants.TERMINAL_TYPE.IN),new OG.Terminal(a.getRightCenter(),OG.Constants.TERMINAL_TYPE.E,OG.Constants.TERMINAL_TYPE.IN),new OG.Terminal(a.getLeftCenter(),OG.Constants.TERMINAL_TYPE.W,OG.Constants.TERMINAL_TYPE.IN),new OG.Terminal(a.getLowerCenter(),OG.Constants.TERMINAL_TYPE.S,OG.Constants.TERMINAL_TYPE.IN),new OG.Terminal(a.getUpperCenter(),OG.Constants.TERMINAL_TYPE.N,OG.Constants.TERMINAL_TYPE.IN)]};OG.shape.bpmn.E_End_Cancel=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End_Cancel";this.label=a};OG.shape.bpmn.E_End_Cancel.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End_Cancel.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End_Cancel.prototype.constructor=OG.shape.bpmn.E_End_Cancel;OG.E_End_Cancel=OG.shape.bpmn.E_End_Cancel;OG.shape.bpmn.E_End_Cancel.prototype.createShape=function(){var d,c,b,a=[];if(this.geom){return this.geom}d=new OG.geometry.Circle([50,50],50);d.style=new OG.geometry.Style({"stroke-width":3});c=new OG.geometry.Line([25,25],[75,75]);c.style=new OG.geometry.Style({"stroke-width":5});b=new OG.geometry.Line([25,75],[75,25]);b.style=new OG.geometry.Style({"stroke-width":5});a.push(d);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_End_Compensation=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End_Compensation";this.label=a};OG.shape.bpmn.E_End_Compensation.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End_Compensation.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End_Compensation.prototype.constructor=OG.shape.bpmn.E_End_Compensation;OG.E_End_Compensation=OG.shape.bpmn.E_End_Compensation;OG.shape.bpmn.E_End_Compensation.prototype.createShape=function(){var d,c,b,a=[];if(this.geom){return this.geom}d=new OG.geometry.Circle([50,50],50);d.style=new OG.geometry.Style({"stroke-width":3});c=new OG.geometry.Polygon([[15,50],[45,70],[45,30]]);c.style=new OG.geometry.Style({fill:"black","fill-opacity":1});b=new OG.geometry.Polygon([[45,50],[75,70],[75,30]]);b.style=new OG.geometry.Style({fill:"black","fill-opacity":1});a.push(d);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_End_Error=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End_Error";this.label=a};OG.shape.bpmn.E_End_Error.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End_Error.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End_Error.prototype.constructor=OG.shape.bpmn.E_End_Error;OG.E_End_Error=OG.shape.bpmn.E_End_Error;OG.shape.bpmn.E_End_Error.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":3});b=new OG.geometry.PolyLine([[20,75],[40,40],[60,60],[80,20]]);b.style=new OG.geometry.Style({"stroke-width":2});a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_End_Link=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End_Link";this.label=a};OG.shape.bpmn.E_End_Link.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End_Link.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End_Link.prototype.constructor=OG.shape.bpmn.E_End_Link;OG.E_End_Link=OG.shape.bpmn.E_End_Link;OG.shape.bpmn.E_End_Link.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":3});b=new OG.geometry.Polygon([[20,40],[20,60],[60,60],[60,80],[85,50],[60,20],[60,40]]);b.style=new OG.geometry.Style({fill:"black","fill-opacity":1});a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_End_Message=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End_Message";this.label=a};OG.shape.bpmn.E_End_Message.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End_Message.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End_Message.prototype.constructor=OG.shape.bpmn.E_End_Message;OG.E_End_Message=OG.shape.bpmn.E_End_Message;OG.shape.bpmn.E_End_Message.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":3});b=new OG.geometry.PolyLine([[20,30],[20,70],[80,70],[80,30],[20,30],[50,50],[80,30]]);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_End_Multiple=function(a){this.SHAPE_ID="OG.shape.bpmn.E_End_Multiple";this.label=a};OG.shape.bpmn.E_End_Multiple.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_End_Multiple.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_End_Multiple.prototype.constructor=OG.shape.bpmn.E_End_Multiple;OG.E_End_Multiple=OG.shape.bpmn.E_End_Multiple;OG.shape.bpmn.E_End_Multiple.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":3});b=new OG.geometry.Polygon([[50,15],[39,33],[20,33],[29,50],[19,67],[40,67],[50,85],[60,68],[80,68],[70,50],[79,33],[60,33]]);b.style=new OG.geometry.Style({fill:"black","fill-opacity":1});a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate";this.label=a};OG.shape.bpmn.E_Intermediate.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate.prototype.constructor=OG.shape.bpmn.E_Intermediate;OG.E_Intermediate=OG.shape.bpmn.E_Intermediate;OG.shape.bpmn.E_Intermediate.prototype.createShape=function(){var a=[];if(this.geom){return this.geom}a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Compensation=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Compensation";this.label=a};OG.shape.bpmn.E_Intermediate_Compensation.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Compensation.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Compensation.prototype.constructor=OG.shape.bpmn.E_Intermediate_Compensation;OG.E_Intermediate_Compensation=OG.shape.bpmn.E_Intermediate_Compensation;OG.shape.bpmn.E_Intermediate_Compensation.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Polygon([[15,50],[45,70],[45,30]]);b=new OG.geometry.Polygon([[45,50],[75,70],[75,30]]);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Error=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Error";this.label=a};OG.shape.bpmn.E_Intermediate_Error.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Error.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Error.prototype.constructor=OG.shape.bpmn.E_Intermediate_Error;OG.E_Intermediate_Error=OG.shape.bpmn.E_Intermediate_Error;OG.shape.bpmn.E_Intermediate_Error.prototype.createShape=function(){var b,a=[];if(this.geom){return this.geom}b=new OG.geometry.PolyLine([[20,75],[40,40],[60,60],[80,20]]);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Link=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Link";this.label=a};OG.shape.bpmn.E_Intermediate_Link.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Link.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Link.prototype.constructor=OG.shape.bpmn.E_Intermediate_Link;OG.E_Intermediate_Link=OG.shape.bpmn.E_Intermediate_Link;OG.shape.bpmn.E_Intermediate_Link.prototype.createShape=function(){var b,a=[];if(this.geom){return this.geom}b=new OG.geometry.Polygon([[20,40],[20,60],[60,60],[60,80],[85,50],[60,20],[60,40]]);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Message=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Message";this.label=a};OG.shape.bpmn.E_Intermediate_Message.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Message.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Message.prototype.constructor=OG.shape.bpmn.E_Intermediate_Message;OG.E_Intermediate_Message=OG.shape.bpmn.E_Intermediate_Message;OG.shape.bpmn.E_Intermediate_Message.prototype.createShape=function(){var b,a=[];if(this.geom){return this.geom}b=new OG.geometry.PolyLine([[20,30],[20,70],[80,70],[80,30],[20,30],[50,50],[80,30]]);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Multiple=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Multiple";this.label=a};OG.shape.bpmn.E_Intermediate_Multiple.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Multiple.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Multiple.prototype.constructor=OG.shape.bpmn.E_Intermediate_Multiple;OG.E_Intermediate_Multiple=OG.shape.bpmn.E_Intermediate_Multiple;OG.shape.bpmn.E_Intermediate_Multiple.prototype.createShape=function(){var b,a=[];if(this.geom){return this.geom}b=new OG.geometry.Polygon([[50,15],[39,33],[20,33],[29,50],[19,67],[40,67],[50,85],[60,68],[80,68],[70,50],[79,33],[60,33]]);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Rule=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Rule";this.label=a};OG.shape.bpmn.E_Intermediate_Rule.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Rule.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Rule.prototype.constructor=OG.shape.bpmn.E_Intermediate_Rule;OG.E_Intermediate_Rule=OG.shape.bpmn.E_Intermediate_Rule;OG.shape.bpmn.E_Intermediate_Rule.prototype.createShape=function(){var b,a=[];if(this.geom){return this.geom}b=new OG.geometry.Rectangle([25,20],50,60);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(b);a.push(new OG.geometry.Line([30,30],[70,30]));a.push(new OG.geometry.Line([30,45],[70,45]));a.push(new OG.geometry.Line([30,60],[70,60]));a.push(new OG.geometry.Line([30,70],[70,70]));this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Intermediate_Timer=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Intermediate_Timer";this.label=a};OG.shape.bpmn.E_Intermediate_Timer.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Intermediate_Timer.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Intermediate_Timer.prototype.constructor=OG.shape.bpmn.E_Intermediate_Timer;OG.E_Intermediate_Timer=OG.shape.bpmn.E_Intermediate_Timer;OG.shape.bpmn.E_Intermediate_Timer.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],32);b=new OG.geometry.PolyLine([[50,30],[50,50],[70,50]]);a.push(new OG.geometry.Circle([50,50],50));a.push(new OG.geometry.Circle([50,50],42));a.push(c);a.push(new OG.geometry.Line([50,18],[50,25]));a.push(new OG.geometry.Line([50,82],[50,75]));a.push(new OG.geometry.Line([18,50],[25,50]));a.push(new OG.geometry.Line([82,50],[75,50]));a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Start=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Start";this.label=a};OG.shape.bpmn.E_Start.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Start.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Start.prototype.constructor=OG.shape.bpmn.E_Start;OG.E_Start=OG.shape.bpmn.E_Start;OG.shape.bpmn.E_Start.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Circle([50,50],50);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Start.prototype.createTerminal=function(){if(!this.geom){return[]}var a=this.geom.getBoundary();return[new OG.Terminal(a.getCentroid(),OG.Constants.TERMINAL_TYPE.C,OG.Constants.TERMINAL_TYPE.OUT),new OG.Terminal(a.getRightCenter(),OG.Constants.TERMINAL_TYPE.E,OG.Constants.TERMINAL_TYPE.OUT),new OG.Terminal(a.getLeftCenter(),OG.Constants.TERMINAL_TYPE.W,OG.Constants.TERMINAL_TYPE.OUT),new OG.Terminal(a.getLowerCenter(),OG.Constants.TERMINAL_TYPE.S,OG.Constants.TERMINAL_TYPE.OUT),new OG.Terminal(a.getUpperCenter(),OG.Constants.TERMINAL_TYPE.N,OG.Constants.TERMINAL_TYPE.OUT)]};OG.shape.bpmn.E_Start_Link=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Start_Link";this.label=a};OG.shape.bpmn.E_Start_Link.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Start_Link.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Start_Link.prototype.constructor=OG.shape.bpmn.E_Start_Link;OG.E_Start_Link=OG.shape.bpmn.E_Start_Link;OG.shape.bpmn.E_Start_Link.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":1});b=new OG.geometry.Polygon([[20,40],[20,60],[60,60],[60,80],[85,50],[60,20],[60,40]]);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Start_Message=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Start_Message";this.label=a};OG.shape.bpmn.E_Start_Message.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Start_Message.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Start_Message.prototype.constructor=OG.shape.bpmn.E_Start_Message;OG.E_Start_Message=OG.shape.bpmn.E_Start_Message;OG.shape.bpmn.E_Start_Message.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);b=new OG.geometry.PolyLine([[20,30],[20,70],[80,70],[80,30],[20,30],[50,50],[80,30]]);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Start_Multiple=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Start_Multiple";this.label=a};OG.shape.bpmn.E_Start_Multiple.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Start_Multiple.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Start_Multiple.prototype.constructor=OG.shape.bpmn.E_Start_Multiple;OG.E_Start_Multiple=OG.shape.bpmn.E_Start_Multiple;OG.shape.bpmn.E_Start_Multiple.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);b=new OG.geometry.Polygon([[50,15],[39,33],[20,33],[29,50],[19,67],[40,67],[50,85],[60,68],[80,68],[70,50],[79,33],[60,33]]);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Start_Rule=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Start_Rule";this.label=a};OG.shape.bpmn.E_Start_Rule.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Start_Rule.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Start_Rule.prototype.constructor=OG.shape.bpmn.E_Start_Rule;OG.E_Start_Rule=OG.shape.bpmn.E_Start_Rule;OG.shape.bpmn.E_Start_Rule.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":1});b=new OG.geometry.Rectangle([25,20],50,60);a.push(c);a.push(b);a.push(new OG.geometry.Line([30,30],[70,30]));a.push(new OG.geometry.Line([30,45],[70,45]));a.push(new OG.geometry.Line([30,60],[70,60]));a.push(new OG.geometry.Line([30,70],[70,70]));this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Start_Timer=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Start_Timer";this.label=a};OG.shape.bpmn.E_Start_Timer.prototype=new OG.shape.GeomShape();OG.shape.bpmn.E_Start_Timer.superclass=OG.shape.GeomShape;OG.shape.bpmn.E_Start_Timer.prototype.constructor=OG.shape.bpmn.E_Start_Timer;OG.E_Start_Timer=OG.shape.bpmn.E_Start_Timer;OG.shape.bpmn.E_Start_Timer.prototype.createShape=function(){var d,c,b,a=[];if(this.geom){return this.geom}d=new OG.geometry.Circle([50,50],50);d.style=new OG.geometry.Style({"stroke-width":1});c=new OG.geometry.Circle([50,50],32);b=new OG.geometry.PolyLine([[50,30],[50,50],[70,50]]);a.push(d);a.push(c);a.push(new OG.geometry.Line([50,18],[50,25]));a.push(new OG.geometry.Line([50,82],[50,75]));a.push(new OG.geometry.Line([18,50],[25,50]));a.push(new OG.geometry.Line([82,50],[75,50]));a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.E_Terminate=function(a){this.SHAPE_ID="OG.shape.bpmn.E_Terminate";this.label=a};OG.shape.bpmn.E_Terminate.prototype=new OG.shape.bpmn.E_End();OG.shape.bpmn.E_Terminate.superclass=OG.shape.bpmn.E_End;OG.shape.bpmn.E_Terminate.prototype.constructor=OG.shape.bpmn.E_Terminate;OG.E_Terminate=OG.shape.bpmn.E_Terminate;OG.shape.bpmn.E_Terminate.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Circle([50,50],50);c.style=new OG.geometry.Style({"stroke-width":3});b=new OG.geometry.Circle([50,50],30);b.style=new OG.geometry.Style({fill:"black","fill-opacity":1});a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({"label-position":"bottom"});return this.geom};OG.shape.bpmn.G_Complex=function(a){this.SHAPE_ID="OG.shape.bpmn.G_Complex";this.label=a};OG.shape.bpmn.G_Complex.prototype=new OG.shape.GeomShape();OG.shape.bpmn.G_Complex.superclass=OG.shape.GeomShape;OG.shape.bpmn.G_Complex.prototype.constructor=OG.shape.bpmn.G_Complex;OG.G_Complex=OG.shape.bpmn.G_Complex;OG.shape.bpmn.G_Complex.prototype.createShape=function(){var f,e,d,c,a,b=[];if(this.geom){return this.geom}f=new OG.geometry.Polygon([[0,50],[50,100],[100,50],[50,0]]);e=new OG.geometry.Line([30,30],[70,70]);e.style=new OG.geometry.Style({"stroke-width":3});d=new OG.geometry.Line([30,70],[70,30]);d.style=new OG.geometry.Style({"stroke-width":3});c=new OG.geometry.Line([20,50],[80,50]);c.style=new OG.geometry.Style({"stroke-width":3});a=new OG.geometry.Line([50,20],[50,80]);a.style=new OG.geometry.Style({"stroke-width":3});b.push(f);b.push(e);b.push(d);b.push(c);b.push(a);this.geom=new OG.geometry.GeometryCollection(b);return this.geom};OG.shape.bpmn.G_Exclusive=function(a){this.SHAPE_ID="OG.shape.bpmn.G_Exclusive";this.label=a};OG.shape.bpmn.G_Exclusive.prototype=new OG.shape.GeomShape();OG.shape.bpmn.G_Exclusive.superclass=OG.shape.GeomShape;OG.shape.bpmn.G_Exclusive.prototype.constructor=OG.shape.bpmn.G_Exclusive;OG.G_Exclusive=OG.shape.bpmn.G_Exclusive;OG.shape.bpmn.G_Exclusive.prototype.createShape=function(){var d,c,b,a=[];if(this.geom){return this.geom}d=new OG.geometry.Polygon([[0,50],[50,100],[100,50],[50,0]]);c=new OG.geometry.Line([30,30],[70,70]);c.style=new OG.geometry.Style({"stroke-width":5});b=new OG.geometry.Line([30,70],[70,30]);b.style=new OG.geometry.Style({"stroke-width":5});a.push(d);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);return this.geom};OG.shape.bpmn.G_Gateway=function(a){this.SHAPE_ID="OG.shape.bpmn.G_Gateway";this.label=a};OG.shape.bpmn.G_Gateway.prototype=new OG.shape.GeomShape();OG.shape.bpmn.G_Gateway.superclass=OG.shape.GeomShape;OG.shape.bpmn.G_Gateway.prototype.constructor=OG.shape.bpmn.G_Gateway;OG.G_Gateway=OG.shape.bpmn.G_Gateway;OG.shape.bpmn.G_Gateway.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Polygon([[0,50],[50,100],[100,50],[50,0]]);return this.geom};OG.shape.bpmn.G_Inclusive=function(a){this.SHAPE_ID="OG.shape.bpmn.G_Inclusive";this.label=a};OG.shape.bpmn.G_Inclusive.prototype=new OG.shape.GeomShape();OG.shape.bpmn.G_Inclusive.superclass=OG.shape.GeomShape;OG.shape.bpmn.G_Inclusive.prototype.constructor=OG.shape.bpmn.G_Inclusive;OG.G_Inclusive=OG.shape.bpmn.G_Inclusive;OG.shape.bpmn.G_Inclusive.prototype.createShape=function(){var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Polygon([[0,50],[50,100],[100,50],[50,0]]);b=new OG.geometry.Circle([50,50],25);b.style=new OG.geometry.Style({"stroke-width":3});a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);return this.geom};OG.shape.bpmn.G_Parallel=function(a){this.SHAPE_ID="OG.shape.bpmn.G_Parallel";this.label=a};OG.shape.bpmn.G_Parallel.prototype=new OG.shape.GeomShape();OG.shape.bpmn.G_Parallel.superclass=OG.shape.GeomShape;OG.shape.bpmn.G_Parallel.prototype.constructor=OG.shape.bpmn.G_Parallel;OG.G_Parallel=OG.shape.bpmn.G_Parallel;OG.shape.bpmn.G_Parallel.prototype.createShape=function(){var d,c,b,a=[];if(this.geom){return this.geom}d=new OG.geometry.Polygon([[0,50],[50,100],[100,50],[50,0]]);c=new OG.geometry.Line([20,50],[80,50]);c.style=new OG.geometry.Style({"stroke-width":5});b=new OG.geometry.Line([50,20],[50,80]);b.style=new OG.geometry.Style({"stroke-width":5});a.push(d);a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);return this.geom};OG.shape.bpmn.M_Annotation=function(a){this.SHAPE_ID="OG.shape.bpmn.M_Annotation";this.label=a||"Annotation"};OG.shape.bpmn.M_Annotation.prototype=new OG.shape.GeomShape();OG.shape.bpmn.M_Annotation.superclass=OG.shape.GeomShape;OG.shape.bpmn.M_Annotation.prototype.constructor=OG.shape.bpmn.M_Annotation;OG.M_Annotation=OG.shape.bpmn.M_Annotation;OG.shape.bpmn.M_Annotation.prototype.createShape=function(){if(this.geom){return this.geom}var c,b,a=[];if(this.geom){return this.geom}c=new OG.geometry.Rectangle([0,0],100,100);c.style=new OG.geometry.Style({stroke:"none"});b=new OG.geometry.PolyLine([[10,0],[0,0],[0,100],[10,100]]);b.style=new OG.geometry.Style({stroke:"black"});a.push(c);a.push(b);this.geom=new OG.geometry.GeometryCollection(a);this.geom.style=new OG.geometry.Style({});return this.geom};OG.shape.bpmn.M_Group=function(a){this.SHAPE_ID="OG.shape.bpmn.M_Group";this.label=a};OG.shape.bpmn.M_Group.prototype=new OG.shape.GeomShape();OG.shape.bpmn.M_Group.superclass=OG.shape.GeomShape;OG.shape.bpmn.M_Group.prototype.constructor=OG.shape.bpmn.M_Group;OG.M_Group=OG.shape.bpmn.M_Group;OG.shape.bpmn.M_Group.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({"stroke-dasharray":"-",r:6});return this.geom};OG.shape.bpmn.M_Text=function(a){this.SHAPE_ID="OG.shape.bpmn.M_Text";this.label=a||"Text"};OG.shape.bpmn.M_Text.prototype=new OG.shape.GeomShape();OG.shape.bpmn.M_Text.superclass=OG.shape.GeomShape;OG.shape.bpmn.M_Text.prototype.constructor=OG.shape.bpmn.M_Text;OG.M_Text=OG.shape.bpmn.M_Text;OG.shape.bpmn.M_Text.prototype.createShape=function(){if(this.geom){return this.geom}this.geom=new OG.geometry.Rectangle([0,0],100,100);this.geom.style=new OG.geometry.Style({stroke:"none"});return this.geom};OG.renderer.IRenderer=function(){this.drawShape=function(a,b,c,d,e){throw new OG.NotImplementedException()};this.drawGeom=function(b,a,c){throw new OG.NotImplementedException()};this.drawText=function(a,d,b,c,e){throw new OG.NotImplementedException()};this.drawImage=function(a,d,b,c,e){throw new OG.NotImplementedException()};this.drawEdge=function(a,c,d,b){throw new OG.NotImplementedException()};this.drawLabel=function(a,c,b){throw new OG.NotImplementedException()};this.drawEdgeLabel=function(a,c,b){throw new OG.NotImplementedException()};this.redrawShape=function(a,b){throw new OG.NotImplementedException()};this.redrawEdge=function(a){throw new OG.NotImplementedException()};this.redrawConnectedEdge=function(a,b){throw new OG.NotImplementedException()};this.connect=function(e,d,c,b,a){throw new OG.NotImplementedException()};this.disconnect=function(a){throw new OG.NotImplementedException()};this.drawDropOverGuide=function(a){throw new OG.NotImplementedException()};this.drawGuide=function(a){throw new OG.NotImplementedException()};this.removeGuide=function(a){throw new OG.NotImplementedException()};this.removeAllGuide=function(){throw new OG.NotImplementedException()};this.drawEdgeGuide=function(a){throw new OG.NotImplementedException()};this.drawRubberBand=function(a,b,c){throw new OG.NotImplementedException()};this.removeRubberBand=function(a){throw new OG.NotImplementedException()};this.drawTerminal=function(a,b){throw new OG.NotImplementedException()};this.removeTerminal=function(a){throw new OG.NotImplementedException()};this.removeAllTerminal=function(){throw new OG.NotImplementedException()};this.drawCollapseGuide=function(a){throw new OG.NotImplementedException()};this.removeCollapseGuide=function(a){throw new OG.NotImplementedException()};this.group=function(a){throw new OG.NotImplementedException()};this.ungroup=function(a){throw new OG.NotImplementedException()};this.addToGroup=function(a,b){throw new OG.NotImplementedException()};this.collapse=function(a){throw new OG.NotImplementedException()};this.expand=function(a){throw new OG.NotImplementedException()};this.clear=function(){throw new OG.NotImplementedException()};this.removeShape=function(a){throw new OG.NotImplementedException()};this.remove=function(a){throw new OG.NotImplementedException()};this.removeChild=function(a){throw new OG.NotImplementedException()};this.getRootElement=function(){throw new OG.NotImplementedException()};this.getRootGroup=function(){throw new OG.NotImplementedException()};this.getElementByPoint=function(a){throw new OG.NotImplementedException()};this.getElementsByBBox=function(a){throw new OG.NotImplementedException()};this.setAttr=function(a,b){throw new OG.NotImplementedException()};this.getAttr=function(b,a){throw new OG.NotImplementedException()};this.setShapeStyle=function(a,b){throw new OG.NotImplementedException()};this.toFront=function(a){throw new OG.NotImplementedException()};this.toBack=function(a){throw new OG.NotImplementedException()};this.getCanvasSize=function(){throw new OG.NotImplementedException()};this.setCanvasSize=function(a){throw new OG.NotImplementedException()};this.fitCanvasSize=function(b,a){throw new OG.NotImplementedException()};this.setViewBox=function(a,b,c){throw new OG.NotImplementedException()};this.getScale=function(a){throw new OG.NotImplementedException()};this.setScale=function(a){throw new OG.NotImplementedException()};this.show=function(a){throw new OG.NotImplementedException()};this.hide=function(a){throw new OG.NotImplementedException()};this.appendChild=function(a,b){throw new OG.NotImplementedException()};this.insertAfter=function(a,b){throw new OG.NotImplementedException()};this.insertBefore=function(a,b){throw new OG.NotImplementedException()};this.move=function(a,b){throw new OG.NotImplementedException()};this.moveCentroid=function(b,a){throw new OG.NotImplementedException()};this.rotate=function(a,b){throw new OG.NotImplementedException()};this.resize=function(a,b){throw new OG.NotImplementedException()};this.resizeBox=function(b,a){throw new OG.NotImplementedException()};this.intersectionEdge=function(b,c,e,d,a){throw new OG.NotImplementedException()};this.clone=function(a){throw new OG.NotImplementedException()};this.getElementById=function(a){throw new OG.NotImplementedException()};this.getElementsByType=function(b,a){throw new OG.NotImplementedException()};this.getBBox=function(a){throw new OG.NotImplementedException()};this.getRootBBox=function(){throw new OG.NotImplementedException()};this.getRealRootBBox=function(){throw new OG.NotImplementedException()};this.getContainer=function(){throw new OG.NotImplementedException()};this.isSVG=function(){throw new OG.NotImplementedException()};this.isVML=function(){throw new OG.NotImplementedException()};this.getPrevEdges=function(a){throw new OG.NotImplementedException()};this.getNextEdges=function(a){throw new OG.NotImplementedException()};this.getPrevShapes=function(a){throw new OG.NotImplementedException()};this.getPrevShapeIds=function(a){throw new OG.NotImplementedException()};this.getNextShapes=function(a){throw new OG.NotImplementedException()};this.getNextShapeIds=function(a){throw new OG.NotImplementedException()}};OG.renderer.IRenderer.prototype=new OG.renderer.IRenderer();OG.renderer.IRenderer.prototype.constructor=OG.renderer.IRenderer;OG.renderer.RaphaelRenderer=function(n,s,g,a){var q=new Raphael(n,s?s[0]:null,s?s[1]:null),o=Math.round(Math.random()*10000),j=0,u=new OG.HashMap(),k,f,v=this,d=g||OG.Constants.CANVAS_BACKGROUND,c,p,w,h,x,e,r,t,m,b,i,l;c=function(){var y="OG_"+o+"_"+j;j++;return y};p=function(z,B,y,A){z.id=B||c();z.node.id=z.id;z.node.raphaelid=z.id;if(y){$(z.node).attr("_type",y)}if(A){$(z.node).attr("_shape",A)}u.put(z.id,z);return z};w=function(y){var A,z;if(y){A=y.node.childNodes;for(z=A.length-1;z>=0;z--){w(x(A[z].id))}u.remove(y.id);y.remove()}};h=function(y){var A,z;if(y){A=y.node.childNodes;for(z=A.length-1;z>=0;z--){w(x(A[z].id))}}};x=function(y){return u.get(y)};e=function(E,G,y,H){var B=0,I="",F,C,z,A={},D=function(R,O){var N,M,K,J,L,P=[],Q=function(V,U,T){var S=Math.PI/180*T;return new OG.geometry.Coordinate(OG.Util.round(V.x+U*Math.cos(S)),OG.Util.round(V.y+U*Math.sin(S)))};N=OG.JSON.decode(R.toString());M=R.getVertices();L=N.angle;K=Q(M[0],O,90+L);J=Q(M[0],O,L);P=P.concat(["M",K.x,K.y,"Q",M[0].x,M[0].y,J.x,J.y]);K=Q(M[1],O,180+L);J=Q(M[1],O,90+L);P=P.concat(["L",K.x,K.y,"Q",M[1].x,M[1].y,J.x,J.y]);K=Q(M[2],O,270+L);J=Q(M[2],O,180+L);P=P.concat(["L",K.x,K.y,"Q",M[2].x,M[2].y,J.x,J.y]);K=Q(M[3],O,L);J=Q(M[3],O,270+L);P=P.concat(["L",K.x,K.y,"Q",M[3].x,M[3].y,J.x,J.y,"Z"]);return P.toString()};if(H){OG.Util.apply(A,(y instanceof OG.geometry.Style)?y.map:y||{},OG.Util.apply({},G.style.map,OG.Util.apply({},H,OG.Constants.DEFAULT_STYLE.GEOM)))}else{OG.Util.apply(A,(y instanceof OG.geometry.Style)?y.map:y||{},OG.Util.apply({},G.style.map,OG.Constants.DEFAULT_STYLE.GEOM))}G.style.map=A;switch(G.TYPE){case OG.Constants.GEOM_TYPE.POINT:C=q.circle(G.coordinate.x,G.coordinate.y,0.5);C.attr(A);break;case OG.Constants.GEOM_TYPE.LINE:case OG.Constants.GEOM_TYPE.POLYLINE:case OG.Constants.GEOM_TYPE.POLYGON:I="";F=G.getVertices();for(B=0;B<F.length;B++){if(B===0){I="M"+F[B].x+" "+F[B].y}else{I+="L"+F[B].x+" "+F[B].y}}C=q.path(I);C.attr(A);break;case OG.Constants.GEOM_TYPE.RECTANGLE:if((A.r||0)===0){I="";F=G.getVertices();for(B=0;B<F.length;B++){if(B===0){I="M"+F[B].x+" "+F[B].y}else{I+="L"+F[B].x+" "+F[B].y}}}else{I=D(G,A.r||0)}C=q.path(I);C.attr(A);break;case OG.Constants.GEOM_TYPE.CIRCLE:z=OG.JSON.decode(G.toString());if(z.type===OG.Constants.GEOM_NAME[OG.Constants.GEOM_TYPE.CIRCLE]){C=q.circle(z.center[0],z.center[1],z.radius)}else{if(z.type===OG.Constants.GEOM_NAME[OG.Constants.GEOM_TYPE.ELLIPSE]){if(z.angle===0){C=q.ellipse(z.center[0],z.center[1],z.radiusX,z.radiusY)}else{I="";F=G.getControlPoints();I="M"+F[1].x+" "+F[1].y+"A"+z.radiusX+" "+z.radiusY+" "+z.angle+" 1 0 "+F[5].x+" "+F[5].y;I+="M"+F[1].x+" "+F[1].y+"A"+z.radiusX+" "+z.radiusY+" "+z.angle+" 1 1 "+F[5].x+" "+F[5].y;C=q.path(I)}}}C.attr(A);break;case OG.Constants.GEOM_TYPE.ELLIPSE:z=OG.JSON.decode(G.toString());if(z.angle===0){C=q.ellipse(z.center[0],z.center[1],z.radiusX,z.radiusY)}else{I="";F=G.getControlPoints();I="M"+F[1].x+" "+F[1].y+"A"+z.radiusX+" "+z.radiusY+" "+z.angle+" 1 0 "+F[5].x+" "+F[5].y;I+="M"+F[1].x+" "+F[1].y+"A"+z.radiusX+" "+z.radiusY+" "+z.angle+" 1 1 "+F[5].x+" "+F[5].y;C=q.path(I)}C.attr(A);break;case OG.Constants.GEOM_TYPE.CURVE:I="";F=G.getControlPoints();for(B=0;B<F.length;B++){if(B===0){I="M"+F[B].x+" "+F[B].y}else{if(B===1){I+="R"+F[B].x+" "+F[B].y}else{I+=" "+F[B].x+" "+F[B].y}}}C=q.path(I);C.attr(A);break;case OG.Constants.GEOM_TYPE.BEZIER_CURVE:I="";F=G.getControlPoints();for(B=0;B<F.length;B++){if(B===0){I="M"+F[B].x+" "+F[B].y}else{if(B===1){I+="C"+F[B].x+" "+F[B].y}else{I+=" "+F[B].x+" "+F[B].y}}}C=q.path(I);C.attr(A);break;case OG.Constants.GEOM_TYPE.COLLECTION:for(B=0;B<G.geometries.length;B++){e(E,G.geometries[B],y,G.style.map)}break}if(C){p(C);E.appendChild(C.node);return C.node}else{return E}};t=function(A,z,D,C){var y={x:D[0],y:D[1]},B={x:C[0],y:C[1]};if(A==="c"&&z==="c"){if(y.x<=B.x&&y.y<=B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="e";z="w"}else{A="s";z="n"}}else{if(y.x<=B.x&&y.y>B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="e";z="w"}else{A="n";z="s"}}else{if(y.x>B.x&&y.y<=B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="w";z="e"}else{A="s";z="n"}}else{if(y.x>B.x&&y.y>B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="w";z="e"}else{A="n";z="s"}}}}}}else{if(A==="c"&&z!=="c"){if(y.x<=B.x&&y.y<=B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="e"}else{A="s"}}else{if(y.x<=B.x&&y.y>B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="e"}else{A="n"}}else{if(y.x>B.x&&y.y<=B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="w"}else{A="s"}}else{if(y.x>B.x&&y.y>B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){A="w"}else{A="n"}}}}}}else{if(A!=="c"&&z==="c"){if(y.x<=B.x&&y.y<=B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){z="w"}else{z="n"}}else{if(y.x<=B.x&&y.y>B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){z="w"}else{z="s"}}else{if(y.x>B.x&&y.y<=B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){z="e"}else{z="n"}}else{if(y.x>B.x&&y.y>B.y){if(Math.abs(B.x-y.x)>Math.abs(B.y-y.y)){z="e"}else{z="s"}}}}}}}}return A+" "+z};m=function(A,F,G){var D={x:F[0],y:F[1]},y={x:G[0],y:G[1]},H=v.drawTerminal(A),B=H.terminal.childNodes,E,C,z;if(Math.abs(y.x-D.x)>Math.abs(y.y-D.y)){if(y.x>D.x){E="e"}else{E="w"}}else{if(y.y>D.y){E="s"}else{E="n"}}C=B[0];for(z=0;z<B.length;z++){if(B[z].terminal&&B[z].terminal.direction.toLowerCase()===E){C=B[z];break}}return C};r=function(H,I,G,B){var C=100,E=[1,0],D=[-1,0],A,z,y,F=[];A=Math.sqrt(Math.pow(H[0]-I[0],2)+Math.pow(H[1]-I[1],2));if(A<C){C=A/2}switch(G.toLowerCase()){case"e":E=[1,0];break;case"w":E=[-1,0];break;case"s":E=[0,1];break;case"n":E=[0,-1];break;default:E=[1,0];break}switch(B.toLowerCase()){case"e":D=[1,0];break;case"w":D=[-1,0];break;case"s":D=[0,1];break;case"n":D=[0,-1];break;default:D=[-1,0];break}z=[E[0]*C,E[1]*C];y=[D[0]*C,D[1]*C];F[0]=H;F[1]=[H[0]+z[0],H[1]+z[1]];F[2]=[I[0]+y[0],I[1]+y[1]];F[3]=I;return F};b=function(A,E,F){var D={x:E[0],y:E[1]},y={x:F[0],y:F[1]},G=v.drawTerminal(A),B=G.terminal.childNodes,C,H,z;if(Math.abs(y.x-D.x)>Math.abs(y.y-D.y)){if(y.x>D.x){C="w"}else{C="e"}}else{if(y.y>D.y){C="n"}else{C="s"}}H=B[0];for(z=0;z<B.length;z++){if(B[z].terminal&&B[z].terminal.direction.toLowerCase()===C){H=B[z];break}}return H};i=function(y){var z=OG.Util.isElement(y)?y.id:y;if(z){return v.getElementById(z.substring(0,z.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP)))}else{return null}};l=function(T,K,M,R,O,D){var C=OG.Constants.LABEL_PADDING,P=M?M[0]-C*2:null,N=M?M[1]-C*2:null,S=M?M[2]||0:0,G,A,z,F={},H,Q,E,B,L,J,I;OG.Util.apply(F,(R instanceof OG.geometry.Style)?R.map:R||{},OG.Constants.DEFAULT_STYLE.TEXT);if(O===0||O){G=x(O);if(G){h(G)}else{G=q.group();p(G,O)}}else{G=q.group();p(G,O)}H=F["text-anchor"]||"middle";F["text-anchor"]="middle";A=q.text(T[0],T[1],K);A.attr(F);E=A.getBBox();P=P?(P>E.width?P:E.width):E.width;N=N?(N>E.height?N:E.height):E.height;B=OG.Util.round(T[0]-P/2);L=OG.Util.round(T[1]-N/2);Q=new OG.Rectangle([B,L],P,N);if(F["label-direction"]==="vertical"){switch(H){case"start":I=Q.getBoundary().getLowerCenter().y;break;case"end":I=Q.getBoundary().getUpperCenter().y;break;case"middle":I=Q.getBoundary().getCentroid().y;break;default:I=Q.getBoundary().getCentroid().y;break}switch(F["vertical-align"]){case"top":J=OG.Util.round(Q.getBoundary().getLeftCenter().x+E.height/2);break;case"bottom":J=OG.Util.round(Q.getBoundary().getRightCenter().x-E.height/2);break;case"middle":J=Q.getBoundary().getCentroid().x;break;default:J=Q.getBoundary().getCentroid().x;break}S=-90}else{switch(H){case"start":J=Q.getBoundary().getLeftCenter().x;break;case"end":J=Q.getBoundary().getRightCenter().x;break;case"middle":J=Q.getBoundary().getCentroid().x;break;default:J=Q.getBoundary().getCentroid().x;break}switch(F["vertical-align"]){case"top":I=OG.Util.round(Q.getBoundary().getUpperCenter().y+E.height/2);break;case"bottom":I=OG.Util.round(Q.getBoundary().getLowerCenter().y-E.height/2);break;case"middle":I=Q.getBoundary().getCentroid().y;break;default:I=Q.getBoundary().getCentroid().y;break}}A.attr({x:J,y:I,stroke:"none",fill:F["font-color"]||OG.Constants.DEFAULT_STYLE.LABEL["font-color"],"font-size":F["font-size"]||OG.Constants.DEFAULT_STYLE.LABEL["font-size"],"fill-opacity":1});if(S||F["label-angle"]){if(S===0){S=parseInt(F["label-angle"],10)}A.rotate(S)}A.attr({"text-anchor":H});if(D&&K){E=A.getBBox();z=q.rect(E.x-C/2,E.y-C/2,E.width+C,E.height+C);z.attr({stroke:"none",fill:d,"fill-opacity":1});p(z);G.node.appendChild(z.node)}p(A);G.node.appendChild(A.node);return G.node};k=p(q.group(),null,OG.Constants.NODE_TYPE.ROOT);f=p(q.group(),null,OG.Constants.NODE_TYPE.ETC);q.id="OG_"+o;q.canvas.id="OG_"+o;$(q.canvas).css({"background-color":d,"user-select":"none","-o-user-select":"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none"});if(a){$(q.canvas).css({"background-image":a})}$(q.canvas.parentNode).attr("tabindex","0");$(q.canvas.parentNode).css({outline:"none"});if($(q.canvas.parentNode).css("position")==="static"){$(q.canvas.parentNode).css({position:"relative",left:"0",top:"0"})}this.drawShape=function(E,F,J,y,z){var A=J?J[0]:100,I=J?J[1]:100,B,G,H,C,D;if(F instanceof OG.shape.GeomShape){G=F.createShape();G.moveCentroid(E);G.resizeBox(A,I);B=this.drawGeom(G,y,z);F.geom=B.geom}else{if(F instanceof OG.shape.TextShape){H=F.createShape();B=this.drawText(E,H,J,y,z);F.text=B.text;F.angle=B.angle;F.geom=B.geom}else{if(F instanceof OG.shape.ImageShape){C=F.createShape();B=this.drawImage(E,C,J,y,z);F.image=B.image;F.angle=B.angle;F.geom=B.geom}else{if(F instanceof OG.shape.HtmlShape){D=F.createShape();B=this.drawHtml(E,D,J,y,z);F.html=B.html;F.angle=B.angle;F.geom=B.geom}else{if(F instanceof OG.shape.EdgeShape){G=F.geom||F.createShape();B=this.drawEdge(G,y,z);F.geom=B.geom}else{if(F instanceof OG.shape.GroupShape){G=F.createShape();G.moveCentroid(E);G.resizeBox(A,I);B=this.drawGroup(G,y,z);F.geom=B.geom}}}}}}if(F.geom){B.shape=F}B.shapeStyle=(y instanceof OG.geometry.Style)?y.map:y;$(B).attr("_shape_id",F.SHAPE_ID);if(!(F instanceof OG.shape.TextShape)){this.drawLabel(B);if(F instanceof OG.shape.EdgeShape){this.drawEdgeLabel(B,null,"FROM");this.drawEdgeLabel(B,null,"TO")}}if(B.geom){if(OG.Util.isIE7()){B.removeAttribute("geom")}else{delete B.geom}}if(B.text){if(OG.Util.isIE7()){B.removeAttribute("text")}else{delete B.text}}if(B.image){if(OG.Util.isIE7()){B.removeAttribute("image")}else{delete B.image}}if(B.angle){if(OG.Util.isIE7()){B.removeAttribute("angle")}else{delete B.angle}}$(q.canvas).trigger("drawShape",[B]);return B};this.drawGeom=function(B,z,C){var A,y={};OG.Util.apply(y,(z instanceof OG.geometry.Style)?z.map:z||{});if(C===0||C){A=x(C);if(A){h(A)}else{A=q.group();p(A,C,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.GEOM);k.node.appendChild(A.node)}}else{A=q.group();p(A,C,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.GEOM);k.node.appendChild(A.node)}e(A.node,B,y);A.node.geom=B;A.attr(OG.Constants.DEFAULT_STYLE.SHAPE);if(A.node.shape){A.node.shape.geom=B;if(A.node.geom){if(OG.Util.isIE7()){A.node.removeAttribute("geom")}else{delete A.node.geom}}}return A.node};this.drawText=function(G,M,P,z,A){var B=P?P[0]:null,N=P?P[1]:null,E=P?P[2]||0:0,L,F,D={},J,O,C,I,K,H;OG.Util.apply(D,(z instanceof OG.geometry.Style)?z.map:z||{},OG.Constants.DEFAULT_STYLE.TEXT);if(A===0||A){L=x(A);if(L){h(L)}else{L=q.group();p(L,A,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.TEXT);k.node.appendChild(L.node)}}else{L=q.group();p(L,A,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.TEXT);k.node.appendChild(L.node)}F=q.text(G[0],G[1],M);F.attr(D);O=F.getBBox();B=B?(B>O.width?B:O.width):O.width;N=N?(N>O.height?N:O.height):O.height;C=OG.Util.round(G[0]-B/2);I=OG.Util.round(G[1]-N/2);J=new OG.Rectangle([C,I],B,N);J.style.map=D;switch(D["text-anchor"]){case"start":K=J.getBoundary().getLeftCenter().x;break;case"end":K=J.getBoundary().getRightCenter().x;break;case"middle":K=J.getBoundary().getCentroid().x;break;default:K=J.getBoundary().getCentroid().x;break}switch(D["vertical-align"]){case"top":H=OG.Util.round(J.getBoundary().getUpperCenter().y+O.height/2);break;case"bottom":H=OG.Util.round(J.getBoundary().getLowerCenter().y-O.height/2);break;case"middle":H=J.getBoundary().getCentroid().y;break;default:H=J.getBoundary().getCentroid().y;break}F.attr({x:K,y:H});F.attr({stroke:"none",fill:D["font-color"]||OG.Constants.DEFAULT_STYLE.LABEL["font-color"],"font-size":D["font-size"]||OG.Constants.DEFAULT_STYLE.LABEL["font-size"]});if(E){F.rotate(E)}p(F);L.node.appendChild(F.node);L.node.text=M;L.node.angle=E;L.node.geom=J;L.attr(OG.Constants.DEFAULT_STYLE.SHAPE);if(L.node.shape){L.node.shape.text=M;L.node.shape.angle=E;L.node.shape.geom=J;if(L.node.text){if(OG.Util.isIE7()){L.node.removeAttribute("text")}else{delete L.node.text}}if(L.node.angle){if(OG.Util.isIE7()){L.node.removeAttribute("angle")}else{delete L.node.angle}}if(L.node.geom){if(OG.Util.isIE7()){L.node.removeAttribute("geom")}else{delete L.node.geom}}}return L.node};this.drawHtml=function(G,F,M,y,z){var A=M?M[0]:null,K=M?M[1]:null,D=M?M[2]||0:0,J,E,C={},L,I,B,H;OG.Util.apply(C,(y instanceof OG.geometry.Style)?y.map:y||{},OG.Constants.DEFAULT_STYLE.HTML);if(z===0||z){J=x(z);if(J){h(J)}else{J=q.group();p(J,z,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.HTML);k.node.appendChild(J.node)}}else{J=q.group();p(J,z,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.HTML);k.node.appendChild(J.node)}E=q.foreignObject(F,G[0],G[1],A,K);E.attr(C);L=E.getBBox();A=A||L.width;K=K||L.height;B=OG.Util.round(G[0]-A/2);H=OG.Util.round(G[1]-K/2);E.attr({x:B,y:H});I=new OG.Rectangle([B,H],A,K);if(D){E.rotate(D)}I.style.map=C;p(E);J.node.appendChild(E.node);J.node.html=F;J.node.angle=D;J.node.geom=I;J.attr(OG.Constants.DEFAULT_STYLE.SHAPE);if(J.node.shape){J.node.shape.html=F;J.node.shape.angle=D;J.node.shape.geom=I;if(J.node.html){if(OG.Util.isIE7()){J.node.removeAttribute("html")}else{delete J.node.html}}if(J.node.angle){if(OG.Util.isIE7()){J.node.removeAttribute("angle")}else{delete J.node.angle}}if(J.node.geom){if(OG.Util.isIE7()){J.node.removeAttribute("geom")}else{delete J.node.geom}}}return J.node};this.drawImage=function(F,L,M,y,z){var A=M?M[0]:null,J=M?M[1]:null,D=M?M[2]||0:0,I,E,C={},K,H,B,G;OG.Util.apply(C,(y instanceof OG.geometry.Style)?y.map:y||{},OG.Constants.DEFAULT_STYLE.IMAGE);if(z===0||z){I=x(z);if(I){h(I)}else{I=q.group();p(I,z,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.IMAGE);k.node.appendChild(I.node)}}else{I=q.group();p(I,z,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.IMAGE);k.node.appendChild(I.node)}E=q.image(L,F[0],F[1],A,J);E.attr(C);K=E.getBBox();A=A||K.width;J=J||K.height;B=OG.Util.round(F[0]-A/2);G=OG.Util.round(F[1]-J/2);E.attr({x:B,y:G});H=new OG.Rectangle([B,G],A,J);if(D){E.rotate(D)}H.style.map=C;p(E);I.node.appendChild(E.node);I.node.image=L;I.node.angle=D;I.node.geom=H;I.attr(OG.Constants.DEFAULT_STYLE.SHAPE);if(I.node.shape){I.node.shape.image=L;I.node.shape.angle=D;I.node.shape.geom=H;if(I.node.image){if(OG.Util.isIE7()){I.node.removeAttribute("image")}else{delete I.node.image}}if(I.node.angle){if(OG.Util.isIE7()){I.node.removeAttribute("angle")}else{delete I.node.angle}}if(I.node.geom){if(OG.Util.isIE7()){I.node.removeAttribute("geom")}else{delete I.node.geom}}}return I.node};this.drawEdge=function(L,y,z,C){var J,B={},D=L.getVertices(),G=D[0],F=D[D.length-1],I=[],A,E,K=function(O,N,M){if(M){return[[O[0],O[1]],[N[0],O[1]],[N[0],N[1]]]}else{return[[O[0],O[1]],[O[0],N[1]],[N[0],N[1]]]}},H=function(O,N,M){if(M){return[[O[0],O[1]],[OG.Util.round((O[0]+N[0])/2),O[1]],[OG.Util.round((O[0]+N[0])/2),N[1]],[N[0],N[1]]]}else{return[[O[0],O[1]],[O[0],OG.Util.round((O[1]+N[1])/2)],[N[0],OG.Util.round((O[1]+N[1])/2)],[N[0],N[1]]]}};OG.Util.apply(B,(y instanceof OG.geometry.Style)?y.map:y||{},OG.Util.apply({},L.style.map,OG.Constants.DEFAULT_STYLE.EDGE));if(z===0||z){J=x(z);if(J){h(J)}else{J=q.group();p(J,z,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.EDGE);k.node.appendChild(J.node)}}else{J=q.group();p(J,z,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.EDGE);k.node.appendChild(J.node)}if(C){I=[[G.x,G.y-OG.Constants.GUIDE_RECT_SIZE/2],[G.x+OG.Constants.GUIDE_RECT_SIZE*2,G.y-OG.Constants.GUIDE_RECT_SIZE],[G.x+OG.Constants.GUIDE_RECT_SIZE*2,G.y+OG.Constants.GUIDE_RECT_SIZE],[G.x,G.y+OG.Constants.GUIDE_RECT_SIZE/2]]}else{if(L instanceof OG.geometry.Line){switch(B["edge-type"].toLowerCase()){case OG.Constants.EDGE_TYPE.STRAIGHT:I=[G,F];break;case OG.Constants.EDGE_TYPE.PLAIN:E=B["edge-direction"].toLowerCase().split(" ");if(E[0]==="c"||E[1]==="c"){E=t(E[0],E[1],[G.x,G.y],[F.x,F.y]).split(" ")}if(E[0]==="e"){switch(E[1]){case"e":if(G.x<=F.x){I=K([G.x,G.y],[F.x+OG.Constants.EDGE_PADDING,F.y],true);I.push([F.x,F.y])}else{I=[[G.x,G.y]];I=I.concat(K([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x,F.y],false))}break;case"w":if(G.x<=F.x){I=H([G.x,G.y],[F.x,F.y],true)}else{I=[[G.x,G.y]];I=I.concat(H([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x-OG.Constants.EDGE_PADDING,F.y],false));I.push([F.x,F.y])}break;case"s":if(G.x<=F.x&&G.y<=F.y){I=H([G.x,G.y],[F.x,F.y+OG.Constants.EDGE_PADDING],true);I.push([F.x,F.y])}else{if(G.x<=F.x&&G.y>F.y){I=K([G.x,G.y],[F.x,F.y],true)}else{if(G.x>F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(K([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x,F.y+OG.Constants.EDGE_PADDING],false));I.push([F.x,F.y])}else{if(G.x>F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(H([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x,F.y],false))}}}}break;case"n":if(G.x<=F.x&&G.y<=F.y){I=K([G.x,G.y],[F.x,F.y],true)}else{if(G.x<=F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(K([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x,F.y-OG.Constants.EDGE_PADDING],false));I.push([F.x,F.y])}else{if(G.x>F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(H([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x,F.y],false))}else{if(G.x>F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(K([G.x+OG.Constants.EDGE_PADDING,G.y],[F.x,F.y-OG.Constants.EDGE_PADDING],false));I.push([F.x,F.y])}}}}break}}else{if(E[0]==="w"){switch(E[1]){case"e":if(G.x<=F.x){I=[[G.x,G.y]];I=I.concat(H([G.x-OG.Constants.EDGE_PADDING,G.y],[F.x+OG.Constants.EDGE_PADDING,F.y],false));I.push([F.x,F.y])}else{I=H([G.x,G.y],[F.x,F.y],true)}break;case"w":if(G.x<=F.x){I=[[G.x,G.y]];I=I.concat(K([G.x-OG.Constants.EDGE_PADDING,G.y],[F.x,F.y],false))}else{I=K([G.x,G.y],[F.x-OG.Constants.EDGE_PADDING,F.y],true);I.push([F.x,F.y])}break;case"s":if(G.x<=F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(K([G.x-OG.Constants.EDGE_PADDING,G.y],[F.x,F.y+OG.Constants.EDGE_PADDING],false));I.push([F.x,F.y])}else{if(G.x<=F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(H([G.x-OG.Constants.EDGE_PADDING,G.y],[F.x,F.y],false))}else{if(G.x>F.x&&G.y<=F.y){I=H([G.x,G.y],[F.x,F.y+OG.Constants.EDGE_PADDING],true);I.push([F.x,F.y])}else{if(G.x>F.x&&G.y>F.y){I=K([G.x,G.y],[F.x,F.y],true)}}}}break;case"n":if(G.x<=F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(H([G.x-OG.Constants.EDGE_PADDING,G.y],[F.x,F.y],false))}else{if(G.x<=F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(K([G.x-OG.Constants.EDGE_PADDING,G.y],[F.x,F.y-OG.Constants.EDGE_PADDING],false));I.push([F.x,F.y])}else{if(G.x>F.x&&G.y<=F.y){I=I.concat(K([G.x,G.y],[F.x,F.y],true))}else{if(G.x>F.x&&G.y>F.y){I=H([G.x,G.y],[F.x,F.y-OG.Constants.EDGE_PADDING],true);I.push([F.x,F.y])}}}}break}}else{if(E[0]==="s"){switch(E[1]){case"e":if(G.x<=F.x&&G.y<=F.y){I=H([G.x,G.y],[F.x+OG.Constants.EDGE_PADDING,F.y],false);I.push([F.x,F.y])}else{if(G.x<=F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(K([G.x,G.y+OG.Constants.EDGE_PADDING],[F.x+OG.Constants.EDGE_PADDING,F.y],true));I.push([F.x,F.y])}else{if(G.x>F.x&&G.y<=F.y){I=K([G.x,G.y],[F.x,F.y],false)}else{if(G.x>F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(H([G.x,G.y+OG.Constants.EDGE_PADDING],[F.x,F.y],true))}}}}break;case"w":if(G.x<=F.x&&G.y<=F.y){I=K([G.x,G.y],[F.x,F.y],false)}else{if(G.x<=F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(H([G.x,G.y+OG.Constants.EDGE_PADDING],[F.x,F.y],true))}else{if(G.x>F.x&&G.y<=F.y){I=H([G.x,G.y],[F.x-OG.Constants.EDGE_PADDING,F.y],false);I.push([F.x,F.y])}else{if(G.x>F.x&&G.y>F.y){I=[[G.x,G.y]];I=I.concat(K([G.x,G.y+OG.Constants.EDGE_PADDING],[F.x-OG.Constants.EDGE_PADDING,F.y],true));I.push([F.x,F.y])}}}}break;case"s":if(G.y<=F.y){I=K([G.x,G.y],[F.x,F.y+OG.Constants.EDGE_PADDING],false);I.push([F.x,F.y])}else{I=[[G.x,G.y]];I=I.concat(K([G.x,G.y+OG.Constants.EDGE_PADDING],[F.x,F.y],true))}break;case"n":if(G.y<=F.y){I=H([G.x,G.y],[F.x,F.y],false)}else{I=[[G.x,G.y]];I=I.concat(H([G.x,G.y+OG.Constants.EDGE_PADDING],[F.x,F.y-OG.Constants.EDGE_PADDING],true));I.push([F.x,F.y])}break}}else{if(E[0]==="n"){switch(E[1]){case"e":if(G.x<=F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(K([G.x,G.y-OG.Constants.EDGE_PADDING],[F.x+OG.Constants.EDGE_PADDING,F.y],true));I.push([F.x,F.y])}else{if(G.x<=F.x&&G.y>F.y){I=H([G.x,G.y],[F.x+OG.Constants.EDGE_PADDING,F.y],false);I.push([F.x,F.y])}else{if(G.x>F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(H([G.x,G.y-OG.Constants.EDGE_PADDING],[F.x,F.y],true))}else{if(G.x>F.x&&G.y>F.y){I=K([G.x,G.y],[F.x,F.y],false)}}}}break;case"w":if(G.x<=F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(H([G.x,G.y-OG.Constants.EDGE_PADDING],[F.x,F.y],true))}else{if(G.x<=F.x&&G.y>F.y){I=K([G.x,G.y],[F.x,F.y],false)}else{if(G.x>F.x&&G.y<=F.y){I=[[G.x,G.y]];I=I.concat(K([G.x,G.y-OG.Constants.EDGE_PADDING],[F.x-OG.Constants.EDGE_PADDING,F.y],true));I.push([F.x,F.y])}else{if(G.x>F.x&&G.y>F.y){I=H([G.x,G.y],[F.x-OG.Constants.EDGE_PADDING,F.y],false);I.push([F.x,F.y])}}}}break;case"s":if(G.y<=F.y){I=[[G.x,G.y]];I=I.concat(H([G.x,G.y-OG.Constants.EDGE_PADDING],[F.x,F.y+OG.Constants.EDGE_PADDING],true));I.push([F.x,F.y])}else{I=H([G.x,G.y],[F.x,F.y],false)}break;case"n":if(G.y<=F.y){I=[[G.x,G.y]];I=I.concat(K([G.x,G.y-OG.Constants.EDGE_PADDING],[F.x,F.y],true))}else{I=K([G.x,G.y],[F.x,F.y-OG.Constants.EDGE_PADDING],false);I.push([F.x,F.y])}break}}}}}break;case OG.Constants.EDGE_TYPE.BEZIER:E=B["edge-direction"].toLowerCase().split(" ");if(E[0]==="c"||E[1]==="c"){E=t(E[0],E[1],[G.x,G.y],[F.x,F.y]).split(" ")}I=r([G.x,G.y],[F.x,F.y],E[0],E[1]);break}}else{if(L instanceof OG.geometry.Curve){I=L.getControlPoints()}else{if(L instanceof OG.geometry.BezierCurve){I=L.getControlPoints()}else{I=D}}}}if(C){A=new OG.Curve(I)}else{if(L instanceof OG.geometry.Curve){A=new OG.Curve(I)}else{if(L instanceof OG.geometry.BezierCurve){A=new OG.BezierCurve(I)}else{if(B["edge-type"].toLowerCase()===OG.Constants.EDGE_TYPE.BEZIER){A=new OG.BezierCurve(I)}else{A=new OG.PolyLine(I)}}}}e(J.node,A,OG.Constants.DEFAULT_STYLE.EDGE_HIDDEN);e(J.node,A,B);J.node.geom=A;J.attr(OG.Constants.DEFAULT_STYLE.SHAPE);if(J.node.shape){J.node.shape.geom=A;if(J.node.geom){if(OG.Util.isIE7()){J.node.removeAttribute("geom")}else{delete J.node.geom}}}return J.node};this.drawGroup=function(F,z,A){var G,I,C={},H,D,B,y,E={};OG.Util.apply(C,(z instanceof OG.geometry.Style)?z.map:z||{});if(A===0||A){G=x(A);if(G){H=G.node.childNodes;for(D=H.length-1;D>=0;D--){if($(H[D]).attr("_type")!==OG.Constants.NODE_TYPE.SHAPE){w(x(H[D].id))}}}else{G=q.group();p(G,A,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.GROUP);k.node.appendChild(G.node)}}else{G=q.group();p(G,A,OG.Constants.NODE_TYPE.SHAPE,OG.Constants.SHAPE_TYPE.GROUP);k.node.appendChild(G.node)}I=e(G.node,F,C);G.node.geom=F;G.attr(OG.Constants.DEFAULT_STYLE.SHAPE);OG.Util.apply(E,F.style.map,C);if(E["label-direction"]&&E["vertical-align"]==="top"){B=F.getBoundary();if(E["label-direction"]==="vertical"){y=new OG.geometry.Line([B.getUpperLeft().x+20,B.getUpperLeft().y],[B.getLowerLeft().x+20,B.getLowerLeft().y])}else{y=new OG.geometry.Line([B.getUpperLeft().x,B.getUpperLeft().y+20],[B.getUpperRight().x,B.getUpperRight().y+20])}e(G.node,y,C)}if(I.id!==G.node.firstChild.id){G.node.insertBefore(I,G.node.firstChild)}if(G.node.shape){if(!G.node.shape.isCollapsed||G.node.shape.isCollapsed===false){G.node.shape.geom=F}if(G.node.geom){if(OG.Util.isIE7()){G.node.removeAttribute("geom")}else{delete G.node.geom}}}return G.node};this.drawLabel=function(H,K,z){var E=x(OG.Util.isElement(H)?H.id:H),C,F,G,A={},D,L,B,J,I=function(Q){var O,M,R=0,P,N;O=Q.shape.geom.getVertices();M=Q.shape.geom.getLength();for(P=0;P<O.length-1;P++){R+=O[P].distance(O[P+1]);if(R>M/2){N=Q.shape.geom.intersectCircleToLine(O[P+1],R-M/2,O[P+1],O[P]);break}}return N[0]},y;OG.Util.apply(A,(z instanceof OG.geometry.Style)?z.map:z||{});if(E&&E.node.shape){K=OG.Util.trim(K);C=E.node;G=C.shape.geom.getBoundary();B=C.shape.label;if(K!==undefined&&K!==B){J=jQuery.Event("beforeLabelChange",{element:C,afterText:K,beforeText:B});$(q.canvas).trigger(J);if(J.isPropagationStopped()){return false}K=J.afterText}OG.Util.apply(C.shape.geom.style.map,A);C.shape.label=K===undefined?C.shape.label:K;if(C.shape.label!==undefined){if(C.shape instanceof OG.shape.EdgeShape){y=I(C);D=[y.x,y.y];L=[0,0]}else{switch(C.shape.geom.style.get("label-position")){case"left":D=[G.getCentroid().x-G.getWidth(),G.getCentroid().y];break;case"right":D=[G.getCentroid().x+G.getWidth(),G.getCentroid().y];break;case"top":D=[G.getCentroid().x,G.getCentroid().y-G.getHeight()];break;case"bottom":D=[G.getCentroid().x,G.getCentroid().y+G.getHeight()];break;default:D=[G.getCentroid().x,G.getCentroid().y];break}L=[G.getWidth(),G.getHeight()]}F=l(D,C.shape.label,L,C.shape.geom.style,C.id+OG.Constants.LABEL_SUFFIX,C.shape instanceof OG.shape.EdgeShape);C.appendChild(F);if(K!==undefined){$(q.canvas).trigger("drawLabel",[C,K])}if(K!==undefined&&K!==B){$(q.canvas).trigger("labelChanged",[C,K,B])}}}return F};this.drawEdgeLabel=function(F,H,E){var B=x(OG.Util.isElement(F)?F.id:F),z,C,D,A,y,G;if(B&&B.node.shape){H=OG.Util.trim(H);z=B.node;if(z.shape instanceof OG.shape.EdgeShape){C=z.shape.geom.getVertices();if(E==="FROM"){A=[C[0].x,C[0].y+OG.Constants.FROMTO_LABEL_OFFSET_TOP];z.shape.fromLabel=H||z.shape.fromLabel;y=z.shape.fromLabel;G=OG.Constants.FROM_LABEL_SUFFIX}else{A=[C[C.length-1].x,C[C.length-1].y+OG.Constants.FROMTO_LABEL_OFFSET_TOP];z.shape.toLabel=H||z.shape.toLabel;y=z.shape.toLabel;G=OG.Constants.TO_LABEL_SUFFIX}if(y){D=l(A,y,[0,0],z.shape.geom.style,z.id+G,false);z.appendChild(D)}}}return D};this.redrawShape=function(C,F){var D=this,E,z,A,G,y,B;B=function(P,K){var Q,O,M,I=K.childNodes,H,N,L,J;for(N=I.length-1;N>=0;N--){if($(I[N]).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){B(P,I[N]);J=false;Q=$(I[N]).attr("_fromedge");if(Q){Q=Q.split(",");for(L=0;L<Q.length;L++){O=D.getElementById(Q[L]);if(O){H=i($(O).attr("_from"));if($(H).parents("#"+P.id).length===0){J=true}}}}Q=$(I[N]).attr("_toedge");if(Q){Q=Q.split(",");for(L=0;L<Q.length;L++){M=D.getElementById(Q[L]);if(M){H=i($(M).attr("_to"));if($(H).parents("#"+P.id).length===0){J=true}}}}if(J===true){D.redrawConnectedEdge(I[N])}}}};if(C&&C.shape.geom){switch($(C).attr("_shape")){case OG.Constants.SHAPE_TYPE.GEOM:C=this.drawGeom(C.shape.geom,{},C.id);this.redrawConnectedEdge(C,F);this.drawLabel(C);break;case OG.Constants.SHAPE_TYPE.TEXT:E=C.shape.geom.getBoundary();z=E.getCentroid();A=E.getWidth();G=E.getHeight();C=this.drawText([z.x,z.y],C.shape.text,[A,G,C.shape.angle],C.shape.geom.style,C.id);this.redrawConnectedEdge(C,F);break;case OG.Constants.SHAPE_TYPE.IMAGE:E=C.shape.geom.getBoundary();z=E.getCentroid();A=E.getWidth();G=E.getHeight();C=this.drawImage([z.x,z.y],C.shape.image,[A,G,C.shape.angle],C.shape.geom.style,C.id);this.redrawConnectedEdge(C,F);this.drawLabel(C);break;case OG.Constants.SHAPE_TYPE.HTML:E=C.shape.geom.getBoundary();z=E.getCentroid();A=E.getWidth();G=E.getHeight();C=this.drawHtml([z.x,z.y],C.shape.html,[A,G,C.shape.angle],C.shape.geom.style,C.id);this.redrawConnectedEdge(C,F);this.drawLabel(C);break;case OG.Constants.SHAPE_TYPE.EDGE:C=this.drawEdge(C.shape.geom,C.shape.geom.style,C.id);this.drawLabel(C);this.drawEdgeLabel(C,null,"FROM");this.drawEdgeLabel(C,null,"TO");break;case OG.Constants.SHAPE_TYPE.GROUP:if(C.shape.isCollapsed){E=C.shape.geom.getBoundary();y=E.getUpperLeft();C=this.drawGroup(new OG.geometry.Rectangle(y,OG.Constants.COLLAPSE_SIZE*3,OG.Constants.COLLAPSE_SIZE*2),C.shape.geom.style,C.id);B(C,C)}else{C=this.drawGroup(C.shape.geom,C.shape.geom.style,C.id);this.redrawConnectedEdge(C,F);this.drawLabel(C)}break}}$(q.canvas).trigger("redrawShape",[C]);return C};this.redrawEdge=function(z){var D,U,P,X,L,F,K,M,B,E,V,A,Q,R,G,I,H,S,J,O,C,W,y,N,T;D=OG.Util.isElement(z)?z:this.getElementById(z);U=$(D).attr("_from");P=$(D).attr("_to");if(U){X=i(U);F=parseInt(U.substring(U.lastIndexOf("_")+1),10);M=X.shape.createTerminal()[F];V=M.direction.toLowerCase();Q=M.position}else{E=D.shape.geom.getVertices();V="c";Q=E[0]}if(P){L=i(P);K=parseInt(P.substring(P.lastIndexOf("_")+1),10);B=L.shape.createTerminal()[K];A=B.direction.toLowerCase();R=B.position}else{E=D.shape.geom.getVertices();A="c";R=E[E.length-1]}G=Q;I=R;H=V;S=A;if(X&&V==="c"){J=this.intersectionEdge(D.shape.geom.style.get("edge-type"),X,[G.x,G.y],[I.x,I.y],true);Q=J.position;V=J.direction}if(L&&A==="c"){J=this.intersectionEdge(D.shape.geom.style.get("edge-type"),L,[G.x,G.y],[I.x,I.y],false);R=J.position;A=J.direction}O=X&&L&&X.id===L.id;if(O){Q=R=X.shape.geom.getBoundary().getRightCenter()}else{if(X){C=$(X).parents("[_collapsed=true]");if(C.length!==0){W=C[C.length-1].shape.geom.getBoundary();y=W.getUpperLeft();N=new OG.geometry.Rectangle(y,OG.Constants.COLLAPSE_SIZE*3,OG.Constants.COLLAPSE_SIZE*2);switch(V.toUpperCase()){case OG.Constants.TERMINAL_TYPE.E:T=N.getBoundary().getRightCenter();break;case OG.Constants.TERMINAL_TYPE.W:T=N.getBoundary().getLeftCenter();break;case OG.Constants.TERMINAL_TYPE.S:T=N.getBoundary().getLowerCenter();break;case OG.Constants.TERMINAL_TYPE.N:T=N.getBoundary().getUpperCenter();break}if(T){Q=[T.x,T.y]}}}if(L){C=$(L).parents("[_collapsed=true]");if(C.length!==0){W=C[C.length-1].shape.geom.getBoundary();y=W.getUpperLeft();N=new OG.geometry.Rectangle(y,OG.Constants.COLLAPSE_SIZE*3,OG.Constants.COLLAPSE_SIZE*2);switch(A.toUpperCase()){case OG.Constants.TERMINAL_TYPE.E:T=N.getBoundary().getRightCenter();break;case OG.Constants.TERMINAL_TYPE.W:T=N.getBoundary().getLeftCenter();break;case OG.Constants.TERMINAL_TYPE.S:T=N.getBoundary().getLowerCenter();break;case OG.Constants.TERMINAL_TYPE.N:T=N.getBoundary().getUpperCenter();break}if(T){R=[T.x,T.y]}}}}D=this.drawEdge(new OG.Line(Q,R),OG.Util.apply(D.shape.geom.style.map,{"edge-direction":V+" "+A}),D.id,O);this.drawLabel(D);this.drawEdgeLabel(D,null,"FROM");this.drawEdgeLabel(D,null,"TO");OG.Util.apply(D.shape.geom.style.map,{"edge-direction":H+" "+S})};this.redrawConnectedEdge=function(y,A){var B,z=this;B=$(y).attr("_fromedge");if(B){$.each(B.split(","),function(C,D){if(!A||A.toString().indexOf(D)<0){z.redrawEdge(D)}})}B=$(y).attr("_toedge");if(B){$.each(B.split(","),function(C,D){if(!A||A.toString().indexOf(D)<0){z.redrawEdge(D)}})}this.removeAllTerminal()};this.connect=function(M,y,C,P,H){var G={},R,J,I,L,N,D,E,Q,z,F,O,K,B,A=function(U,T,V){var W=$(U).attr(T),X=W?W.split(","):[],S=[];$.each(X,function(Y,Z){if(Z!==V){S.push(Z)}});S.push(V);$(U).attr(T,S.toString());return U};OG.Util.apply(G,(P instanceof OG.geometry.Style)?P.map:P||{},OG.Constants.DEFAULT_STYLE.EDGE);if(OG.Util.isElement(M)){R=i(M);L=[M.terminal.position.x,M.terminal.position.y];Q=M.terminal.direction.toLowerCase()}else{L=M;Q="c"}if(OG.Util.isElement(y)){J=i(y);N=[y.terminal.position.x,y.terminal.position.y];z=y.terminal.direction.toLowerCase()}else{N=y;z="c"}if(R&&J){B=jQuery.Event("beforeConnectShape",{edge:C,fromShape:R,toShape:J});$(q.canvas).trigger(B);if(B.isPropagationStopped()){this.remove(C);return false}}D=L;E=N;F=Q;O=z;if(R&&Q==="c"){I=this.intersectionEdge(G["edge-type"],R,D,E,true);L=I.position;Q=I.direction}if(J&&z==="c"){I=this.intersectionEdge(G["edge-type"],J,D,E,false);N=I.position;z=I.direction}K=R&&J&&R.id===J.id;if(K){L=N=R.shape.geom.getBoundary().getRightCenter()}C=this.drawEdge(new OG.Line(L,N),OG.Util.apply(G,{"edge-direction":Q+" "+z}),C?C.id:null,K);this.drawLabel(C,H);this.drawEdgeLabel(C,null,"FROM");this.drawEdgeLabel(C,null,"TO");OG.Util.apply(C.shape.geom.style.map,{"edge-direction":F+" "+O});C.shapeStyle=C.shape.geom.style.map;this.disconnect(C);if(OG.Util.isElement(M)){$(C).attr("_from",M.id);A(R,"_toedge",C.id)}if(OG.Util.isElement(y)){$(C).attr("_to",y.id);A(J,"_fromedge",C.id)}this.removeAllTerminal();if(R&&J){$(q.canvas).trigger("connectShape",[C,R,J])}return C};this.disconnect=function(D){var G=this,H,E,I,B,z,y,F,C,A=function(L,K,M){var N=$(L).attr(K),O=N?N.split(","):[],J=[];$.each(O,function(P,Q){if(Q!==M){J.push(Q)}});$(L).attr(K,J.toString());return L};if(D){if($(D).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){H=$(D).attr("_from");E=$(D).attr("_to");if(H){I=i(H);A(I,"_toedge",D.id);$(D).removeAttr("_from")}if(E){B=i(E);A(B,"_fromedge",D.id);$(D).removeAttr("_to")}if(I&&B){$(q.canvas).trigger("disconnectShape",[D,I,B])}}else{z=$(D).attr("_fromedge");y=$(D).attr("_toedge");if(z){$.each(z.split(","),function(J,K){F=G.getElementById(K);H=$(F).attr("_from");if(H){I=i(H);A(I,"_toedge",K)}if(I&&D){$(q.canvas).trigger("disconnectShape",[F,I,D])}G.remove(F)})}if(y){$.each(y.split(","),function(J,K){C=G.getElementById(K);E=$(C).attr("_to");if(E){B=i(E);A(B,"_fromedge",K)}if(D&&B){$(q.canvas).trigger("disconnectShape",[C,D,B])}G.remove(C)})}}}};this.drawDropOverGuide=function(C){var z=x(OG.Util.isElement(C)?C.id:C),F=z?z.node.shape.geom:null,E,B,D,y=OG.Constants.GUIDE_RECT_SIZE/2,A=y/2;if(z&&F&&$(C).attr("_shape")!==OG.Constants.SHAPE_TYPE.EDGE&&!x(z.id+OG.Constants.DROP_OVER_BBOX_SUFFIX)){E=F.getBoundary();B=E.getUpperLeft();D=q.rect(B.x-A,B.y-A,E.getWidth()+y,E.getHeight()+y);D.attr(OG.Util.apply({"stroke-width":y},OG.Constants.DEFAULT_STYLE.DROP_OVER_BBOX));p(D,z.id+OG.Constants.DROP_OVER_BBOX_SUFFIX);D.insertAfter(z)}};this.drawGuide=function(A){var Q=x(OG.Util.isElement(A)?A.id:A),G=Q?Q.node.shape.geom:null,z,J,U,I,M,C,E,N,L,T,W,D,R,K,P,H,y,B,S,V,F=OG.Constants.GUIDE_RECT_SIZE,O=OG.Util.round(F/2);if(Q&&G){if($(A).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){return this.drawEdgeGuide(A)}else{z=G.getBoundary();M=z.getUpperLeft();C=z.getUpperRight();E=z.getLowerLeft();N=z.getLowerRight();L=z.getLeftCenter();T=z.getUpperCenter();W=z.getRightCenter();D=z.getLowerCenter();if(x(Q.id+OG.Constants.GUIDE_SUFFIX.GUIDE)){w(x(Q.id+OG.Constants.GUIDE_SUFFIX.BBOX));I=q.rect(M.x,M.y,z.getWidth(),z.getHeight());I.attr(OG.Constants.DEFAULT_STYLE.GUIDE_BBOX);p(I,Q.id+OG.Constants.GUIDE_SUFFIX.BBOX);I.insertBefore(Q);R=x(Q.id+OG.Constants.GUIDE_SUFFIX.UL);K=x(Q.id+OG.Constants.GUIDE_SUFFIX.UR);P=x(Q.id+OG.Constants.GUIDE_SUFFIX.LL);H=x(Q.id+OG.Constants.GUIDE_SUFFIX.LR);y=x(Q.id+OG.Constants.GUIDE_SUFFIX.LC);B=x(Q.id+OG.Constants.GUIDE_SUFFIX.UC);S=x(Q.id+OG.Constants.GUIDE_SUFFIX.RC);V=x(Q.id+OG.Constants.GUIDE_SUFFIX.LWC);R.attr({x:M.x-O,y:M.y-O});K.attr({x:C.x-O,y:C.y-O});P.attr({x:E.x-O,y:E.y-O});H.attr({x:N.x-O,y:N.y-O});y.attr({x:L.x-O,y:L.y-O});B.attr({x:T.x-O,y:T.y-O});S.attr({x:W.x-O,y:W.y-O});V.attr({x:D.x-O,y:D.y-O});return null}J=x(Q.id+OG.Constants.GUIDE_SUFFIX.GUIDE);if(J){w(J);w(x(Q.id+OG.Constants.GUIDE_SUFFIX.BBOX))}J=q.group();I=q.rect(M.x,M.y,z.getWidth(),z.getHeight());R=q.rect(M.x-O,M.y-O,F,F);K=q.rect(C.x-O,C.y-O,F,F);P=q.rect(E.x-O,E.y-O,F,F);H=q.rect(N.x-O,N.y-O,F,F);y=q.rect(L.x-O,L.y-O,F,F);B=q.rect(T.x-O,T.y-O,F,F);S=q.rect(W.x-O,W.y-O,F,F);V=q.rect(D.x-O,D.y-O,F,F);I.attr(OG.Constants.DEFAULT_STYLE.GUIDE_BBOX);R.attr(OG.Constants.DEFAULT_STYLE.GUIDE_UL);K.attr(OG.Constants.DEFAULT_STYLE.GUIDE_UR);P.attr(OG.Constants.DEFAULT_STYLE.GUIDE_LL);H.attr(OG.Constants.DEFAULT_STYLE.GUIDE_LR);y.attr(OG.Constants.DEFAULT_STYLE.GUIDE_LC);B.attr(OG.Constants.DEFAULT_STYLE.GUIDE_UC);S.attr(OG.Constants.DEFAULT_STYLE.GUIDE_RC);V.attr(OG.Constants.DEFAULT_STYLE.GUIDE_LWC);J.appendChild(R);J.appendChild(K);J.appendChild(P);J.appendChild(H);J.appendChild(y);J.appendChild(B);J.appendChild(S);J.appendChild(V);p(J,Q.id+OG.Constants.GUIDE_SUFFIX.GUIDE);p(I,Q.id+OG.Constants.GUIDE_SUFFIX.BBOX);p(R,Q.id+OG.Constants.GUIDE_SUFFIX.UL);p(K,Q.id+OG.Constants.GUIDE_SUFFIX.UR);p(P,Q.id+OG.Constants.GUIDE_SUFFIX.LL);p(H,Q.id+OG.Constants.GUIDE_SUFFIX.LR);p(y,Q.id+OG.Constants.GUIDE_SUFFIX.LC);p(B,Q.id+OG.Constants.GUIDE_SUFFIX.UC);p(S,Q.id+OG.Constants.GUIDE_SUFFIX.RC);p(V,Q.id+OG.Constants.GUIDE_SUFFIX.LWC);U={bBox:I.node,group:J.node,ul:R.node,ur:K.node,ll:P.node,lr:H.node,lc:y.node,uc:B.node,rc:S.node,lwc:V.node};I.insertBefore(Q);J.insertAfter(Q);$(Q.node).attr("_selected","true");return U}}return null};this.removeGuide=function(A){var z=x(OG.Util.isElement(A)?A.id:A),y=x(z.id+OG.Constants.GUIDE_SUFFIX.GUIDE),B=x(z.id+OG.Constants.GUIDE_SUFFIX.BBOX);z.node.removeAttribute("_selected");w(y);w(B)};this.removeAllGuide=function(){$(this.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(y,z){if(OG.Util.isElement(z)&&z.id){v.removeGuide(z)}})};this.drawEdgeGuide=function(E){var I=x(OG.Util.isElement(E)?E.id:E),M=I?I.node.shape.geom:null,J,H,N,z,O,C,B,G,y,K=[],L=OG.Constants.GUIDE_RECT_SIZE,F=OG.Util.round(L/2),A={},D;if(I&&M){OG.Util.apply(A,M.style.map,OG.Constants.DEFAULT_STYLE.EDGE);J=A["edge-type"]===OG.Constants.EDGE_TYPE.BEZIER?M.getControlPoints():M.getVertices();H=$(E).attr("_from")&&$(E).attr("_to")&&$(E).attr("_from")===$(E).attr("_to");if(x(I.id+OG.Constants.GUIDE_SUFFIX.GUIDE)){w(x(I.id+OG.Constants.GUIDE_SUFFIX.BBOX));O="";if(A["edge-type"]===OG.Constants.EDGE_TYPE.BEZIER){for(D=0;D<J.length;D++){if(D===0){O="M"+J[D].x+" "+J[D].y}else{if(D===1){O+="C"+J[D].x+" "+J[D].y}else{O+=" "+J[D].x+" "+J[D].y}}}}else{for(D=0;D<J.length;D++){if(D===0){O="M"+J[D].x+" "+J[D].y}else{O+="L"+J[D].x+" "+J[D].y}}}C=q.path(O);C.attr(OG.Constants.DEFAULT_STYLE.GUIDE_BBOX);p(C,I.id+OG.Constants.GUIDE_SUFFIX.BBOX);C.insertBefore(I);B=x(I.id+OG.Constants.GUIDE_SUFFIX.FROM);B.attr({x:J[0].x-F,y:J[0].y-F});G=x(I.id+OG.Constants.GUIDE_SUFFIX.TO);G.attr({x:J[J.length-1].x-F,y:J[J.length-1].y-F});if(!H&&A["edge-type"]!==OG.Constants.EDGE_TYPE.BEZIER){for(D=1;D<J.length-2;D++){if(J[D].x===J[D+1].x){y=x(I.id+OG.Constants.GUIDE_SUFFIX.CTL_H+D);if(y){y.attr({x:J[D].x-F,y:OG.Util.round((J[D].y+J[D+1].y)/2)-F})}}else{y=x(I.id+OG.Constants.GUIDE_SUFFIX.CTL_V+D);if(y){y.attr({x:OG.Util.round((J[D].x+J[D+1].x)/2)-F,y:J[D].y-F})}}}}return null}N=x(I.id+OG.Constants.GUIDE_SUFFIX.GUIDE);if(N){w(N);w(x(I.id+OG.Constants.GUIDE_SUFFIX.BBOX))}N=q.group();O="";if(A["edge-type"]===OG.Constants.EDGE_TYPE.BEZIER){for(D=0;D<J.length;D++){if(D===0){O="M"+J[D].x+" "+J[D].y}else{if(D===1){O+="C"+J[D].x+" "+J[D].y}else{O+=" "+J[D].x+" "+J[D].y}}}}else{for(D=0;D<J.length;D++){if(D===0){O="M"+J[D].x+" "+J[D].y}else{O+="L"+J[D].x+" "+J[D].y}}}C=q.path(O);C.attr(OG.Constants.DEFAULT_STYLE.GUIDE_BBOX);B=q.rect(J[0].x-F,J[0].y-F,L,L);B.attr(OG.Constants.DEFAULT_STYLE.GUIDE_FROM);N.appendChild(B);p(B,I.id+OG.Constants.GUIDE_SUFFIX.FROM);G=q.rect(J[J.length-1].x-F,J[J.length-1].y-F,L,L);G.attr(OG.Constants.DEFAULT_STYLE.GUIDE_TO);N.appendChild(G);p(G,I.id+OG.Constants.GUIDE_SUFFIX.TO);if(!H&&A["edge-type"]!==OG.Constants.EDGE_TYPE.BEZIER){for(D=1;D<J.length-2;D++){if(J[D].x===J[D+1].x){y=q.rect(J[D].x-F,OG.Util.round((J[D].y+J[D+1].y)/2)-F,L,L);y.attr(OG.Constants.DEFAULT_STYLE.GUIDE_CTL_H);p(y,I.id+OG.Constants.GUIDE_SUFFIX.CTL_H+D)}else{y=q.rect(OG.Util.round((J[D].x+J[D+1].x)/2)-F,J[D].y-F,L,L);y.attr(OG.Constants.DEFAULT_STYLE.GUIDE_CTL_V);p(y,I.id+OG.Constants.GUIDE_SUFFIX.CTL_V+D)}N.appendChild(y);K.push(y.node)}}p(C,I.id+OG.Constants.GUIDE_SUFFIX.BBOX);p(N,I.id+OG.Constants.GUIDE_SUFFIX.GUIDE);z={bBox:C.node,group:N.node,from:B.node,to:G.node,controls:K};C.insertBefore(I);N.insertAfter(I);$(I.node).attr("_selected","true");return z}return null};this.drawRubberBand=function(C,H,z){var F=C?C[0]:0,D=C?C[1]:0,A=H?H[0]:0,G=H?H[1]:0,E=x(OG.Constants.RUBBER_BAND_ID),B={};if(E){E.attr({x:F,y:D,width:Math.abs(A),height:Math.abs(G)});return E}OG.Util.apply(B,(z instanceof OG.geometry.Style)?z.map:z||{},OG.Constants.DEFAULT_STYLE.RUBBER_BAND);E=q.rect(F,D,A,G).attr(B);p(E,OG.Constants.RUBBER_BAND_ID);f.node.appendChild(E.node);return E.node};this.removeRubberBand=function(y){this.setAttr(OG.Constants.RUBBER_BAND_ID,{x:0,y:0,width:0,height:0});$(y).removeData("dragBox_first");$(y).removeData("rubberBand")};this.drawTerminal=function(z,A){var B=x(OG.Util.isElement(z)?z.id:z),J=B?B.node.shape.createTerminal():null,D=B?B.node.shape.geom.getBoundary():null,I,H,F,G,E,K=OG.Constants.TERMINAL_SIZE,C=K*2;if(B&&J&&J.length>0){I=x(B.id+OG.Constants.TERMINAL_SUFFIX.GROUP);F=x(B.id+OG.Constants.TERMINAL_SUFFIX.BOX);if(I||F){return{bBox:F.node,terminal:I.node}}I=q.group();F=q.rect(D.getUpperLeft().x-C,D.getUpperLeft().y-C,D.getWidth()+C*2,D.getHeight()+C*2);F.attr(OG.Constants.DEFAULT_STYLE.TERMINAL_BBOX);p(F,B.id+OG.Constants.TERMINAL_SUFFIX.BOX);$.each(J,function(y,L){if(!A||L.inout.indexOf(A)>=0){G=L.position.x;E=L.position.y;H=q.circle(G,E,K);H.attr(OG.Constants.DEFAULT_STYLE.TERMINAL);H.node.terminal=L;I.appendChild(H);p(H,B.id+OG.Constants.TERMINAL_SUFFIX.GROUP+"_"+L.direction+"_"+L.inout+"_"+y)}});p(I,B.id+OG.Constants.TERMINAL_SUFFIX.GROUP);F.insertBefore(B);I.insertAfter(B);return{bBox:F.node,terminal:I.node}}return null};this.removeTerminal=function(z){var y=x(OG.Util.isElement(z)?z.id:z),B,A;if(y){B=x(y.id+OG.Constants.TERMINAL_SUFFIX.GROUP);if(B){w(B)}A=x(y.id+OG.Constants.TERMINAL_SUFFIX.BOX);if(A){w(A)}}};this.removeAllTerminal=function(){var y=this;$.each(u.keys(),function(z,A){y.removeTerminal(A)})};this.drawCollapseGuide=function(z){var C=x(OG.Util.isElement(z)?z.id:z),E=C?C.node.shape.geom:null,D,G,y,B,F=OG.Constants.COLLAPSE_SIZE,A=F/2;if(C&&E&&$(z).attr("_shape")===OG.Constants.SHAPE_TYPE.GROUP){y=x(C.id+OG.Constants.COLLAPSE_BBOX_SUFFIX);if(y){w(y)}B=x(C.id+OG.Constants.COLLAPSE_SUFFIX);if(B){w(B)}D=E.getBoundary();G=D.getUpperLeft();y=q.rect(D.getUpperLeft().x-F,D.getUpperLeft().y-F,D.getWidth()+F*2,D.getHeight()+F*2);y.attr(OG.Constants.DEFAULT_STYLE.COLLAPSE_BBOX);p(y,C.id+OG.Constants.COLLAPSE_BBOX_SUFFIX);if(C.node.shape.isCollapsed===true){B=q.path("M"+(G.x+A)+" "+(G.y+A)+"h"+F+"v"+F+"h"+(-1*F)+"v"+(-1*F)+"m1 "+A+"h"+(F-2)+"M"+(G.x+A)+" "+(G.y+A)+"m"+A+" 1v"+(F-2))}else{B=q.path("M"+(G.x+A)+" "+(G.y+A)+"h"+F+"v"+F+"h"+(-1*F)+"v"+(-1*F)+"m1 "+A+"h"+(F-2))}B.attr(OG.Constants.DEFAULT_STYLE.COLLAPSE);p(B,C.id+OG.Constants.COLLAPSE_SUFFIX);y.insertBefore(C);B.insertAfter(C);return{bBox:y.node,collapse:B.node}}return null};this.removeCollapseGuide=function(A){var y=x(OG.Util.isElement(A)?A.id:A),B,z;if(y){B=x(y.id+OG.Constants.COLLAPSE_BBOX_SUFFIX);if(B){w(B)}z=x(y.id+OG.Constants.COLLAPSE_SUFFIX);if(z){w(z)}}};this.group=function(y){var A,z=[],E,F,C,D,G,B;if(y&&y.length>1){for(B=0;B<y.length;B++){z.push(y[B].shape.geom)}E=new OG.GeometryCollection(z);F=E.getBoundary();C=[F.getCentroid().x,F.getCentroid().y];D=new OG.GroupShape();G=[F.getWidth(),F.getHeight()];A=this.drawShape(C,D,G);for(B=0;B<y.length;B++){A.appendChild(y[B])}$(q.canvas).trigger("group",[A])}return A};this.ungroup=function(B){var C=[],A,z,y;if(B&&B.length>0){for(z=0;z<B.length;z++){A=$(B[z]).children("[_type='"+OG.Constants.NODE_TYPE.SHAPE+"']");for(y=0;y<A.length;y++){B[z].parentNode.appendChild(A[y]);C.push(A[y])}this.removeShape(B[z])}$(q.canvas).trigger("ungroup",[C])}return C};this.addToGroup=function(z,A){var y;for(y=0;y<A.length;y++){z.appendChild(A[y])}};this.collapse=function(A){var B=this,C,z,y;y=function(L,G){var M,K,I,E=G.childNodes,D,J,H,F;for(J=E.length-1;J>=0;J--){if($(E[J]).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){y(L,E[J]);F=false;M=$(E[J]).attr("_fromedge");if(M){M=M.split(",");for(H=0;H<M.length;H++){K=B.getElementById(M[H]);if(K){D=i($(K).attr("_from"));if($(D).parents("#"+L.id).length!==0){B.hide(K)}else{F=true}}}}M=$(E[J]).attr("_toedge");if(M){M=M.split(",");for(H=0;H<M.length;H++){I=B.getElementById(M[H]);if(I){D=i($(I).attr("_to"));if($(D).parents("#"+L.id).length!==0){B.hide(I)}else{F=true}}}}if(F===true){B.redrawConnectedEdge(E[J])}}}};if(A.shape){C=A.childNodes;for(z=C.length-1;z>=0;z--){if($(C[z]).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){this.hide(C[z])}}A.shape.isCollapsed=true;$(A).attr("_collapsed",true);y(A,A);this.redrawShape(A);$(q.canvas).trigger("collapsed",[A])}};this.expand=function(A){var B=this,C,z,y;y=function(L,G){var M,K,I,E=G.childNodes,D,J,H,F;for(J=E.length-1;J>=0;J--){if($(E[J]).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){y(L,E[J]);F=false;M=$(E[J]).attr("_fromedge");if(M){M=M.split(",");for(H=0;H<M.length;H++){K=B.getElementById(M[H]);if(K){D=i($(K).attr("_from"));if($(D).parents("#"+L.id).length!==0){B.show(K)}else{F=true}}}}M=$(E[J]).attr("_toedge");if(M){M=M.split(",");for(H=0;H<M.length;H++){I=B.getElementById(M[H]);if(I){D=i($(I).attr("_to"));if($(D).parents("#"+L.id).length!==0){B.show(I)}else{F=true}}}}if(F===true){B.redrawConnectedEdge(E[J])}}}};if(A.shape){C=A.childNodes;for(z=C.length-1;z>=0;z--){if($(C[z]).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){this.show(C[z])}}A.shape.isCollapsed=false;$(A).attr("_collapsed",false);y(A,A);this.redrawShape(A);$(q.canvas).trigger("expanded",[A])}};this.clear=function(){q.clear();u.clear();o=Math.round(Math.random()*10000);j=0;k=p(q.group(),null,OG.Constants.NODE_TYPE.ROOT);f=p(q.group(),null,OG.Constants.NODE_TYPE.ETC)};this.removeShape=function(B){var y=x(OG.Util.isElement(B)?B.id:B),C,A,z;C=y.node.childNodes;A=jQuery.Event("beforeRemoveShape",{element:y.node});$(q.canvas).trigger(A);if(A.isPropagationStopped()){return false}for(z=C.length-1;z>=0;z--){if($(C[z]).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){this.removeShape(C[z])}}this.disconnect(y.node);this.removeTerminal(y.node);this.removeGuide(y.node);this.removeCollapseGuide(y.node);this.remove(y.node);$(q.canvas).trigger("removeShape",[y.node])};this.remove=function(z){var A=OG.Util.isElement(z)?z.id:z,y=x(A);w(y)};this.removeChild=function(z){var A=OG.Util.isElement(z)?z.id:z,y=x(A);h(y)};this.getRootElement=function(){return q.canvas};this.getRootGroup=function(){return k.node};this.getElementByPoint=function(y){var z=q.getElementByPoint(y[0],y[1]);return z?z.node.parentNode:null};this.getElementsByBBox=function(z){var y=[];$(this.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"]").each(function(A,B){if(B.shape.geom&&z.isContainsAll(B.shape.geom.getVertices())){y.push(B)}});return y};this.setAttr=function(z,A){var y=x(OG.Util.isElement(z)?z.id:z);if(y){y.attr(A)}};this.getAttr=function(A,z){var y=x(OG.Util.isElement(A)?A.id:A);if(y){return y.attr(z)}return null};this.setShapeStyle=function(z,A){var y=x(OG.Util.isElement(z)?z.id:z);if(y&&z.shape&&z.shape.geom){OG.Util.apply(z.shape.geom.style.map,A||{});z.shapeStyle=z.shapeStyle||{};OG.Util.apply(z.shapeStyle,A||{});this.redrawShape(z)}};this.toFront=function(z){var y=x(OG.Util.isElement(z)?z.id:z);if(y){y.toFront()}};this.toBack=function(z){var y=x(OG.Util.isElement(z)?z.id:z);if(y){y.toBack()}};this.getCanvasSize=function(){return[q.width,q.height]};this.setCanvasSize=function(y){q.setSize(y[0],y[1])};this.fitCanvasSize=function(D,C){var A=this.getRealRootBBox(),z,F,E=1,B=A.width+OG.Constants.FIT_CANVAS_PADDING*2,y=A.height+OG.Constants.FIT_CANVAS_PADDING*2;if(A.width!==0&&A.height!==0){z=A.x>OG.Constants.FIT_CANVAS_PADDING?-1*(A.x-OG.Constants.FIT_CANVAS_PADDING):OG.Constants.FIT_CANVAS_PADDING-A.x;F=A.y>OG.Constants.FIT_CANVAS_PADDING?-1*(A.y-OG.Constants.FIT_CANVAS_PADDING):OG.Constants.FIT_CANVAS_PADDING-A.y;this.move(this.getRootGroup(),[z,F]);this.removeAllGuide();if(D&&D.length===2){if(OG.Util.isDefined(C)&&C===true){E=D[0]/B>D[1]/y?D[1]/y:D[0]/B}B=B<D[0]?D[0]:B;y=y<D[1]?D[1]:y}this.setScale(OG.Util.roundPrecision(E,1));this.setCanvasSize([B,y])}};this.setViewBox=function(y,z,A){q.setViewBox(y[0],y[1],z[0],z[1],A)};this.getScale=function(y){return OG.Constants.SCALE};this.setScale=function(y){if(OG.Constants.SCALE_MIN<=y&&y<=OG.Constants.SCALE_MAX){if(this.isVML()){$(k.node).css({width:21600/y,height:21600/y});$(k.node).find("[_type=SHAPE]").each(function(z,A){$(A).css({width:21600,height:21600})})}else{$(k.node).attr("transform","scale("+y+")");$(f.node).attr("transform","scale("+y+")")}q.setSize(OG.Util.roundGrid(q.width/OG.Constants.SCALE*y),OG.Util.roundGrid(q.height/OG.Constants.SCALE*y));OG.Constants.SCALE=y}};this.show=function(z){var y=x(OG.Util.isElement(z)?z.id:z);if(y){y.show()}};this.hide=function(z){var y=x(OG.Util.isElement(z)?z.id:z);if(y){y.hide()}};this.appendChild=function(y,z){var A=x(OG.Util.isElement(y)?y.id:y),B=x(OG.Util.isElement(z)?z.id:z);B.appendChild(A);return A};this.insertAfter=function(y,z){var A=x(OG.Util.isElement(y)?y.id:y),B=x(OG.Util.isElement(z)?z.id:z);A.insertAfter(B);return A};this.insertBefore=function(y,z){var A=x(OG.Util.isElement(y)?y.id:y),B=x(OG.Util.isElement(z)?z.id:z);A.insertBefore(B);return A};this.move=function(z,E,C){var y=x(OG.Util.isElement(z)?z.id:z),A=y?y.node.getAttribute("_type"):null,D,B=this;this.removeCollapseGuide(z);if(y&&A){$(y.node).children("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape=EDGE]").each(function(F,G){B.move(G,E,C)});$(y.node).children("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape!=EDGE]").each(function(F,G){B.move(G,E,C)});if(A!==OG.Constants.NODE_TYPE.ROOT&&y.node.shape){D=y.node.shape.geom;D.move(E[0],E[1]);this.redrawShape(y.node,C);$(q.canvas).trigger("moveShape",[y.node,E]);return y.node}else{return z}}else{if(y){y.transform("...t"+E[0]+","+E[1]);$(q.canvas).trigger("moveShape",[y.node,E]);return y.node}}return null};this.moveCentroid=function(B,z,D){var A=x(OG.Util.isElement(B)?B.id:B),E=A?A.node.shape.geom:null,C,y={};if(A&&E){y=E.getCentroid();return this.move(B,[z[0]-y.x,z[1]-y.y],D)}else{if(A){C=A.getBBox();y.x=C.x+OG.Util.round(C.width/2);y.y=C.y+OG.Util.round(C.height/2);return this.move(B,[z[0]-y.x,z[1]-y.y])}}this.removeCollapseGuide(B);return null};this.rotate=function(B,A,H){var C=x(OG.Util.isElement(B)?B.id:B),F=C?C.node.getAttribute("_shape"):null,G=C?C.node.shape.geom:null,D,E,y,z,I;if(C&&F&&G){if(F===OG.Constants.SHAPE_TYPE.IMAGE||F===OG.Constants.SHAPE_TYPE.TEXT||F===OG.Constants.SHAPE_TYPE.HTML){D=C.node.shape.clone();E=G.getBoundary();y=E.getCentroid();z=E.getWidth();I=E.getHeight();this.drawShape([y.x,y.y],D,[z,I,A],C.node.shapeStyle,C.node.id)}else{if(C.node.shape.angle){G.rotate(-1*C.node.shape.angle)}G.rotate(A);C.node.shape.angle=A;this.redrawShape(C.node,H)}$(q.canvas).trigger("rotateShape",[C.node,A]);return C.node}else{if(C){C.rotate(A);$(q.canvas).trigger("rotateShape",[C.node,A]);return C.node}}return null};this.resize=function(B,z,H){var D=x(OG.Util.isElement(B)?B.id:B),F=D?D.node.getAttribute("_shape"):null,G=D?D.node.shape.geom:null,K,C,A,y,J,I,E;this.removeCollapseGuide(B);if(D&&F&&G){G.resize(z[0],z[1],z[2],z[3]);this.redrawShape(D.node,H);$(q.canvas).trigger("resizeShape",[D.node,z]);return D.node}else{if(D){K=D.getBBox();C=z[2]+z[3];A=z[0]+z[1];y=K.width+C;J=K.height+A;I=K.width===0?1:y/K.width;E=K.height===0?1:J/K.height;D.transform("...t"+(-1*z[2])+","+(-1*z[0]));D.transform("...s"+I+","+E+","+K.x+","+K.y);$(q.canvas).trigger("resizeShape",[D.node,z]);return D.node}}return null};this.resizeBox=function(B,A){var z=x(OG.Util.isElement(B)?B.id:B),E=z?z.node.shape.geom:null,F,D,C,y;this.removeCollapseGuide(B);if(z&&E){F=E.getBoundary();C=OG.Util.round((A[0]-F.getWidth())/2);y=OG.Util.round((A[1]-F.getHeight())/2);return this.resize(B,[y,y,C,C])}else{if(z){D=z.getBBox();C=OG.Util.round((A[0]-D.width)/2);y=OG.Util.round((A[1]-D.height)/2);return this.resize(B,[y,y,C,C])}}return null};this.intersectionEdge=function(O,D,I,J,B){var F,E,H,L,C,K=Number.MAX_VALUE,y,A,z,G,N,M;if(D){A=$(D).parents("[_collapsed=true]");if(A.length!==0){z=A[A.length-1].shape.geom.getBoundary();G=z.getUpperLeft();N=new OG.geometry.Rectangle(G,OG.Constants.COLLAPSE_SIZE*3,OG.Constants.COLLAPSE_SIZE*2)}}switch(O){case OG.Constants.EDGE_TYPE.PLAIN:case OG.Constants.EDGE_TYPE.BEZIER:F=B?m(D,I,J):b(D,I,J);E=[F.terminal.position.x,F.terminal.position.y];H=F.terminal.direction.toLowerCase();if(N){switch(F.terminal.direction){case OG.Constants.TERMINAL_TYPE.E:M=N.getBoundary().getRightCenter();break;case OG.Constants.TERMINAL_TYPE.W:M=N.getBoundary().getLeftCenter();break;case OG.Constants.TERMINAL_TYPE.S:M=N.getBoundary().getLowerCenter();break;case OG.Constants.TERMINAL_TYPE.N:M=N.getBoundary().getUpperCenter();break}if(M){E=[M.x,M.y]}}break;case OG.Constants.EDGE_TYPE.STRAIGHT:if(N){M=N.getBoundary().getCentroid();if(B===true){I=[M.x,M.y]}else{J=[M.x,M.y]}L=N.intersectToLine([I,J])}else{L=D.shape.geom.intersectToLine([I,J])}E=B?I:J;H="c";for(C=0;C<L.length;C++){y=L[C].distance(B?J:I);if(y<K){K=y;E=[L[C].x,L[C].y];H="c"}}break;default:break}return{position:E,direction:H}};this.clone=function(z){var y=x(OG.Util.isElement(z)?z.id:z),A;A=y.clone();p(A);k.node.appendChild(A.node);return A.node};this.getElementById=function(z){var y=x(z);return y?y.node:null};this.getElementsByType=function(A,y){var z=this.getRootGroup();if(A&&y){return $(z).find("[_type=SHAPE][_shape="+A+"][_shape!="+y+"]")}else{if(A){return $(z).find("[_type=SHAPE][_shape="+A+"]")}else{if(y){return $(z).find("[_type=SHAPE][_shape!="+y+"]")}else{return $(z).find("[_type=SHAPE]")}}}};this.getBBox=function(z){var y=x(OG.Util.isElement(z)?z.id:z);return y.getBBox()};this.getRootBBox=function(){var B=q.canvas.parentNode,C=OG.Util.isFirefox()?q.canvas.width.baseVal.value:q.canvas.scrollWidth,A=OG.Util.isFirefox()?q.canvas.height.baseVal.value:q.canvas.scrollHeight,z=B.offsetLeft,D=B.offsetTop;return{width:C,height:A,x:z,y:D,x2:z+C,y2:D+A}};this.getRealRootBBox=function(){var D=Number.MAX_VALUE,B=Number.MAX_VALUE,A=Number.MIN_VALUE,y=Number.MIN_VALUE,C=this.getElementsByType(),G,H,z,F,E,I={width:0,height:0,x:0,y:0,x2:0,y2:0};for(E=0;E<C.length;E++){G=C[E].shape;if(G&&G.geom){H=G.geom.getBoundary();z=H.getUpperLeft();F=H.getLowerRight();D=D>z.x?z.x:D;B=B>z.y?z.y:B;A=A<F.x?F.x:A;y=y<F.y?F.y:y;I={width:A-D,height:y-B,x:D,y:B,x2:A,y2:y}}}return I};this.getContainer=function(){return q.canvas.parentNode};this.isSVG=function(){return Raphael.svg};this.isVML=function(){return Raphael.vml};this.getPrevEdges=function(A){var C=$(A).attr("_fromedge"),y=[],D,B,z;if(C){D=C.split(",");for(z=0;z<D.length;z++){B=this.getElementById(D[z]);if(B){y.push(B)}}}return y};this.getNextEdges=function(A){var D=$(A).attr("_toedge"),y=[],C,B,z;if(D){C=D.split(",");for(z=0;z<C.length;z++){B=this.getElementById(C[z]);if(B){y.push(B)}}}return y};this.getPrevShapes=function(C){var A=this.getPrevEdges(C),y=[],D,z,B;for(B=0;B<A.length;B++){D=$(A[B]).attr("_from");if(D){D=D.substring(0,D.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP));z=this.getElementById(D);if(z){y.push(z)}}}return y};this.getPrevShapeIds=function(B){var z=this.getPrevEdges(B),y=[],C,A;for(A=0;A<z.length;A++){C=$(z[A]).attr("_from");if(C){C=C.substring(0,C.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP));y.push(C)}}return y};this.getNextShapes=function(C){var D=this.getNextEdges(C),y=[],z,A,B;for(B=0;B<D.length;B++){z=$(D[B]).attr("_to");if(z){z=z.substring(0,z.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP));A=this.getElementById(z);if(A){y.push(A)}}}return y};this.getNextShapeIds=function(B){var C=this.getNextEdges(B),y=[],z,A;for(A=0;A<C.length;A++){z=$(C[A]).attr("_to");if(z){z=z.substring(0,z.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP));y.push(z)}}return y}};OG.renderer.RaphaelRenderer.prototype=new OG.renderer.IRenderer();OG.renderer.RaphaelRenderer.prototype.constructor=OG.renderer.RaphaelRenderer;OG.RaphaelRenderer=OG.renderer.RaphaelRenderer;OG.handler.EventHandler=function(J){var B=this,h=J,k,v,L,A,e,U=function(Y){return parseInt(Y,10)},N=function(Z,Y){return OG.Constants.DRAG_GRIDABLE?OG.Util.roundGrid(Z,Y):Z},i=function(Y){var Z=OG.Util.isElement(Y)?Y.id:Y;return h.getElementById(Z.substring(0,Z.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP)))},Q=function(Y,ag){var ae,ac,af,Z,ad=false,ab=false,aa;ae=$(Y).attr("_from");ac=$(Y).attr("_to");if(ae){af=i(ae)}if(ac){Z=i(ac)}for(aa=0;aa<ag.length;aa++){if(af&&ag[aa].id===af.id){ad=true}if(Z&&ag[aa].id===Z.id){ab=true}}return{none:!ad&&!ab,all:ad&&ab,any:ad||ab,either:(ad&&!ab)||(!ad&&ab),attrEither:(ae&&!ac)||(!ae&&ac)}},n=function(Z){var Y=h.getContainer();return{x:(Z.pageX-$(Y).offset().left+Y.scrollLeft)/OG.Constants.SCALE,y:(Z.pageY-$(Y).offset().top+Y.scrollTop)/OG.Constants.SCALE}},R=function(){var aa=[],Z,Y=[];$(h.getRootElement()).find("[id$="+OG.Constants.GUIDE_SUFFIX.BBOX+"]").each(function(ab,ac){if(ac.id){Z=h.clone(ac);h.setAttr(Z,OG.Constants.DEFAULT_STYLE.GUIDE_SHADOW);aa.push({id:ac.id.replace(OG.Constants.GUIDE_SUFFIX.BBOX,""),box:Z})}});$.each(aa,function(ac,ad){var ae=h.getElementById(ad.id),ab;if($(ae).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){ab=Q(ae,aa);if(ab.all||ab.none||(ab.either&&ab.attrEither)){Y.push(ad)}else{h.remove(ad.box);h.removeGuide(ae)}}});$.each(aa,function(ab,ac){var ad=h.getElementById(ac.id);if($(ad).attr("_shape")!==OG.Constants.SHAPE_TYPE.EDGE){Y.push(ac)}});return Y},p=function(ac,Z,Y){var ab=[],aa=[];$.each(ac,function(ad,ae){var af=h.getElementById(ae.id);if($(af).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){ab.push(ae.id)}});$.each(ac,function(ad,ae){var af=h.getElementById(ae.id);h.remove(ae.box);h.move(af,[Z,Y],ab);h.drawGuide(af);if($(af).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){if(Q(af,ac).none){h.disconnect(af)}}aa.push(af)});return aa},M=function(){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape=EDGE][_selected=true]").each(function(Y,Z){if(Z.id){h.removeShape(Z)}});$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Y,Z){if(Z.id){h.removeShape(Z)}})},s=function(Z){if($(Z.parentNode).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){var Y=h.drawGuide(Z);if(Y){k(Z,Y,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.removeTerminal(Z)}}},T=function(){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"]").each(function(Y,Z){s(Z)})},z=function(){var Y=h.getRootGroup(),Z=[];$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(aa,ab){Z.push(ab)});$(Y).data("copied",Z)},m=function(){z();M()},G=function(){var Z=h.getRootGroup(),Y=$(Z).data("copied"),aa=[];if(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(ab,ac){if(ac.id){h.removeGuide(ac)}});$.each(Y,function(ab,ae){var ag=ae.shape.geom.getBoundary(),ad,af,ac;ad=ae.shape.clone();if($(ae).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){ad.geom=new OG.PolyLine(ae.shape.geom.getVertices());ad.geom.style=ae.shape.geom.style;ad.geom.move(OG.Constants.COPY_PASTE_PADDING,OG.Constants.COPY_PASTE_PADDING);af=h.drawShape(null,ad,null,ae.shapeStyle)}else{af=h.drawShape([ag.getCentroid().x+OG.Constants.COPY_PASTE_PADDING,ag.getCentroid().y+OG.Constants.COPY_PASTE_PADDING],ad,[ag.getWidth(),ag.getHeight()],ae.shapeStyle)}af.data=ae.data;ac=h.drawGuide(af);B.setClickSelectable(af,OG.Constants.SELECTABLE);B.setMovable(af,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);k(af,ac,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);if(OG.Constants.GROUP_DROPABLE){B.enableDragAndDropGroup(af)}if(OG.Constants.GROUP_COLLAPSIBLE){B.enableCollapse(af)}if($(af).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){if(OG.Constants.CONNECTABLE){B.enableConnect(af)}if(OG.Constants.LABEL_EDITABLE){B.enableEditLabel(af)}}A(ae,af);aa.push(af)});$(Z).data("copied",aa)}},F=function(){z();G()},S=function(){var Z=h.group($(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]")),Y;if(Z){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(aa,ab){h.removeGuide(ab)});Y=h.drawGuide(Z);if(Y){B.setClickSelectable(Z,OG.Constants.SELECTABLE);B.setMovable(Z,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);k(Z,Y,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);if(OG.Constants.GROUP_DROPABLE){B.enableDragAndDropGroup(Z)}h.removeAllTerminal();h.toFront(Y.group)}}},o=function(){var Z=h.ungroup($(h.getRootElement()).find("[_shape="+OG.Constants.SHAPE_TYPE.GROUP+"][_selected=true]")),Y;$.each(Z,function(aa,ab){Y=h.drawGuide(ab);if(Y){h.removeAllTerminal();h.toFront(Y.group)}})},I=function(Z){var Y;$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape="+OG.Constants.SHAPE_TYPE.EDGE+"][_selected=true]").each(function(aa,ab){h.removeGuide(ab)});$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(aa,ab){if(ab.shape&&ab.shape.TYPE!==OG.Constants.SHAPE_TYPE.EDGE&&ab.shape.TYPE!==OG.Constants.SHAPE_TYPE.GROUP){h.rotate(ab,Z);h.removeGuide(ab);Y=h.drawGuide(ab);k(ab,Y,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.toFront(Y.group)}})},r=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"stroke-width":Y})})},l=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{stroke:Y})})},D=function(Z){var Y;$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape="+OG.Constants.SHAPE_TYPE.EDGE+"][_selected=true]").each(function(aa,ab){OG.Util.apply(ab.shape.geom.style.map,{"edge-type":Z});ab.shapeStyle=ab.shapeStyle||{};OG.Util.apply(ab.shapeStyle,{"edge-type":Z});h.redrawEdge(ab);h.removeGuide(ab);Y=h.drawGuide(ab);k(ab,Y,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.toFront(Y.group)})},u=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"stroke-dasharray":Y})})},E=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"arrow-start":Y})})},O=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"arrow-end":Y})})},g=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{fill:Y,"fill-opacity":1})})},x=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"fill-opacity":Y})})},H=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"font-family":Y})})},d=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"font-size":Y})})},P=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"font-color":Y})})},b=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"font-weight":Y})})},W=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"font-style":Y})})},a=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"text-decoration":Y})})},X=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"label-direction":Y})})},c=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"label-angle":Y})})},V=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){if(Y==="top"){h.setShapeStyle(aa,{"label-position":Y,"text-anchor":"middle","vertical-align":"bottom"})}else{if(Y==="bottom"){h.setShapeStyle(aa,{"label-position":Y,"text-anchor":"middle","vertical-align":"top"})}else{if(Y==="left"){h.setShapeStyle(aa,{"label-position":Y,"text-anchor":"end","vertical-align":"center"})}else{if(Y==="right"){h.setShapeStyle(aa,{"label-position":Y,"text-anchor":"start","vertical-align":"center"})}else{if(Y==="center"){h.setShapeStyle(aa,{"label-position":Y,"text-anchor":"middle","vertical-align":"center"})}}}}}})},f=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"vertical-align":Y})})},w=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.setShapeStyle(aa,{"text-anchor":Y})})},y=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(Z,aa){h.drawLabel(aa,Y)})},q=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape="+OG.Constants.SHAPE_TYPE.EDGE+"][_selected=true]").each(function(Z,aa){h.drawEdgeLabel(aa,Y,"FROM")})},K=function(Y){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_shape="+OG.Constants.SHAPE_TYPE.EDGE+"][_selected=true]").each(function(Z,aa){h.drawEdgeLabel(aa,Y,"TO")})},C=function(){if(OG.Constants.SCALE+OG.Constants.SCALE*0.1<=OG.Constants.SCALE_MAX){h.setScale(OG.Constants.SCALE+OG.Constants.SCALE*0.1)}},t=function(){if(OG.Constants.SCALE-OG.Constants.SCALE*0.1>=OG.Constants.SCALE_MIN){h.setScale(OG.Constants.SCALE-OG.Constants.SCALE*0.1)}},j=function(){var Y=h.getContainer();h.fitCanvasSize([Y.clientWidth,Y.clientHeight],true)};k=function(aa,Y,ab){var Z=h.getRootGroup();if(!aa||!Y){return}if(ab){if(($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.GEOM&&OG.Constants.RESIZABLE_GEOM)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.TEXT&&OG.Constants.RESIZABLE_TEXT)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.HTML&&OG.Constants.RESIZABLE_HTML)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.IMAGE&&OG.Constants.RESIZABLE_IMAGE)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE&&OG.Constants.RESIZABLE_EDGE)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.GROUP&&OG.Constants.RESIZABLE_GROUP)){if($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){$(Y.from).draggable({start:function(ai){var ah,af,ac={},ad=$(aa).attr("_to"),aj,ae,ag;ac=OG.Util.apply(ac,OG.Constants.DEFAULT_STYLE.EDGE_SHADOW,aa.shape.geom.style.map);ah=ac["edge-type"].toLowerCase()===OG.Constants.EDGE_TYPE.BEZIER;af=ah?aa.shape.geom.getControlPoints():aa.shape.geom.getVertices();ag=h.drawEdge(ah?new OG.BezierCurve(af):new OG.PolyLine(af),ac);ae=[af[af.length-1].x,af[af.length-1].y];if(ad){aj=i(ad);h.drawTerminal(aj);ae=h.getElementById(ad)}$(Z).data("to_terminal",ae);$(Z).data("edge",ag);$(Z).data("dragged_guide","from");h.removeRubberBand(h.getRootElement());$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(al,ak){if(ak.id&&$(ak).attr("_shape")!==OG.Constants.SHAPE_TYPE.EDGE){h.removeGuide(ak)}})},drag:function(ac){var ag=n(ac),ae=$(Z).data("edge"),al=$(Z).data("edge_terminal"),aq=$(Z).data("to_terminal"),am=al?[al.terminal.position.x,al.terminal.position.y]:[ag.x,ag.y],ai=OG.Util.isElement(aq)?[aq.terminal.position.x,aq.terminal.position.y]:aq,an=al?al.terminal.direction.toLowerCase():"c",aj=OG.Util.isElement(aq)?aq.terminal.direction.toLowerCase():"c",ao=al?i(al):null,ah=OG.Util.isElement(aq)?i(aq):null,ad,ap,af,ak;$(this).css({position:"",left:"",top:""});ad=am;ap=ai;if(ao&&an==="c"){af=h.intersectionEdge(ae.geom.style.get("edge-type"),ao,[ad[0],ad[1]],[ap[0],ap[1]],true);am=af.position;an=af.direction}if(ah&&aj==="c"){af=h.intersectionEdge(ae.geom.style.get("edge-type"),ah,[ad[0],ad[1]],[ap[0],ap[1]],false);ai=af.position;aj=af.direction}ak=ao&&ah&&ao.id===ah.id;if(ak){am=ai=ao.shape.geom.getBoundary().getRightCenter()}if(!ak||OG.Constants.SELF_CONNECTABLE){h.drawEdge(new OG.Line(am,ai),OG.Util.apply(ae.geom.style.map,{"edge-direction":an+" "+aj}),ae.id,ak)}},stop:function(ag){var aj=n(ag),ai=$(Z).data("edge_terminal")||[aj.x,aj.y],ac=$(Z).data("to_terminal"),ae=OG.Util.isElement(ai)?i(ai):null,ah=OG.Util.isElement(ac)?i(ac):null,af=$(Z).data("edge"),ad;$(this).css({position:"absolute",left:"0px",top:"0px"});$(Z).removeData("to_terminal");$(Z).removeData("edge");$(Z).removeData("edge_terminal");$(Z).removeData("dragged_guide");h.remove(af);h.removeGuide(aa);if(ae){h.remove(ae.id+OG.Constants.DROP_OVER_BBOX_SUFFIX)}ad=ae&&ah&&ae.id===ah.id;if(!ad||OG.Constants.SELF_CONNECTABLE){aa=h.connect(ai,ac,aa,aa.shape.geom.style);if(aa){Y=h.drawGuide(aa);if(aa&&Y){k(aa,Y,true);h.toFront(Y.group)}}}}});$(Y.to).draggable({start:function(ai){var ah,ae,ad={},ac=$(aa).attr("_from"),af,aj,ag;ad=OG.Util.apply(ad,OG.Constants.DEFAULT_STYLE.EDGE_SHADOW,aa.shape.geom.style.map);ah=ad["edge-type"].toLowerCase()===OG.Constants.EDGE_TYPE.BEZIER;ae=ah?aa.shape.geom.getControlPoints():aa.shape.geom.getVertices();ag=h.drawEdge(ah?new OG.BezierCurve(ae):new OG.PolyLine(ae),ad);aj=[ae[0].x,ae[0].y];if(ac){af=i(ac);h.drawTerminal(af);aj=h.getElementById(ac)}$(Z).data("from_terminal",aj);$(Z).data("edge",ag);$(Z).data("dragged_guide","to");h.removeRubberBand(h.getRootElement());$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(al,ak){if(ak.id&&$(ak).attr("_shape")!==OG.Constants.SHAPE_TYPE.EDGE){h.removeGuide(ak)}})},drag:function(ac){var ag=n(ac),ae=$(Z).data("edge"),al=$(Z).data("from_terminal"),aq=$(Z).data("edge_terminal"),am=OG.Util.isElement(al)?[al.terminal.position.x,al.terminal.position.y]:al,ai=aq?[aq.terminal.position.x,aq.terminal.position.y]:[ag.x,ag.y],an=OG.Util.isElement(al)?al.terminal.direction.toLowerCase():"c",aj=aq?aq.terminal.direction.toLowerCase():"c",ao=OG.Util.isElement(al)?i(al):null,ah=aq?i(aq):null,ad,ap,af,ak;$(this).css({position:"",left:"",top:""});ad=am;ap=ai;if(ao&&an==="c"){af=h.intersectionEdge(ae.geom.style.get("edge-type"),ao,[ad[0],ad[1]],[ap[0],ap[1]],true);am=af.position;an=af.direction}if(ah&&aj==="c"){af=h.intersectionEdge(ae.geom.style.get("edge-type"),ah,[ad[0],ad[1]],[ap[0],ap[1]],false);ai=af.position;aj=af.direction}ak=(ao!==null)&&(ah!==null)&&ao.id===ah.id;if(ak){am=ai=ah.shape.geom.getBoundary().getRightCenter()}if(!ak||OG.Constants.SELF_CONNECTABLE){h.drawEdge(new OG.Line(am,ai),OG.Util.apply(ae.geom.style.map,{"edge-direction":an+" "+aj}),ae.id,ak)}},stop:function(ag){var aj=n(ag),ai=$(Z).data("from_terminal"),ac=$(Z).data("edge_terminal")||[aj.x,aj.y],ae=OG.Util.isElement(ai)?i(ai):null,ah=OG.Util.isElement(ac)?i(ac):null,af=$(Z).data("edge"),ad;$(this).css({position:"absolute",left:"0px",top:"0px"});$(Z).removeData("from_terminal");$(Z).removeData("edge");$(Z).removeData("edge_terminal");$(Z).removeData("dragged_guide");h.remove(af);h.removeGuide(aa);if(ah){h.remove(ah.id+OG.Constants.DROP_OVER_BBOX_SUFFIX)}ad=ae&&ah&&ae.id===ah.id;if(!ad||OG.Constants.SELF_CONNECTABLE){aa=h.connect(ai,ac,aa,aa.shape.geom.style);if(aa){Y=h.drawGuide(aa);if(Y){k(aa,Y,true);h.toFront(Y.group)}}}}});$.each(Y.controls,function(ac,ad){$(ad).draggable({start:function(ae){var af=n(ae);$(this).data("start",{x:af.x,y:af.y});$(this).data("offset",{x:af.x-U(h.getAttr(ad,"x")),y:af.y-U(h.getAttr(ad,"y"))});h.remove(Y.bBox);h.removeRubberBand(h.getRootElement())},drag:function(af){var ah=n(af),ag=$(this).data("start"),ai=$(this).data("offset"),ae=ah.x-ai.x,am=ah.y-ai.y,ak=aa.shape.geom.getVertices(),al=ad.id.indexOf(OG.Constants.GUIDE_SUFFIX.CTL_H)>=0,aj=al?parseInt(ad.id.replace(aa.id+OG.Constants.GUIDE_SUFFIX.CTL_H,""),10):parseInt(ad.id.replace(aa.id+OG.Constants.GUIDE_SUFFIX.CTL_V,""),10);$(this).css({position:"",left:"",top:""});if(al){ak[aj].x=ae;ak[aj+1].x=ae}else{ak[aj].y=am;ak[aj+1].y=am}aa=h.drawEdge(new OG.PolyLine(ak),aa.shape.geom.style,aa.id);h.drawGuide(aa);h.removeAllTerminal();h.drawLabel(aa);h.drawEdgeLabel(aa,null,"FROM");h.drawEdgeLabel(aa,null,"TO")},stop:function(af){var ah=n(af),ag=$(this).data("start"),ai=$(this).data("offset"),ae=ah.x-ai.x,am=ah.y-ai.y,ak=aa.shape.geom.getVertices(),al=ad.id.indexOf(OG.Constants.GUIDE_SUFFIX.CTL_H)>=0,aj=al?parseInt(ad.id.replace(aa.id+OG.Constants.GUIDE_SUFFIX.CTL_H,""),10):parseInt(ad.id.replace(aa.id+OG.Constants.GUIDE_SUFFIX.CTL_V,""),10);$(this).css({position:"absolute",left:"0px",top:"0px"});if(al){ak[aj].x=ae;ak[aj+1].x=ae}else{ak[aj].y=am;ak[aj+1].y=am}aa=h.drawEdge(new OG.PolyLine(ak),aa.shape.geom.style,aa.id);h.drawGuide(aa);h.drawLabel(aa);h.drawEdgeLabel(aa,null,"FROM");h.drawEdgeLabel(aa,null,"TO")}})})}else{$(Y.rc).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.rc,"x")),y:ad.y-U(h.getAttr(Y.rc,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ad){var ae=n(ad),ah=$(this).data("start"),ag=$(this).data("offset"),af=N(ae.x-ag.x),ac=N(af-U(h.getAttr(Y.lc,"x")));$(this).css({position:"",left:"",top:""});if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.rc,{x:af});h.setAttr(Y.ur,{x:af});h.setAttr(Y.lr,{x:af});h.setAttr(Y.uc,{x:OG.Util.round((U(h.getAttr(Y.lc,"x"))+af)/2)});h.setAttr(Y.lwc,{x:OG.Util.round((U(h.getAttr(Y.lc,"x"))+af)/2)});h.setAttr(Y.bBox,{width:ac})}h.removeAllTerminal()},stop:function(ad){var ae=n(ad),af=$(this).data("start"),ac=ae.x-af.x;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getWidth()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getWidth()}h.resize(aa,[0,0,0,N(ac)]);h.drawGuide(aa)}}});$(Y.lwc).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.lwc,"x")),y:ad.y-U(h.getAttr(Y.lwc,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ad){var ae=n(ad),ah=$(this).data("start"),ag=$(this).data("offset"),af=N(ae.y-ag.y),ac=N(af-U(h.getAttr(Y.uc,"y")));$(this).css({position:"",left:"",top:""});if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.lwc,{y:af});h.setAttr(Y.ll,{y:af});h.setAttr(Y.lr,{y:af});h.setAttr(Y.lc,{y:OG.Util.round((U(h.getAttr(Y.uc,"y"))+af)/2)});h.setAttr(Y.rc,{y:OG.Util.round((U(h.getAttr(Y.uc,"y"))+af)/2)});h.setAttr(Y.bBox,{height:ac})}h.removeAllTerminal()},stop:function(ad){var ae=n(ad),af=$(this).data("start"),ac=ae.y-af.y;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getHeight()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getHeight()}h.resize(aa,[0,N(ac),0,0]);h.drawGuide(aa)}}});$(Y.lr).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.lr,"x")),y:ad.y-U(h.getAttr(Y.lr,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ae){var af=n(ae),aj=$(this).data("start"),ai=$(this).data("offset"),ah=N(af.x-ai.x),ad=N(ah-U(h.getAttr(Y.lc,"x"))),ag=N(af.y-ai.y),ac=N(ag-U(h.getAttr(Y.uc,"y")));$(this).css({position:"",left:"",top:""});if(ad>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.rc,{x:ah});h.setAttr(Y.ur,{x:ah});h.setAttr(Y.lr,{x:ah});h.setAttr(Y.uc,{x:OG.Util.round((U(h.getAttr(Y.lc,"x"))+ah)/2)});h.setAttr(Y.lwc,{x:OG.Util.round((U(h.getAttr(Y.lc,"x"))+ah)/2)});h.setAttr(Y.bBox,{width:ad})}if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.lwc,{y:ag});h.setAttr(Y.ll,{y:ag});h.setAttr(Y.lr,{y:ag});h.setAttr(Y.lc,{y:OG.Util.round((U(h.getAttr(Y.uc,"y"))+ag)/2)});h.setAttr(Y.rc,{y:OG.Util.round((U(h.getAttr(Y.uc,"y"))+ag)/2)});h.setAttr(Y.bBox,{height:ac})}h.removeAllTerminal()},stop:function(ae){var af=n(ae),ag=$(this).data("start"),ad=af.x-ag.x,ac=af.y-ag.y;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getWidth()+ad<OG.Constants.GUIDE_MIN_SIZE){ad=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getWidth()}if(aa.shape.geom.getBoundary().getHeight()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getHeight()}h.resize(aa,[0,N(ac),0,N(ad)]);h.drawGuide(aa)}h.removeAllTerminal()}});$(Y.lc).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.lc,"x")),y:ad.y-U(h.getAttr(Y.lc,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ad){var ae=n(ad),ah=$(this).data("start"),ag=$(this).data("offset"),af=N(ae.x-ag.x),ac=N(U(h.getAttr(Y.rc,"x"))-af);$(this).css({position:"",left:"",top:""});if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.lc,{x:af});h.setAttr(Y.ul,{x:af});h.setAttr(Y.ll,{x:af});h.setAttr(Y.uc,{x:OG.Util.round((U(h.getAttr(Y.rc,"x"))+af)/2)});h.setAttr(Y.lwc,{x:OG.Util.round((U(h.getAttr(Y.rc,"x"))+af)/2)});h.setAttr(Y.bBox,{x:OG.Util.round(af+U(h.getAttr(Y.lc,"width"))/2),width:ac})}h.removeAllTerminal()},stop:function(ad){var ae=n(ad),af=$(this).data("start"),ac=af.x-ae.x;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getWidth()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getWidth()}h.resize(aa,[0,0,N(ac),0]);h.drawGuide(aa)}}});$(Y.ll).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.ll,"x")),y:ad.y-U(h.getAttr(Y.ll,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ae){var af=n(ae),aj=$(this).data("start"),ai=$(this).data("offset"),ah=N(af.x-ai.x),ag=N(af.y-ai.y),ad=N(U(h.getAttr(Y.rc,"x"))-ah),ac=N(ag-U(h.getAttr(Y.uc,"y")));$(this).css({position:"",left:"",top:""});if(ad>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.lc,{x:ah});h.setAttr(Y.ul,{x:ah});h.setAttr(Y.ll,{x:ah});h.setAttr(Y.uc,{x:OG.Util.round((U(h.getAttr(Y.rc,"x"))+ah)/2)});h.setAttr(Y.lwc,{x:OG.Util.round((U(h.getAttr(Y.rc,"x"))+ah)/2)});h.setAttr(Y.bBox,{x:OG.Util.round(ah+U(h.getAttr(Y.lc,"width"))/2),width:ad})}if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.lwc,{y:ag});h.setAttr(Y.ll,{y:ag});h.setAttr(Y.lr,{y:ag});h.setAttr(Y.lc,{y:OG.Util.round((U(h.getAttr(Y.uc,"y"))+ag)/2)});h.setAttr(Y.rc,{y:OG.Util.round((U(h.getAttr(Y.uc,"y"))+ag)/2)});h.setAttr(Y.bBox,{height:ac})}h.removeAllTerminal()},stop:function(ae){var af=n(ae),ag=$(this).data("start"),ad=ag.x-af.x,ac=af.y-ag.y;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getWidth()+ad<OG.Constants.GUIDE_MIN_SIZE){ad=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getWidth()}if(aa.shape.geom.getBoundary().getHeight()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getHeight()}h.resize(aa,[0,N(ac),N(ad),0]);h.drawGuide(aa)}}});$(Y.uc).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.uc,"x")),y:ad.y-U(h.getAttr(Y.uc,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ad){var ae=n(ad),ah=$(this).data("start"),ag=$(this).data("offset"),af=N(ae.y-ag.y),ac=N(U(h.getAttr(Y.lwc,"y"))-af);$(this).css({position:"",left:"",top:""});if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.uc,{y:af});h.setAttr(Y.ul,{y:af});h.setAttr(Y.ur,{y:af});h.setAttr(Y.lc,{y:OG.Util.round((U(h.getAttr(Y.lwc,"y"))+af)/2)});h.setAttr(Y.rc,{y:OG.Util.round((U(h.getAttr(Y.lwc,"y"))+af)/2)});h.setAttr(Y.bBox,{y:OG.Util.round(af+U(h.getAttr(Y.uc,"width"))/2),height:ac})}h.removeAllTerminal()},stop:function(ad){var ae=n(ad),af=$(this).data("start"),ac=af.y-ae.y;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getHeight()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getHeight()}h.resize(aa,[N(ac),0,0,0]);h.drawGuide(aa)}}});$(Y.ul).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.ul,"x")),y:ad.y-U(h.getAttr(Y.ul,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ae){var af=n(ae),aj=$(this).data("start"),ai=$(this).data("offset"),ah=N(af.x-ai.x),ag=N(af.y-ai.y),ad=N(U(h.getAttr(Y.rc,"x"))-ah),ac=N(U(h.getAttr(Y.lwc,"y"))-ag);$(this).css({position:"",left:"",top:""});if(ad>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.lc,{x:ah});h.setAttr(Y.ul,{x:ah});h.setAttr(Y.ll,{x:ah});h.setAttr(Y.uc,{x:OG.Util.round((U(h.getAttr(Y.rc,"x"))+ah)/2)});h.setAttr(Y.lwc,{x:OG.Util.round((U(h.getAttr(Y.rc,"x"))+ah)/2)});h.setAttr(Y.bBox,{x:OG.Util.round(ah+U(h.getAttr(Y.lc,"width"))/2),width:ad})}if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.uc,{y:ag});h.setAttr(Y.ul,{y:ag});h.setAttr(Y.ur,{y:ag});h.setAttr(Y.lc,{y:OG.Util.round((U(h.getAttr(Y.lwc,"y"))+ag)/2)});h.setAttr(Y.rc,{y:OG.Util.round((U(h.getAttr(Y.lwc,"y"))+ag)/2)});h.setAttr(Y.bBox,{y:OG.Util.round(ag+U(h.getAttr(Y.uc,"height"))/2),height:ac})}h.removeAllTerminal()},stop:function(ae){var af=n(ae),ag=$(this).data("start"),ad=ag.x-af.x,ac=ag.y-af.y;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getWidth()+ad<OG.Constants.GUIDE_MIN_SIZE){ad=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getWidth()}if(aa.shape.geom.getBoundary().getHeight()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getHeight()}h.resize(aa,[N(ac),0,N(ad),0]);h.drawGuide(aa)}}});$(Y.ur).draggable({start:function(ac){var ad=n(ac);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(Y.ur,"x")),y:ad.y-U(h.getAttr(Y.ur,"y"))});h.removeRubberBand(h.getRootElement())},drag:function(ae){var af=n(ae),aj=$(this).data("start"),ai=$(this).data("offset"),ah=N(af.x-ai.x),ag=N(af.y-ai.y),ad=N(ah-U(h.getAttr(Y.lc,"x"))),ac=N(U(h.getAttr(Y.lwc,"y"))-ag);$(this).css({position:"",left:"",top:""});if(ad>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.rc,{x:ah});h.setAttr(Y.ur,{x:ah});h.setAttr(Y.lr,{x:ah});h.setAttr(Y.uc,{x:OG.Util.round((U(h.getAttr(Y.lc,"x"))+ah)/2)});h.setAttr(Y.lwc,{x:OG.Util.round((U(h.getAttr(Y.lc,"x"))+ah)/2)});h.setAttr(Y.bBox,{width:ad})}if(ac>=OG.Constants.GUIDE_MIN_SIZE){h.setAttr(Y.uc,{y:ag});h.setAttr(Y.ul,{y:ag});h.setAttr(Y.ur,{y:ag});h.setAttr(Y.lc,{y:OG.Util.round((U(h.getAttr(Y.lwc,"y"))+ag)/2)});h.setAttr(Y.rc,{y:OG.Util.round((U(h.getAttr(Y.lwc,"y"))+ag)/2)});h.setAttr(Y.bBox,{y:OG.Util.round(ag+U(h.getAttr(Y.uc,"width"))/2),height:ac})}h.removeAllTerminal()},stop:function(ae){var af=n(ae),ag=$(this).data("start"),ad=af.x-ag.x,ac=ag.y-af.y;$(this).css({position:"absolute",left:"0px",top:"0px"});if(aa&&aa.shape.geom){if(aa.shape.geom.getBoundary().getWidth()+ad<OG.Constants.GUIDE_MIN_SIZE){ad=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getWidth()}if(aa.shape.geom.getBoundary().getHeight()+ac<OG.Constants.GUIDE_MIN_SIZE){ac=OG.Constants.GUIDE_MIN_SIZE-aa.shape.geom.getBoundary().getHeight()}h.resize(aa,[N(ac),0,0,N(ad)]);h.drawGuide(aa)}}})}}}else{if($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){h.setAttr(Y.from,{cursor:"default"});h.setAttr(Y.to,{cursor:"default"});$.each(Y.controls,function(ac,ad){h.setAttr(ad,{cursor:"default"})})}else{h.setAttr(Y.ul,{cursor:"default"});h.setAttr(Y.ur,{cursor:"default"});h.setAttr(Y.ll,{cursor:"default"});h.setAttr(Y.lr,{cursor:"default"});h.setAttr(Y.lc,{cursor:"default"});h.setAttr(Y.uc,{cursor:"default"});h.setAttr(Y.rc,{cursor:"default"});h.setAttr(Y.lwc,{cursor:"default"})}}};v=function(Z){var Y=Z.parentNode;if(Y){if(v(Y)){return true}if($(Y).attr("_type")===OG.Constants.NODE_TYPE.SHAPE&&$(Y).attr("_selected")==="true"){return true}}return false};L=function(Z){var Y=Z.childNodes;$.each(Y,function(aa,ab){if($(ab).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){if(ab.childNodes.length>0){L(ab)}if($(ab).attr("_selected")==="true"){h.removeGuide(ab);$(ab).draggable("destroy")}}})};A=function(Z,aa){var Y=Z.childNodes;$.each(Y,function(ab,ae){if($(ae).attr("_type")===OG.Constants.NODE_TYPE.SHAPE){var ag=ae.shape.geom.getBoundary(),ad,af,ac;ad=ae.shape.clone();if($(ae).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){ad.geom=new OG.PolyLine(ae.shape.geom.getVertices());ad.geom.style=ae.shape.geom.style;ad.geom.move(OG.Constants.COPY_PASTE_PADDING,OG.Constants.COPY_PASTE_PADDING);af=h.drawShape(null,ad,null,ae.shapeStyle)}else{af=h.drawShape([ag.getCentroid().x+OG.Constants.COPY_PASTE_PADDING,ag.getCentroid().y+OG.Constants.COPY_PASTE_PADDING],ad,[ag.getWidth(),ag.getHeight()],ae.shapeStyle)}af.data=ae.data;aa.appendChild(af);B.setClickSelectable(af,OG.Constants.SELECTABLE);B.setMovable(af,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);if(OG.Constants.GROUP_DROPABLE){B.enableDragAndDropGroup(af)}if(OG.Constants.GROUP_COLLAPSIBLE){B.enableCollapse(af)}if($(af).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){if(OG.Constants.CONNECTABLE){B.enableConnect(af)}if(OG.Constants.LABEL_EDITABLE){B.enableEditLabel(af)}}if(ae.childNodes.length>0){A(ae,af)}}})};e=function(aa,Z){var Y=h.getRootBBox();if(OG.Constants.AUTO_EXTENSIONAL&&Y.width<aa*OG.Constants.SCALE){h.setCanvasSize([Y.width+OG.Constants.AUTO_EXTENSION_SIZE,Y.height])}if(OG.Constants.AUTO_EXTENSIONAL&&Y.height<Z*OG.Constants.SCALE){h.setCanvasSize([Y.width,Y.height+OG.Constants.AUTO_EXTENSION_SIZE])}};this.setResizable=k;this.deleteSelectedShape=M;this.selectShape=s;this.selectAll=T;this.copySelectedShape=z;this.cutSelectedShape=m;this.pasteSelectedShape=G;this.duplicateSelectedShape=F;this.groupSelectedShape=S;this.ungroupSelectedShape=o;this.rotateSelectedShape=I;this.setLineWidthSelectedShape=r;this.setLineColorSelectedShape=l;this.setLineTypeSelectedShape=D;this.setLineStyleSelectedShape=u;this.setArrowStartSelectedShape=E;this.setArrowEndSelectedShape=O;this.setFillColorSelectedShape=g;this.setFillOpacitySelectedShape=x;this.setFontFamilySelectedShape=H;this.setFontSizeSelectedShape=d;this.setFontColorSelectedShape=P;this.setFontWeightSelectedShape=b;this.setFontStyleSelectedShape=W;this.setTextDecorationSelectedShape=a;this.setLabelDirectionSelectedShape=X;this.setLabelAngleSelectedShape=c;this.setLabelPositionSelectedShape=V;this.setLabelVerticalSelectedShape=f;this.setLabelHorizontalSelectedShape=w;this.setLabelSelectedShape=y;this.setEdgeFromLabelSelectedShape=q;this.setEdgeToLabelSelectedShape=K;this.zoomIn=C;this.zoomOut=t;this.fitWindow=j;this.enableEditLabel=function(Y){if(($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.GEOM&&OG.Constants.LABEL_EDITABLE_GEOM)||($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.TEXT&&OG.Constants.LABEL_EDITABLE_TEXT)||($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.HTML&&OG.Constants.LABEL_EDITABLE_HTML)||($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.IMAGE&&OG.Constants.LABEL_EDITABLE_IMAGE)||($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE&&OG.Constants.LABEL_EDITABLE_EDGE)||($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.GROUP&&OG.Constants.LABEL_EDITABLE_GROUP)){$(Y).bind({dblclick:function(ac){var ad=h.getContainer(),aj=Y.shape.geom.getBoundary(),ab=aj.getUpperLeft(),an,ah=(ab.x-1)*OG.Constants.SCALE,al=(ab.y-1)*OG.Constants.SCALE,af=aj.getWidth()*OG.Constants.SCALE,am=aj.getHeight()*OG.Constants.SCALE,ag=Y.id+OG.Constants.LABEL_EDITOR_SUFFIX,aa,ae="center",ao,ai,ak=function(au){var ar,ap,av=0,at,aq;ar=au.shape.geom.getVertices();ap=au.shape.geom.getLength();for(at=0;at<ar.length-1;at++){av+=ar[at].distance(ar[at+1]);if(av>ap/2){aq=au.shape.geom.intersectCircleToLine(ar[at+1],av-ap/2,ar[at+1],ar[at]);break}}return aq[0]},Z;$(ad).append("<textarea id='"+Y.id+OG.Constants.LABEL_EDITOR_SUFFIX+"'></textarea>");aa=$("#"+ag);switch(Y.shape.geom.style.get("text-anchor")){case"start":ae="left";break;case"middle":ae="center";break;case"end":ae="right";break;default:ae="center";break}if($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.HTML){$(aa).css(OG.Util.apply(OG.Constants.DEFAULT_STYLE.LABEL_EDITOR,{left:ah,top:al,width:af,height:am,"text-align":"left",overflow:"hidden",resize:"none"}));$(aa).focus();$(aa).val(Y.shape.html);$(aa).bind({focusout:function(){Y.shape.html=this.value;if(Y.shape.html){h.redrawShape(Y);this.parentNode.removeChild(this)}else{h.removeShape(Y);this.parentNode.removeChild(this)}}})}else{if($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.TEXT){$(aa).css(OG.Util.apply(OG.Constants.DEFAULT_STYLE.LABEL_EDITOR,{left:ah,top:al,width:af,height:am,"text-align":ae,overflow:"hidden",resize:"none"}));$(aa).focus();$(aa).val(Y.shape.text);$(aa).bind({focusout:function(){Y.shape.text=this.value;if(Y.shape.text){h.redrawShape(Y);this.parentNode.removeChild(this)}else{h.removeShape(Y);this.parentNode.removeChild(this)}}})}else{if($(Y).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){if(Y.shape.label&&h.isSVG()){$(Y).children("[id$=_LABEL]").each(function(ap,aq){$(aq).find("text").each(function(at,ar){an=h.getBBox(ar);ah=an.x-10;al=an.y;af=an.width+20;am=an.height})})}else{Z=ak(Y);ah=Z.x-OG.Constants.LABEL_EDITOR_WIDTH/2;al=Z.y-OG.Constants.LABEL_EDITOR_HEIGHT/2;af=OG.Constants.LABEL_EDITOR_WIDTH;am=OG.Constants.LABEL_EDITOR_HEIGHT}$(ac.srcElement).parents("[id$=_FROMLABEL]").each(function(ap,aq){$(aq).find("text").each(function(at,ar){an=h.getBBox(ar);ah=an.x-10;al=an.y;af=an.width+20;am=an.height;ao=Y.shape.fromLabel})});$(ac.srcElement).parents("[id$=_TOLABEL]").each(function(ap,aq){$(aq).find("text").each(function(at,ar){an=h.getBBox(ar);ah=an.x-10;al=an.y;af=an.width+20;am=an.height;ai=Y.shape.toLabel})});$(aa).css(OG.Util.apply(OG.Constants.DEFAULT_STYLE.LABEL_EDITOR,{left:ah*OG.Constants.SCALE,top:al*OG.Constants.SCALE,width:af*OG.Constants.SCALE,height:am*OG.Constants.SCALE,overflow:"hidden",resize:"none"}));$(aa).focus();if(ao||ai){$(aa).val(ao?Y.shape.fromLabel:Y.shape.toLabel)}else{$(aa).val(Y.shape.label)}$(aa).bind({focusout:function(){if(ao){h.drawEdgeLabel(Y,this.value,"FROM")}else{if(ai){h.drawEdgeLabel(Y,this.value,"TO")}else{h.drawLabel(Y,this.value)}}this.parentNode.removeChild(this)}})}else{$(aa).css(OG.Util.apply(OG.Constants.DEFAULT_STYLE.LABEL_EDITOR,{left:ah,top:al,width:af,height:am,"text-align":ae,overflow:"hidden",resize:"none"}));$(aa).focus();$(aa).val(Y.shape.label);$(aa).bind({focusout:function(){h.drawLabel(Y,this.value);this.parentNode.removeChild(this)}})}}}}})}};this.enableConnect=function(Z){var aa,Y=h.getRootGroup();if(Z&&$(Z).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){$(Z).bind({mouseover:function(){aa=h.drawTerminal(Z,$(Y).data("dragged_guide")==="to"?OG.Constants.TERMINAL_TYPE.IN:OG.Constants.TERMINAL_TYPE.OUT);if(aa&&aa.terminal&&aa.terminal.childNodes.length>0){if($(Y).data("edge")){$.each(aa.terminal.childNodes,function(ab,ae){var af=$(Y).data("from_terminal"),ad=af&&OG.Util.isElement(af)?i(af):null,ac=Z&&ad&&Z.id===ad.id;if(ae.terminal&&ae.terminal.direction.toLowerCase()==="c"&&(($(Y).data("dragged_guide")==="to"&&ae.terminal.inout.indexOf(OG.Constants.TERMINAL_TYPE.IN)>=0)||($(Y).data("dragged_guide")==="from"&&ae.terminal.inout.indexOf(OG.Constants.TERMINAL_TYPE.OUT)>=0))&&(!ac||OG.Constants.SELF_CONNECTABLE)){h.drawDropOverGuide(Z);$(Y).data("edge_terminal",ae);return false}})}$(aa.bBox).bind({mouseout:function(){if(!$(Y).data("edge")){h.removeTerminal(Z)}}});$.each(aa.terminal.childNodes,function(ab,ac){if(ac.terminal){$(ac).bind({mouseover:function(af){var ag=$(Y).data("from_terminal"),ae=ag&&OG.Util.isElement(ag)?i(ag):null,ad=Z&&ae&&Z.id===ae.id;if((($(Y).data("dragged_guide")==="to"&&ac.terminal.inout.indexOf(OG.Constants.TERMINAL_TYPE.IN)>=0)||($(Y).data("dragged_guide")==="from"&&ac.terminal.inout.indexOf(OG.Constants.TERMINAL_TYPE.OUT)>=0)||(!$(Y).data("dragged_guide")&&ac.terminal.inout.indexOf(OG.Constants.TERMINAL_TYPE.OUT)>=0))&&(!ad||OG.Constants.SELF_CONNECTABLE)){h.setAttr(ac,OG.Constants.DEFAULT_STYLE.TERMINAL_OVER);$(Y).data("edge_terminal",ac)}},mouseout:function(){h.setAttr(ac,OG.Constants.DEFAULT_STYLE.TERMINAL);$(Y).removeData("edge_terminal")}});$(ac).draggable({start:function(af){var ad=ac.terminal.position.x,ag=ac.terminal.position.y,ae=h.drawShape(null,new OG.EdgeShape([ad,ag],[ad,ag]),null,OG.Constants.DEFAULT_STYLE.EDGE_SHADOW);$(Y).data("edge",ae);$(Y).data("from_terminal",ac);$(Y).data("dragged_guide","to");h.removeRubberBand(h.getRootElement());$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(ai,ah){if(ah.id){h.removeGuide(ah)}})},drag:function(ad){var ah=n(ad),af=$(Y).data("edge"),am=$(Y).data("from_terminal"),aq=$(Y).data("edge_terminal"),an=[am.terminal.position.x,am.terminal.position.y],aj=aq?[aq.terminal.position.x,aq.terminal.position.y]:[ah.x,ah.y],ao=am.terminal.direction.toLowerCase(),ak=aq?aq.terminal.direction.toLowerCase():"c",ai=aq?i(aq):null,ae,ap,ag,al;$(this).css({position:"",left:"",top:""});ae=an;ap=aj;if(!Z.shape.geom.getBoundary().isContains(aj)&&ao==="c"){ag=h.intersectionEdge(af.shape.geom.style.get("edge-type"),Z,[ae[0],ae[1]],[ap[0],ap[1]],true);an=ag.position;ao=ag.direction}if(ai&&ak==="c"){ag=h.intersectionEdge(af.shape.geom.style.get("edge-type"),ai,[ae[0],ae[1]],[ap[0],ap[1]],false);aj=ag.position;ak=ag.direction}al=Z&&ai&&Z.id===ai.id;if(al){an=aj=Z.shape.geom.getBoundary().getRightCenter()}if(!al||OG.Constants.SELF_CONNECTABLE){h.drawEdge(new OG.Line(an,aj),OG.Util.apply(af.shape.geom.style.map,{"edge-direction":ao+" "+ak}),af.id,al)}},stop:function(ad){var ao=n(ad),ag=$(Y).data("edge"),am=$(Y).data("from_terminal"),ap=$(Y).data("edge_terminal")||[ao.x,ao.y],ah=OG.Util.isElement(ap)?i(ap):null,af,ai,an,ak,ae,aj,al;$(this).css({position:"absolute",left:"0px",top:"0px"});if(!$(Y).data("edge_terminal")&&OG.Constants.CONNECT_CLONEABLE){af=Z.shape.geom.getBoundary();ai=h.drawShape([ao.x,ao.y],Z.shape.clone(),[af.getWidth(),af.getHeight()],Z.shapeStyle);B.setClickSelectable(ai,OG.Constants.SELECTABLE);B.setMovable(ai,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);if(OG.Constants.GROUP_DROPABLE){B.enableDragAndDropGroup(ai)}if(OG.Constants.GROUP_COLLAPSIBLE){B.enableCollapse(ai)}if($(ai).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){if(OG.Constants.CONNECTABLE){B.enableConnect(ai)}if(OG.Constants.LABEL_EDITABLE){B.enableEditLabel(ai)}}an=h.drawTerminal(ai,OG.Constants.TERMINAL_TYPE.IN);ak=an.terminal.childNodes;ap=ak[0];for(aj=0;aj<ak.length;aj++){if(ak[aj].terminal&&ak[aj].terminal.direction.toLowerCase()==="c"){ap=ak[aj];break}}}al=Z&&ah&&Z.id===ah.id;if(ap&&(OG.Util.isElement(ap)||!OG.Constants.CONNECT_REQUIRED)&&(!al||OG.Constants.SELF_CONNECTABLE)){ag=h.connect(am,ap,ag);if(ag){ae=h.drawGuide(ag);if(ag&&ae){B.setClickSelectable(ag,OG.Constants.SELECTABLE);B.setMovable(ag,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);k(ag,ae,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);if($(ag).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){if(OG.Constants.LABEL_EDITABLE){B.enableEditLabel(ag)}}h.toFront(ae.group)}}}else{h.removeShape(ag)}$(Y).removeData("edge");$(Y).removeData("from_terminal");$(Y).removeData("edge_terminal");$(Y).removeData("dragged_guide");if(ah){h.remove(ah.id+OG.Constants.DROP_OVER_BBOX_SUFFIX)}}})}})}else{h.removeTerminal(Z)}},mouseout:function(ab){if($(Z).attr("_shape")!==OG.Constants.SHAPE_TYPE.EDGE&&$(Y).data("edge")){h.remove(Z.id+OG.Constants.DROP_OVER_BBOX_SUFFIX);$(Y).removeData("edge_terminal")}}})}};this.enableDragAndDropGroup=function(aa){var Y=h.getRootGroup(),Z;if(aa&&$(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.GROUP){$(aa).bind({mouseover:function(){if($(Y).data("bBoxArray")){Z=false;$.each($(Y).data("bBoxArray"),function(ab,ac){if(aa.id===ac.id){Z=true}});if(!Z){$(Y).data("groupTarget",aa);h.drawDropOverGuide(aa)}}},mouseout:function(ab){h.remove(aa.id+OG.Constants.DROP_OVER_BBOX_SUFFIX);$(Y).removeData("groupTarget")}})}};this.enableCollapse=function(aa){var Z,Y;Y=function(ab,ac){if(ac&&ac.bBox&&ac.collapse){$(ac.collapse).bind("click",function(ad){if(ab.shape.isCollapsed===true){h.expand(ab);ac=h.drawCollapseGuide(ab);Y(ab,ac)}else{h.collapse(ab);ac=h.drawCollapseGuide(ab);Y(ab,ac)}});$(ac.bBox).bind("mouseout",function(ad){h.remove(ab.id+OG.Constants.COLLAPSE_BBOX);h.remove(ab.id+OG.Constants.COLLAPSE_SUFFIX)})}};if(aa&&$(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.GROUP){$(aa).bind({mouseover:function(){Z=h.drawCollapseGuide(this);if(Z&&Z.bBox&&Z.collapse){Y(aa,Z)}}})}};this.setMovable=function(aa,Z){var Y=h.getRootGroup();if(!aa){return}if(Z){if(($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.GEOM&&OG.Constants.MOVABLE_GEOM)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.TEXT&&OG.Constants.MOVABLE_TEXT)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.HTML&&OG.Constants.MOVABLE_HTML)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.IMAGE&&OG.Constants.MOVABLE_IMAGE)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE&&OG.Constants.MOVABLE_EDGE)||($(aa).attr("_shape")===OG.Constants.SHAPE_TYPE.GROUP&&OG.Constants.MOVABLE_GROUP)){$(aa).draggable({start:function(ac){var ad=n(ac),ab;if(h.getElementById(aa.id+OG.Constants.GUIDE_SUFFIX.GUIDE)===null){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(ae,af){if(OG.Util.isElement(af)&&af.id){h.removeGuide(af)}});h.removeAllTerminal()}h.removeGuide(aa);ab=h.drawGuide(aa);$(this).data("start",{x:ad.x,y:ad.y});$(this).data("offset",{x:ad.x-U(h.getAttr(ab.bBox,"x")),y:ad.y-U(h.getAttr(ab.bBox,"y"))});$(Y).data("bBoxArray",R());h.removeRubberBand(h.getRootElement());h.removeAllTerminal()},drag:function(ad){var ae=n(ad),ag=$(this).data("start"),af=$(Y).data("bBoxArray"),ac=N(ae.x-ag.x),ab=N(ae.y-ag.y);e(ae.x,ae.y);$(this).css({position:"",left:"",top:""});$.each(af,function(ah,ai){h.setAttr(ai.box,{transform:"t"+ac+","+ab})});h.removeAllTerminal()},stop:function(ab){var ae=n(ab),ac=$(this).data("start"),ah=$(Y).data("bBoxArray"),aj=N(ae.x-ac.x),ai=N(ae.y-ac.y),af=$(Y).data("groupTarget"),ag,ad;$(this).css({position:"",left:"",top:""});ag=p(ah,aj,ai);if(af&&OG.Util.isElement(af)){h.addToGroup(af,ag);$.each(ag,function(ak,al){h.removeGuide(al)});ad=h.drawGuide(af);k(af,ad,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.toFront(ad.group);h.remove(af.id+OG.Constants.DROP_OVER_BBOX_SUFFIX);$(Y).removeData("groupTarget")}else{h.addToGroup(Y,ag);$.each(ag,function(ak,al){h.removeGuide(al);ad=h.drawGuide(al);k(al,ad,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.toFront(ad.group)})}$(Y).removeData("bBoxArray")}});h.setAttr(aa,{cursor:"move"});OG.Util.apply(aa.shape.geom.style.map,{cursor:"move"})}}else{$(aa).draggable("destroy");h.setAttr(aa,{cursor:OG.Constants.SELECTABLE?"pointer":OG.Constants.DEFAULT_STYLE.SHAPE.cursor});OG.Util.apply(aa.shape.geom.style.map,{cursor:OG.Constants.SELECTABLE?"pointer":OG.Constants.DEFAULT_STYLE.SHAPE.cursor})}};this.setClickSelectable=function(Z,Y){if(Y){$(Z).bind("click",function(ab){var aa;$(h.getContainer()).focus();if(Z.shape){if(!ab.shiftKey&&!ab.ctrlKey){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(ac,ad){if(ad.id){h.removeGuide(ad)}})}if($(Z).attr("_selected")==="true"){if(ab.shiftKey||ab.ctrlKey){h.removeGuide(Z)}}else{L(Z);if(!v(Z)){aa=h.drawGuide(Z);if(aa){k(Z,aa,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.removeAllTerminal();h.toFront(aa.group)}}}return false}});if(OG.Constants.ENABLE_CONTEXTMENU){$(Z).bind("contextmenu",function(ab){var aa;if(Z.shape){if($(Z).attr("_selected")!=="true"){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(ac,ad){if(ad.id){h.removeGuide(ad)}});L(Z);if(!v(Z)){aa=h.drawGuide(Z);if(aa){k(Z,aa,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.removeAllTerminal();h.toFront(aa.group)}}}return true}})}if(Y&&OG.Constants.MOVABLE){h.setAttr(Z,{cursor:"move"});OG.Util.apply(Z.shape.geom.style.map,{cursor:"move"})}else{h.setAttr(Z,{cursor:"pointer"});OG.Util.apply(Z.shape.geom.style.map,{cursor:"pointer"})}}else{$(Z).click("destroy");h.setAttr(Z,{cursor:OG.Constants.DEFAULT_STYLE.SHAPE.cursor});OG.Util.apply(Z.shape.geom.style.map,{cursor:OG.Constants.DEFAULT_STYLE.SHAPE.cursor})}};this.setDragSelectable=function(Y){var Z=h.getRootElement();$(Z).bind("click",function(ab){var aa=$(this).data("dragBox");$(h.getContainer()).focus();if(!aa||(aa&&aa.width<1&&aa.height<1)){$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"][_selected=true]").each(function(ac,ad){if(OG.Util.isElement(ad)&&ad.id){h.removeGuide(ad)}});h.removeAllTerminal()}});if(Y){$(Z).bind("mousedown",function(aa){var ab=n(aa);$(this).data("dragBox_first",{x:ab.x,y:ab.y});h.drawRubberBand([ab.x,ab.y])});$(Z).bind("mousemove",function(ad){var af=$(this).data("dragBox_first"),ae,ac,ab,aa,ag;if(af){ae=n(ad);ac=ae.x-af.x;ab=ae.y-af.y;aa=ac<=0?af.x+ac:af.x;ag=ab<=0?af.y+ab:af.y;h.drawRubberBand([aa,ag],[Math.abs(ac),Math.abs(ab)])}});$(Z).bind("mouseup",function(aa){var ae=$(this).data("dragBox_first"),ad,ab,ai,ah,ag,af,ac;h.removeRubberBand(Z);if(ae){ad=n(aa);ab=ad.x-ae.x;ai=ad.y-ae.y;ah=ab<=0?ae.x+ab:ae.x;ag=ai<=0?ae.y+ai:ae.y;af=new OG.Envelope([ah,ag],Math.abs(ab),Math.abs(ai));$(h.getRootElement()).find("[_type="+OG.Constants.NODE_TYPE.SHAPE+"]").each(function(aj,ak){if(ak.shape.geom&&af.isContainsAll(ak.shape.geom.getVertices())){L(ak);if(!v(ak)){ac=h.drawGuide(ak);if(ac){k(ak,ac,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);h.removeAllTerminal()}}}});$(this).data("dragBox",{width:ab,height:ai,x:ah,y:ag})}});$(Z).bind("contextmenu",function(aa){h.removeRubberBand(Z)})}else{$(Z).unbind("mousedown");$(Z).unbind("mousemove");$(Z).unbind("mouseup");$(Z).unbind("contextmenu")}};this.setEnableHotKey=function(Y){if(Y){$(h.getContainer()).bind("keydown",function(Z){if(!/^textarea$/i.test(Z.srcElement.tagName)&&!/^input$/i.test(Z.srcElement.tagName)){if(OG.Constants.ENABLE_HOTKEY_DELETE&&Z.keyCode===KeyEvent.DOM_VK_DELETE){M()}if(OG.Constants.ENABLE_HOTKEY_CTRL_A&&OG.Constants.SELECTABLE&&Z.ctrlKey&&Z.keyCode===KeyEvent.DOM_VK_A){T()}if(OG.Constants.ENABLE_HOTKEY_CTRL_C&&Z.ctrlKey&&Z.keyCode===KeyEvent.DOM_VK_C){z()}if(OG.Constants.ENABLE_HOTKEY_CTRL_V&&Z.ctrlKey&&Z.keyCode===KeyEvent.DOM_VK_V){G()}if(OG.Constants.ENABLE_HOTKEY_CTRL_D&&Z.ctrlKey&&Z.keyCode===KeyEvent.DOM_VK_D){F()}if(OG.Constants.ENABLE_HOTKEY_CTRL_G&&Z.ctrlKey&&Z.keyCode===KeyEvent.DOM_VK_G){S()}if(OG.Constants.ENABLE_HOTKEY_CTRL_U&&Z.ctrlKey&&Z.keyCode===KeyEvent.DOM_VK_U){o()}if(OG.Constants.ENABLE_HOTKEY_SHIFT_ARROW){if(Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_LEFT){p(R(),-1*(OG.Constants.DRAG_GRIDABLE?OG.Constants.MOVE_SNAP_SIZE:1),0)}if(Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_RIGHT){p(R(),(OG.Constants.DRAG_GRIDABLE?OG.Constants.MOVE_SNAP_SIZE:1),0)}if(Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_UP){p(R(),0,-1*(OG.Constants.DRAG_GRIDABLE?OG.Constants.MOVE_SNAP_SIZE:1))}if(Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_DOWN){p(R(),0,(OG.Constants.DRAG_GRIDABLE?OG.Constants.MOVE_SNAP_SIZE:1))}}if(OG.Constants.ENABLE_HOTKEY_ARROW){if(!Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_LEFT){p(R(),-1*OG.Constants.MOVE_SNAP_SIZE,0)}if(!Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_RIGHT){p(R(),OG.Constants.MOVE_SNAP_SIZE,0)}if(!Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_UP){p(R(),0,-1*OG.Constants.MOVE_SNAP_SIZE)}if(!Z.shiftKey&&Z.keyCode===KeyEvent.DOM_VK_DOWN){p(R(),0,OG.Constants.MOVE_SNAP_SIZE)}}}})}else{$(h.getContainer()).unbind("keydown")}};this.enableRootContextMenu=function(){$.contextMenu({selector:"#"+h.getRootElement().id,build:function(Y,ab){var aa=h.getRootGroup(),Z=$(aa).data("copied");$(h.getContainer()).focus();return{items:{selectAll:{name:"Select All",callback:T},sep1:"---------",paste:{name:"Paste",callback:G,disabled:(Z?false:true)},sep2:"---------",view:{name:"View",items:{view_actualSize:{name:"Actual Size",callback:function(){h.setScale(1)}},sep2_1:"---------",view_fitWindow:{name:"Fit Window",callback:j},sep2_2:"---------",view_25:{name:"25%",callback:function(){h.setScale(0.25)}},view_50:{name:"50%",callback:function(){h.setScale(0.5)}},view_75:{name:"75%",callback:function(){h.setScale(0.75)}},view_100:{name:"100%",callback:function(){h.setScale(1)}},view_150:{name:"150%",callback:function(){h.setScale(1.5)}},view_200:{name:"200%",callback:function(){h.setScale(2)}},view_300:{name:"300%",callback:function(){h.setScale(3)}},view_400:{name:"400%",callback:function(){h.setScale(4)}},sep2_3:"---------",view_zoomin:{name:"Zoom In",callback:C},view_zoomout:{name:"Zoom Out",callback:t}}}}}}})};this.enableShapeContextMenu=function(){$.contextMenu({selector:"#"+h.getRootElement().id+" [_type=SHAPE]",build:function(Y,Z){$(h.getContainer()).focus();return{items:{"delete":{name:"Delete",callback:M},sep1:"---------",cut:{name:"Cut",callback:m},copy:{name:"Copy",callback:z},sep2:"---------",duplicate:{name:"Duplicate",callback:F},sep3:"---------",group:{name:"Group",callback:S},unGroup:{name:"UnGroup",callback:o},sep4:"---------",shapeRotate:{name:"Rotate",items:{rotate_select:{name:"Select",type:"select",options:{"0":"0","45":"45","90":"90","135":"135","180":"180","-45":"-45","-90":"-90","-135":"-135","-180":"-180"},selected:"0",events:{change:function(aa){I(aa.target.value)}}},sep5_6_1:"---------",rotate_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){I(aa.target.value)}}}}}},sep5:"---------",format:{name:"Format",items:{fillColor:{name:"Fill Color",items:{fillColor_select:{name:"Select",type:"select",options:{"":"",white:"white",gray:"gray",blue:"blue",red:"red",yellow:"yellow",orange:"orange",green:"green",black:"black"},selected:"",events:{change:function(aa){if(aa.target.value!==""){g(aa.target.value)}}}},sep5_1_1:"---------",fillColor_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){g(aa.target.value)}}}}}},fillOpacity:{name:"Fill Opacity",items:{fillOpacity_select:{name:"Select",type:"select",options:{"":"","0.0":"0%","0.1":"10%","0.2":"20%","0.3":"30%","0.4":"40%","0.5":"50%","0.6":"60%","0.7":"70%","0.8":"80%","0.9":"90%","1.0":"100%"},selected:"",events:{change:function(aa){if(aa.target.value!==""){x(aa.target.value)}}}}}},sep5_1:"---------",lineType:{name:"Line Type",items:{lineType_straight:{name:"Straight",type:"radio",radio:"lineType",value:"straight",events:{change:function(aa){D(aa.target.value)}}},lineType_plain:{name:"Plain",type:"radio",radio:"lineType",value:"plain",events:{change:function(aa){D(aa.target.value)}}},lineType_bezier:{name:"Curve",type:"radio",radio:"lineType",value:"bezier",events:{change:function(aa){D(aa.target.value)}}}}},lineStyle:{name:"Line Style",items:{lineStyle_1:{name:"",type:"radio",radio:"lineStyle",value:"",events:{change:function(aa){u(aa.target.value)}}},lineStyle_2:{name:"---------",type:"radio",radio:"lineStyle",value:"-",events:{change:function(aa){u(aa.target.value)}}},lineStyle_3:{name:"",type:"radio",radio:"lineStyle",value:".",events:{change:function(aa){u(aa.target.value)}}},lineStyle_4:{name:"-----",type:"radio",radio:"lineStyle",value:"-.",events:{change:function(aa){u(aa.target.value)}}},lineStyle_5:{name:"----",type:"radio",radio:"lineStyle",value:"-..",events:{change:function(aa){u(aa.target.value)}}},lineStyle_6:{name:"     ",type:"radio",radio:"lineStyle",value:". ",events:{change:function(aa){u(aa.target.value)}}},lineStyle_7:{name:"- - - - -",type:"radio",radio:"lineStyle",value:"- ",events:{change:function(aa){u(aa.target.value)}}},lineStyle_8:{name:"   ",type:"radio",radio:"lineStyle",value:"--",events:{change:function(aa){u(aa.target.value)}}},lineStyle_9:{name:"- - - -",type:"radio",radio:"lineStyle",value:"- .",events:{change:function(aa){u(aa.target.value)}}},lineStyle_10:{name:"-------",type:"radio",radio:"lineStyle",value:"--.",events:{change:function(aa){u(aa.target.value)}}},lineStyle_11:{name:"------",type:"radio",radio:"lineStyle",value:"--..",events:{change:function(aa){u(aa.target.value)}}}}},lineColor:{name:"Line Color",items:{lineColor_select:{name:"Select",type:"select",options:{"":"",white:"white",gray:"gray",blue:"blue",red:"red",yellow:"yellow",orange:"orange",green:"green",black:"black"},selected:"",events:{change:function(aa){if(aa.target.value!==""){l(aa.target.value)}}}},sep5_4_1:"---------",lineColor_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){l(aa.target.value)}}}}}},lineWidth:{name:"Line Width",items:{lineWidth_select:{name:"Select",type:"select",options:{0:"",1:"1px",2:"2px",3:"3px",4:"4px",5:"5px",6:"6px",8:"8px",10:"10px",12:"12px",16:"16px",24:"24px"},selected:0,events:{change:function(aa){if(aa.target.value!==0){r(aa.target.value)}}}},sep5_5_1:"---------",lineWidth_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){r(aa.target.value)}}}}}}}},sep6:"---------",text:{name:"Text",items:{fontFamily:{name:"Font Family",items:{fontFamily_1:{name:'<span style="font-family: Arial">Arial</span>',type:"radio",radio:"fontFamily",value:"Arial",events:{change:function(aa){H(aa.target.value)}}},fontFamily_2:{name:"<span style=\"font-family: 'Comic Sans MS'\">Comic Sans MS</span>",type:"radio",radio:"fontFamily",value:"Comic Sans MS",events:{change:function(aa){H(aa.target.value)}}},fontFamily_3:{name:"<span style=\"font-family: 'Courier New'\">Courier New</span>",type:"radio",radio:"fontFamily",value:"Courier New",events:{change:function(aa){H(aa.target.value)}}},fontFamily_4:{name:'<span style="font-family: Garamond">Garamond</span>',type:"radio",radio:"fontFamily",value:"Garamond",events:{change:function(aa){H(aa.target.value)}}},fontFamily_5:{name:'<span style="font-family: Georgia">Georgia</span>',type:"radio",radio:"fontFamily",value:"Georgia",events:{change:function(aa){H(aa.target.value)}}},fontFamily_6:{name:"<span style=\"font-family: 'Lucida Console'\">Lucida Console</span>",type:"radio",radio:"fontFamily",value:"Lucida Console",events:{change:function(aa){H(aa.target.value)}}},fontFamily_7:{name:"<span style=\"font-family: 'MS Gothic'\">MS Gothic</span>",type:"radio",radio:"fontFamily",value:"MS Gothic",events:{change:function(aa){H(aa.target.value)}}},fontFamily_8:{name:"<span style=\"font-family: 'MS Sans Serif'\">MS Sans Serif</span>",type:"radio",radio:"fontFamily",value:"MS Sans Serif",events:{change:function(aa){H(aa.target.value)}}},fontFamily_9:{name:'<span style="font-family: Verdana">Verdana</span>',type:"radio",radio:"fontFamily",value:"Verdana",events:{change:function(aa){H(aa.target.value)}}},fontFamily_10:{name:"<span style=\"font-family: 'Times New Roman'\">Times New Roman</span>",type:"radio",radio:"fontFamily",value:"Times New Roman",events:{change:function(aa){H(aa.target.value)}}},sep6_1_1:"---------",fontFamily_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){H(aa.target.value)}}}}}},fontColor:{name:"Font Color",items:{fontColor_select:{name:"Select",type:"select",options:{"":"",white:"white",gray:"gray",blue:"blue",red:"red",yellow:"yellow",orange:"orange",green:"green",black:"black"},selected:"",events:{change:function(aa){if(aa.target.value!==""){P(aa.target.value)}}}},sep6_1_2:"---------",fontColor_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){P(aa.target.value)}}}}}},fontSize:{name:"Font Size",items:{fontSize_select:{name:"Select",type:"select",options:{"":"","6":"6","8":"8","9":"9","10":"10","11":"11","12":"12","14":"14","18":"18","24":"24","36":"36","48":"48","72":"72"},selected:"",events:{change:function(aa){if(aa.target.value!==""){d(aa.target.value)}}}},sep6_1_3:"---------",fontSize_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){d(aa.target.value)}}}}}},sep6_1:"---------",fontWeight_bold:{name:'<span style="font-weight: bold">Bold</span>',type:"checkbox",events:{change:function(aa){if(aa.target.checked){b("bold")}else{b("normal")}}}},fontWeight_italic:{name:'<span style="font-style: italic">Italic</span>',type:"checkbox",events:{change:function(aa){if(aa.target.checked){W("italic")}else{W("normal")}}}},sep6_2:"---------",position:{name:"Text Position",items:{position_left:{name:"Left",type:"radio",radio:"position",value:"left",events:{change:function(aa){V(aa.target.value)}}},position_center:{name:"Center",type:"radio",radio:"position",value:"center",events:{change:function(aa){V(aa.target.value)}}},position_right:{name:"Right",type:"radio",radio:"position",value:"right",events:{change:function(aa){V(aa.target.value)}}},position_top:{name:"Top",type:"radio",radio:"position",value:"top",events:{change:function(aa){V(aa.target.value)}}},position_bottom:{name:"Bottom",type:"radio",radio:"position",value:"bottom",events:{change:function(aa){V(aa.target.value)}}}}},vertical:{name:"Vertical Align",items:{vertical_top:{name:"Top",type:"radio",radio:"vertical",value:"top",events:{change:function(aa){f(aa.target.value)}}},vertical_middle:{name:"Middle",type:"radio",radio:"vertical",value:"middle",events:{change:function(aa){f(aa.target.value)}}},vertical_bottom:{name:"Bottom",type:"radio",radio:"vertical",value:"bottom",events:{change:function(aa){f(aa.target.value)}}}}},horizontal:{name:"Horizontal Align",items:{vertical_start:{name:"Left",type:"radio",radio:"horizontal",value:"start",events:{change:function(aa){w(aa.target.value)}}},horizontal_middle:{name:"Middle",type:"radio",radio:"horizontal",value:"middle",events:{change:function(aa){w(aa.target.value)}}},horizontal_end:{name:"Right",type:"radio",radio:"horizontal",value:"end",events:{change:function(aa){w(aa.target.value)}}}}},sep6_5:"---------",textRotate:{name:"Text Rotate",items:{textRotate_select:{name:"Select",type:"select",options:{"0":"0","45":"45","90":"90","135":"135","180":"180","-45":"-45","-90":"-90","-135":"-135","-180":"-180"},selected:"0",events:{change:function(aa){c(aa.target.value)}}},sep6_6_1:"---------",textRotate_custom:{name:"Custom",type:"text",events:{keyup:function(aa){if(aa.target.value!==""){c(aa.target.value)}}}}}}}},sep7:"---------",label:{name:"Label",items:{label_shape:{name:"Cell Label",type:"text",events:{keyup:function(aa){y(aa.target.value)}}},sep7_1:"---------",label_from:{name:"Edge From",type:"text",events:{keyup:function(aa){q(aa.target.value)}}},label_to:{name:"Edge To",type:"text",events:{keyup:function(aa){K(aa.target.value)}}}}}}}}})}};OG.handler.EventHandler.prototype=new OG.handler.EventHandler();OG.handler.EventHandler.prototype.constructor=OG.handler.EventHandler;OG.EventHandler=OG.handler.EventHandler;OG.graph.Canvas=function(container,containerSize,backgroundColor,backgroundImage){var _RENDERER=container?new OG.RaphaelRenderer(container,containerSize,backgroundColor,backgroundImage):null,_HANDLER=new OG.EventHandler(_RENDERER),_CONTAINER=OG.Util.isElement(container)?container:document.getElementById(container);this.initConfig=function(config){if(config){OG.Constants.SELECTABLE=config.selectable===undefined?OG.Constants.SELECTABLE:config.selectable;OG.Constants.DRAG_SELECTABLE=config.dragSelectable===undefined?OG.Constants.DRAG_SELECTABLE:config.dragSelectable;OG.Constants.MOVABLE=config.movable===undefined?OG.Constants.MOVABLE:config.movable;OG.Constants.RESIZABLE=config.resizable===undefined?OG.Constants.RESIZABLE:config.resizable;OG.Constants.CONNECTABLE=config.connectable===undefined?OG.Constants.CONNECTABLE:config.connectable;OG.Constants.SELF_CONNECTABLE=config.selfConnectable===undefined?OG.Constants.SELF_CONNECTABLE:config.selfConnectable;OG.Constants.CONNECT_CLONEABLE=config.connectCloneable===undefined?OG.Constants.CONNECT_CLONEABLE:config.connectCloneable;OG.Constants.CONNECT_REQUIRED=config.connectRequired===undefined?OG.Constants.CONNECT_REQUIRED:config.connectRequired;OG.Constants.LABEL_EDITABLE=config.labelEditable===undefined?OG.Constants.LABEL_EDITABLE:config.labelEditable;OG.Constants.GROUP_DROPABLE=config.groupDropable===undefined?OG.Constants.GROUP_DROPABLE:config.groupDropable;OG.Constants.GROUP_COLLAPSIBLE=config.collapsible===undefined?OG.Constants.GROUP_COLLAPSIBLE:config.collapsible;OG.Constants.ENABLE_HOTKEY=config.enableHotKey===undefined?OG.Constants.ENABLE_HOTKEY:config.enableHotKey}_HANDLER.setDragSelectable(OG.Constants.SELECTABLE&&OG.Constants.DRAG_SELECTABLE);_HANDLER.setEnableHotKey(OG.Constants.ENABLE_HOTKEY);if(OG.Constants.ENABLE_CONTEXTMENU){_HANDLER.enableRootContextMenu();_HANDLER.enableShapeContextMenu()}this.CONFIG_INITIALIZED=true};this.getRenderer=function(){return _RENDERER};this.getContainer=function(){return _CONTAINER};this.getEventHandler=function(){return _HANDLER};this.drawShape=function(position,shape,size,style,id,parentId,gridable){if(OG.Constants.DRAG_GRIDABLE&&(!OG.Util.isDefined(gridable)||gridable===true)){if(position){position[0]=OG.Util.roundGrid(position[0]);position[1]=OG.Util.roundGrid(position[1])}if(size){size[0]=OG.Util.roundGrid(size[0],OG.Constants.MOVE_SNAP_SIZE*2);size[1]=OG.Util.roundGrid(size[1],OG.Constants.MOVE_SNAP_SIZE*2)}}var element=_RENDERER.drawShape(position,shape,size,style,id);if(position&&(shape.TYPE===OG.Constants.SHAPE_TYPE.EDGE)){element=_RENDERER.move(element,position)}if(parentId&&_RENDERER.getElementById(parentId)){_RENDERER.appendChild(element,parentId)}if(!this.CONFIG_INITIALIZED){this.initConfig()}_HANDLER.setClickSelectable(element,OG.Constants.SELECTABLE);_HANDLER.setMovable(element,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);if(OG.Constants.CONNECTABLE){_HANDLER.enableConnect(element)}if(OG.Constants.LABEL_EDITABLE){_HANDLER.enableEditLabel(element)}if(OG.Constants.GROUP_DROPABLE){_HANDLER.enableDragAndDropGroup(element)}if(OG.Constants.GROUP_COLLAPSIBLE){_HANDLER.enableCollapse(element)}return element};this.setShapeStyle=function(shapeElement,style){_RENDERER.setShapeStyle(shapeElement,style)};this.drawLabel=function(shapeElement,text,style){return _RENDERER.drawLabel(shapeElement,text,style)};this.redrawConnectedEdge=function(element,excludeEdgeId){_RENDERER.redrawConnectedEdge(element,excludeEdgeId)};this.connect=function(fromElement,toElement,style,label){var terminalGroup,childTerminals,fromTerminal,toTerminal,i,edge,guide;terminalGroup=_RENDERER.drawTerminal(fromElement,OG.Constants.TERMINAL_TYPE.OUT);childTerminals=terminalGroup.terminal.childNodes;fromTerminal=childTerminals[0];for(i=0;i<childTerminals.length;i++){if(childTerminals[i].terminal&&childTerminals[i].terminal.direction.toLowerCase()==="c"){fromTerminal=childTerminals[i];break}}_RENDERER.removeTerminal(fromElement);terminalGroup=_RENDERER.drawTerminal(toElement,OG.Constants.TERMINAL_TYPE.IN);childTerminals=terminalGroup.terminal.childNodes;toTerminal=childTerminals[0];for(i=0;i<childTerminals.length;i++){if(childTerminals[i].terminal&&childTerminals[i].terminal.direction.toLowerCase()==="c"){toTerminal=childTerminals[i];break}}_RENDERER.removeTerminal(toElement);edge=_RENDERER.drawShape(null,new OG.EdgeShape(fromTerminal.terminal.position,toTerminal.terminal.position));edge=_RENDERER.connect(fromTerminal,toTerminal,edge,style,label);if(edge){guide=_RENDERER.drawGuide(edge);if(edge&&guide){_HANDLER.setClickSelectable(edge,OG.Constants.SELECTABLE);_HANDLER.setMovable(edge,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);_HANDLER.setResizable(edge,guide,OG.Constants.SELECTABLE&&OG.Constants.RESIZABLE);if($(edge).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){if(OG.Constants.LABEL_EDITABLE){_HANDLER.enableEditLabel(edge)}}_RENDERER.toFront(guide.group)}}return edge};this.disconnect=function(element){_RENDERER.disconnect(element)};this.group=function(elements){var group=_RENDERER.group(elements);_HANDLER.setClickSelectable(group,OG.Constants.SELECTABLE);_HANDLER.setMovable(group,OG.Constants.SELECTABLE&&OG.Constants.MOVABLE);if($(group).attr("_shape")!==OG.Constants.SHAPE_TYPE.GROUP){if(OG.Constants.LABEL_EDITABLE){_HANDLER.enableEditLabel(group)}}return group};this.ungroup=function(groupElements){return _RENDERER.ungroup(groupElements)};this.addToGroup=function(groupElement,elements){_RENDERER.addToGroup(groupElement,elements)};this.collapse=function(element){_RENDERER.collapse(element)};this.expand=function(element){_RENDERER.expand(element)};this.clear=function(){_RENDERER.clear()};this.removeShape=function(element){_RENDERER.removeShape(element)};this.removeChild=function(element){_RENDERER.removeChild(element)};this.removeGuide=function(element){_RENDERER.removeGuide(element)};this.removeAllGuide=function(){_RENDERER.removeAllGuide()};this.getRootElement=function(){return _RENDERER.getRootElement()};this.getRootGroup=function(){return _RENDERER.getRootGroup()};this.getElementByPoint=function(position){return _RENDERER.getElementByPoint(position)};this.getElementsByBBox=function(envelope){return _RENDERER.getElementsByBBox(envelope)};this.setAttr=function(element,attribute){_RENDERER.setAttr(element,attribute)};this.getAttr=function(element,attrName){return _RENDERER.getAttr(element,attrName)};this.toFront=function(element){_RENDERER.toFront(element)};this.toBack=function(element){_RENDERER.toBack(element)};this.getCanvasSize=function(){_RENDERER.getCanvasSize()};this.setCanvasSize=function(size){_RENDERER.setCanvasSize(size)};this.fitCanvasSize=function(minSize,fitScale){_RENDERER.fitCanvasSize(minSize,fitScale)};this.setViewBox=function(position,size,isFit){_RENDERER.setViewBox(position,size,isFit)};this.getScale=function(){_RENDERER.getScale()};this.setScale=function(scale){_RENDERER.setScale(scale)};this.show=function(element){_RENDERER.show(element)};this.hide=function(element){_RENDERER.hide(element)};this.appendChild=function(srcElement,targetElement){return _RENDERER.appendChild(srcElement,targetElement)};this.insertAfter=function(srcElement,targetElement){return _RENDERER.insertAfter(srcElement,targetElement)};this.insertBefore=function(srcElement,targetElement){return _RENDERER.insertBefore(srcElement,targetElement)};this.move=function(element,offset,excludeEdgeId){return _RENDERER.move(element,offset,excludeEdgeId)};this.moveCentroid=function(element,position,excludeEdgeId){return _RENDERER.moveCentroid(element,position,excludeEdgeId)};this.rotate=function(element,angle,excludeEdgeId){return _RENDERER.rotate(element,angle,excludeEdgeId)};this.resize=function(element,offset,excludeEdgeId){return _RENDERER.resize(element,offset,excludeEdgeId)};this.resizeBox=function(element,size){return _RENDERER.resizeBox(element,size)};this.clone=function(element){return _RENDERER.clone(element)};this.getElementById=function(id){return _RENDERER.getElementById(id)};this.getElementsByType=function(shapeType,excludeType){return _RENDERER.getElementsByType(shapeType,excludeType)};this.getElementsByShapeId=function(shapeId){var root=this.getRootGroup();return $(root).find("[_type=SHAPE][_shape_id='"+shapeId+"']")};this.getRelatedElementsFromEdge=function(edgeElement){var edge=OG.Util.isElement(edgeElement)?edgeElement:this.getElementById(edgeElement),getShapeFromTerminal=function(terminal){var terminalId=OG.Util.isElement(terminal)?terminal.id:terminal;if(terminalId){return _RENDERER.getElementById(terminalId.substring(0,terminalId.indexOf(OG.Constants.TERMINAL_SUFFIX.GROUP)))}else{return null}};if($(edge).attr("_shape")===OG.Constants.SHAPE_TYPE.EDGE){return{from:getShapeFromTerminal($(edgeElement).attr("_from")),to:getShapeFromTerminal($(edgeElement).attr("_to"))}}else{return{from:null,to:null}}};this.getBBox=function(element){return _RENDERER.getBBox(element)};this.getRootBBox=function(){return _RENDERER.getRootBBox()};this.getRealRootBBox=function(){return _RENDERER.getRealRootBBox()};this.isSVG=function(){return _RENDERER.isSVG()};this.isVML=function(){return _RENDERER.isVML()};this.setCustomData=function(shapeElement,data){var element=OG.Util.isElement(shapeElement)?shapeElement:document.getElementById(shapeElement);element.data=data};this.getCustomData=function(shapeElement){var element=OG.Util.isElement(shapeElement)?shapeElement:document.getElementById(shapeElement);return element.data};this.toXML=function(){return OG.Util.jsonToXml(this.toJSON())};this.toJSON=function(){var CANVAS=this,rootBBox=_RENDERER.getRootBBox(),rootGroup=_RENDERER.getRootGroup(),jsonObj={opengraph:{"@width":rootBBox.width,"@height":rootBBox.height,cell:[]}},childShape;childShape=function(node,isRoot){$(node).children("[_type=SHAPE]").each(function(idx,item){var shape=item.shape,style=item.shapeStyle,geom=shape.geom,envelope=geom.getBoundary(),cell={},vertices,from,to,prevShapeIds,nextShapeIds;cell["@id"]=$(item).attr("id");if(!isRoot){cell["@parent"]=$(node).attr("id")}cell["@shapeType"]=shape.TYPE;cell["@shapeId"]=shape.SHAPE_ID;cell["@x"]=envelope.getCentroid().x;cell["@y"]=envelope.getCentroid().y;cell["@width"]=envelope.getWidth();cell["@height"]=envelope.getHeight();if(style){cell["@style"]=escape(OG.JSON.encode(style))}if(shape.TYPE===OG.Constants.SHAPE_TYPE.EDGE){if($(item).attr("_from")){cell["@from"]=$(item).attr("_from")}if($(item).attr("_to")){cell["@to"]=$(item).attr("_to")}}else{prevShapeIds=CANVAS.getPrevShapeIds(item);nextShapeIds=CANVAS.getNextShapeIds(item);if(prevShapeIds.length>0){cell["@from"]=prevShapeIds.toString()}if(nextShapeIds.length>0){cell["@to"]=nextShapeIds.toString()}}if($(item).attr("_fromedge")){cell["@fromEdge"]=$(item).attr("_fromedge")}if($(item).attr("_toedge")){cell["@toEdge"]=$(item).attr("_toedge")}if(shape.label){cell["@label"]=escape(shape.label)}if(shape.fromLabel){cell["@fromLabel"]=escape(shape.fromLabel)}if(shape.toLabel){cell["@toLabel"]=escape(shape.toLabel)}if(shape.angle&&shape.angle!==0){cell["@angle"]=shape.angle}if(shape instanceof OG.shape.ImageShape){cell["@value"]=shape.image}else{if(shape instanceof OG.shape.HtmlShape){cell["@value"]=escape(shape.html)}else{if(shape instanceof OG.shape.TextShape){cell["@value"]=escape(shape.text)}else{if(shape instanceof OG.shape.EdgeShape){vertices=geom.getVertices();from=vertices[0];to=vertices[vertices.length-1];cell["@value"]=from+","+to}}}}if(geom){cell["@geom"]=escape(geom.toString())}if(item.data){cell["@data"]=escape(OG.JSON.encode(item.data))}jsonObj.opengraph.cell.push(cell);childShape(item,false)})};if(rootGroup.data){jsonObj.opengraph["@data"]=escape(OG.JSON.encode(rootGroup.data))}childShape(rootGroup,true);return jsonObj};this.loadXML=function(xml){if(!OG.Util.isElement(xml)){xml=OG.Util.parseXML(xml)}return this.loadJSON(OG.Util.xmlToJson(xml))};this.loadJSON=function(json){var canvasWidth,canvasHeight,rootGroup,minX=Number.MAX_VALUE,minY=Number.MAX_VALUE,maxX=Number.MIN_VALUE,maxY=Number.MIN_VALUE,i,cell,shape,id,parent,shapeType,shapeId,x,y,width,height,style,geom,from,to,fromEdge,toEdge,label,fromLabel,toLabel,angle,value,data,element;_RENDERER.clear();if(json&&json.opengraph&&json.opengraph.cell&&OG.Util.isArray(json.opengraph.cell)){canvasWidth=json.opengraph["@width"];canvasHeight=json.opengraph["@height"];data=json.opengraph["@data"];if(data){rootGroup=this.getRootGroup();rootGroup.data=OG.JSON.decode(unescape(data))}cell=json.opengraph.cell;for(i=0;i<cell.length;i++){id=cell[i]["@id"];parent=cell[i]["@parent"];shapeType=cell[i]["@shapeType"];shapeId=cell[i]["@shapeId"];x=parseInt(cell[i]["@x"],10);y=parseInt(cell[i]["@y"],10);width=parseInt(cell[i]["@width"],10);height=parseInt(cell[i]["@height"],10);style=unescape(cell[i]["@style"]);geom=unescape(cell[i]["@geom"]);from=cell[i]["@from"];to=cell[i]["@to"];fromEdge=cell[i]["@fromEdge"];toEdge=cell[i]["@toEdge"];label=cell[i]["@label"];fromLabel=cell[i]["@fromLabel"];toLabel=cell[i]["@toLabel"];angle=cell[i]["@angle"];value=cell[i]["@value"];data=cell[i]["@data"];label=label?unescape(label):label;minX=(minX>(x-width/2))?(x-width/2):minX;minY=(minY>(y-height/2))?(y-height/2):minY;maxX=(maxX<(x+width/2))?(x+width/2):maxX;maxY=(maxY<(y+height/2))?(y+height/2):maxY;switch(shapeType){case OG.Constants.SHAPE_TYPE.GEOM:case OG.Constants.SHAPE_TYPE.GROUP:shape=eval("new "+shapeId+"()");if(label){shape.label=label}element=this.drawShape([x,y],shape,[width,height],OG.JSON.decode(style),id,parent,false);break;case OG.Constants.SHAPE_TYPE.EDGE:shape=eval("new "+shapeId+"("+value+")");if(label){shape.label=label}if(fromLabel){shape.fromLabel=unescape(fromLabel)}if(toLabel){shape.toLabel=unescape(toLabel)}if(geom){geom=OG.JSON.decode(geom);if(geom.type===OG.Constants.GEOM_NAME[OG.Constants.GEOM_TYPE.POLYLINE]){geom=new OG.geometry.PolyLine(geom.vertices);shape.geom=geom}else{if(geom.type===OG.Constants.GEOM_NAME[OG.Constants.GEOM_TYPE.CURVE]){geom=new OG.geometry.Curve(geom.controlPoints);shape.geom=geom}}}element=this.drawShape(null,shape,null,OG.JSON.decode(style),id,parent,false);break;case OG.Constants.SHAPE_TYPE.HTML:shape=eval("new "+shapeId+"()");if(value){shape.html=unescape(value)}if(label){shape.label=label}element=this.drawShape([x,y],shape,[width,height,angle],OG.JSON.decode(style),id,parent,false);break;case OG.Constants.SHAPE_TYPE.IMAGE:shape=eval("new "+shapeId+"('"+value+"')");if(label){shape.label=label}element=this.drawShape([x,y],shape,[width,height,angle],OG.JSON.decode(style),id,parent,false);break;case OG.Constants.SHAPE_TYPE.TEXT:shape=eval("new "+shapeId+"()");if(value){shape.text=unescape(value)}element=this.drawShape([x,y],shape,[width,height,angle],OG.JSON.decode(style),id,parent,false);break}if(from){$(element).attr("_from",from)}if(to){$(element).attr("_to",to)}if(fromEdge){$(element).attr("_fromedge",fromEdge)}if(toEdge){$(element).attr("_toedge",toEdge)}if(data){element.data=OG.JSON.decode(unescape(data))}}this.setCanvasSize([canvasWidth,canvasHeight]);return{width:maxX-minX,height:maxY-minY,x:minX,y:minY,x2:maxX,y2:maxY}}return{width:0,height:0,x:0,y:0,x2:0,y2:0}};this.getPrevEdges=function(element){return _RENDERER.getPrevEdges(element)};this.getNextEdges=function(element){return _RENDERER.getNextEdges(element)};this.getPrevShapes=function(element){return _RENDERER.getPrevShapes(element)};this.getPrevShapeIds=function(element){return _RENDERER.getPrevShapeIds(element)};this.getNextShapes=function(element){return _RENDERER.getNextShapes(element)};this.getNextShapeIds=function(element){return _RENDERER.getNextShapeIds(element)};this.onDrawShape=function(callbackFunc){$(this.getRootElement()).bind("drawShape",function(event,shapeElement){callbackFunc(event,shapeElement)})};this.onDrawLabel=function(callbackFunc){$(this.getRootElement()).bind("drawLabel",function(event,shapeElement,labelText){callbackFunc(event,shapeElement,labelText)})};this.onLabelChanged=function(callbackFunc){$(this.getRootElement()).bind("labelChanged",function(event,shapeElement,afterText,beforeText){callbackFunc(event,shapeElement,afterText,beforeText)})};this.onBeforeLabelChange=function(callbackFunc){$(this.getRootElement()).bind("beforeLabelChange",function(event){if(callbackFunc(event,event.element,event.afterText,event.beforeText)===false){event.stopPropagation()}})};this.onRedrawShape=function(callbackFunc){$(this.getRootElement()).bind("redrawShape",function(event,shapeElement){callbackFunc(event,shapeElement)})};this.onRemoveShape=function(callbackFunc){$(this.getRootElement()).bind("removeShape",function(event,shapeElement){callbackFunc(event,shapeElement)})};this.onRotateShape=function(callbackFunc){$(this.getRootElement()).bind("rotateShape",function(event,element,angle){callbackFunc(event,element,angle)})};this.onMoveShape=function(callbackFunc){$(this.getRootElement()).bind("moveShape",function(event,shapeElement,offset){callbackFunc(event,shapeElement,offset)})};this.onResizeShape=function(callbackFunc){$(this.getRootElement()).bind("resizeShape",function(event,shapeElement,offset){callbackFunc(event,shapeElement,offset)})};this.onBeforeConnectShape=function(callbackFunc){$(this.getRootElement()).bind("beforeConnectShape",function(event){if(callbackFunc(event,event.edge,event.fromShape,event.toShape)===false){event.stopPropagation()}})};this.onBeforeRemoveShape=function(callbackFunc){$(this.getRootElement()).bind("beforeRemoveShape",function(event){if(callbackFunc(event,event.element)===false){event.stopPropagation()}})};this.onConnectShape=function(callbackFunc){$(this.getRootElement()).bind("connectShape",function(event,edgeElement,fromElement,toElement){callbackFunc(event,edgeElement,fromElement,toElement)})};this.onDisconnectShape=function(callbackFunc){$(this.getRootElement()).bind("disconnectShape",function(event,edgeElement,fromElement,toElement){callbackFunc(event,edgeElement,fromElement,toElement)})};this.onGroup=function(callbackFunc){$(this.getRootElement()).bind("group",function(event,groupElement){callbackFunc(event,groupElement)})};this.onUnGroup=function(callbackFunc){$(this.getRootElement()).bind("ungroup",function(event,ungroupedElements){callbackFunc(event,ungroupedElements)})};this.onCollapsed=function(callbackFunc){$(this.getRootElement()).bind("collapsed",function(event,element){callbackFunc(event,element)})};this.onExpanded=function(callbackFunc){$(this.getRootElement()).bind("expanded",function(event,element){callbackFunc(event,element)})}};OG.graph.Canvas.prototype=new OG.graph.Canvas();OG.graph.Canvas.prototype.constructor=OG.graph.Canvas;OG.Canvas=OG.graph.Canvas;